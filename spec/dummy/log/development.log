  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBooks (20240202130111)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20240202130111"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:01:29.502265"], ["updated_at", "2024-02-02 13:01:29.502265"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", nil], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:21:05.778047"], ["updated_at", "2024-02-02 13:21:05.778047"]]
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", nil], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:22:21.005468"], ["updated_at", "2024-02-02 13:22:21.005468"]]
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  â†³ (byebug):1:in `block (2 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" /* loading for inspect */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", nil], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:32:43.817741"], ["updated_at", "2024-02-02 13:32:43.817741"]]
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBooks (20240202130111)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "books"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.0ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20240202130111"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBooks (20240202130111)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBooks (20240202130111)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20240202130111"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202130111)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:38:20.145488"], ["updated_at", "2024-02-02 13:38:20.145488"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = ?, "updated_at" = ? WHERE "ar_internal_metadata"."key" = ?[0m  [["value", "test"], ["updated_at", "2024-02-02 13:38:20.147213"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "schema_sha1"], ["value", "31c1f23035b64b98ab96a17edf94e51c9f348557"], ["created_at", "2024-02-02 13:38:20.148730"], ["updated_at", "2024-02-02 13:38:20.148730"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" /* loading for inspect */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", nil], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:38:29.553933"], ["updated_at", "2024-02-02 13:38:29.553933"]]
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" /* loading for inspect */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", nil], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:38:47.964088"], ["updated_at", "2024-02-02 13:38:47.964088"]]
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", "a"], ["author", nil], ["description", nil], ["created_at", "2024-02-02 13:39:01.173550"], ["updated_at", "2024-02-02 13:39:01.173550"]]
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" /* loading for inspect */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202130111)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:43:27.695953"], ["updated_at", "2024-02-02 13:43:27.695953"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = ?, "updated_at" = ? WHERE "ar_internal_metadata"."key" = ?[0m  [["value", "test"], ["updated_at", "2024-02-02 13:43:27.697643"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "schema_sha1"], ["value", "31c1f23035b64b98ab96a17edf94e51c9f348557"], ["created_at", "2024-02-02 13:43:27.699171"], ["updated_at", "2024-02-02 13:43:27.699171"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", nil], ["created_at", "2024-02-02 13:43:27.768784"], ["updated_at", "2024-02-02 13:43:27.768784"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202130111)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:43:53.314080"], ["updated_at", "2024-02-02 13:43:53.314080"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = ?, "updated_at" = ? WHERE "ar_internal_metadata"."key" = ?[0m  [["value", "test"], ["updated_at", "2024-02-02 13:43:53.315782"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "schema_sha1"], ["value", "31c1f23035b64b98ab96a17edf94e51c9f348557"], ["created_at", "2024-02-02 13:43:53.317292"], ["updated_at", "2024-02-02 13:43:53.317292"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", nil], ["created_at", "2024-02-02 13:43:53.387564"], ["updated_at", "2024-02-02 13:43:53.387564"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  â†³ (byebug):1:in `publish_event'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  â†³ (byebug):1:in `publish_event'
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddEventStoreTableMigration (20240202134459)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddEventStoreTableMigration (20240202134459)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial NOT NULL PRIMARY KEY, "event_id" uuid NOT NULL, "event_type" varchar NOT NULL, "metadata" json, "data" json NOT NULL, "created_at" datetime(6) NOT NULL, "valid_at" datetime(6))[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aevent_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_event_id" ON "aevent_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_event_id" ON "aevent_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_position" ON "aevent_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_created_at" ON "aevent_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "aevent_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "event_store_events_in_streams"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "event_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "aevent_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aevent_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20240202134459"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author" varchar, "description" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aevent_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_event_id" ON "aevent_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_event_id" ON "aevent_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_position" ON "aevent_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_created_at" ON "aevent_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "aevent_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "event_store_events_in_streams"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "event_store_events_in_streams"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
, CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "aevent_store_events_in_streams"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "aevent_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", nil], ["created_at", "2024-02-02 13:47:06.864405"], ["updated_at", "2024-02-02 13:47:06.864405"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f14fe15b-fa61-4869-bf21-142d9d7ebff9', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description:\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 13:47:06.864405000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 13:47:06.864405000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 13:47:06.864405000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6e588f01-e941-4cf1-a260-c70df02376d5\n"', 'EntityHistory::Events::Created', '2024-02-02 13:47:06.865996', NULL)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddEventStoreTableMigration (20240202134459)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aevent_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_event_id" ON "aevent_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_event_id" ON "aevent_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aevent_store_events_in_streams_on_stream_and_position" ON "aevent_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aevent_store_events_in_streams_on_created_at" ON "aevent_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "aevent_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "event_store_events_in_streams"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "event_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id"  NOT NULL PRIMARY KEY, "stream" varchar NOT NULL, "position" integer DEFAULT NULL, "event_id"  NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("id","stream","position","event_id","created_at")
                     SELECT "id","stream","position","event_id","created_at" FROM "aevent_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aevent_store_events_in_streams"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "event_store_events"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP INDEX "index_event_store_events_in_streams_on_event_id"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP INDEX "index_event_store_events_in_streams_on_stream_and_event_id"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP INDEX "index_event_store_events_in_streams_on_stream_and_position"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "event_store_events_in_streams"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.0ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20240202134459"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.9ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_development"[0m
  [1m[35m (26.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (179.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_development" ENCODING = 'unicode'[0m
  [1m[35m (65.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35m (5.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2172072690616057740)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBooks (20240202130111)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20240202130111"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddEventStoreTableMigration (20240202134459)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial NOT NULL PRIMARY KEY, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial NOT NULL PRIMARY KEY, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (3.5ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20240202134459"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:51:15.120432"], ["updated_at", "2024-02-02 13:51:15.120432"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(2172072690616057740)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (107.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:51:23.322828"], ["updated_at", "2024-02-02 13:51:23.322828"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:51:23.325299"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:51:23.327231"], ["updated_at", "2024-02-02 13:51:23.327231"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", nil], ["created_at", "2024-02-02 13:51:23.417788"], ["updated_at", "2024-02-02 13:51:23.417788"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('01503c10-4514-4054-b175-b553dfc05375', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description:\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 13:51:23.417788000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 13:51:23.417788000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 13:51:23.417788000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 884dc5a3-520e-4b11-a5d0-1eef48579899\n"', 'EntityHistory::Events::Created', '2024-02-02 13:51:23.419586', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '01503c10-4514-4054-b175-b553dfc05375', '2024-02-02 13:51:23.422917') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (48.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (60.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:56:20.510864"], ["updated_at", "2024-02-02 13:56:20.510864"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:56:20.513669"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:56:20.515691"], ["updated_at", "2024-02-02 13:56:20.515691"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (63.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:56:39.804337"], ["updated_at", "2024-02-02 13:56:39.804337"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:56:39.807164"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:56:39.809144"], ["updated_at", "2024-02-02 13:56:39.809144"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (35.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (53.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:57:02.929281"], ["updated_at", "2024-02-02 13:57:02.929281"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:57:02.931862"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:57:02.933861"], ["updated_at", "2024-02-02 13:57:02.933861"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (50.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:58:39.510460"], ["updated_at", "2024-02-02 13:58:39.510460"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:58:39.513309"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:58:39.515285"], ["updated_at", "2024-02-02 13:58:39.515285"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (52.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 13:59:59.094035"], ["updated_at", "2024-02-02 13:59:59.094035"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 13:59:59.096728"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 13:59:59.098754"], ["updated_at", "2024-02-02 13:59:59.098754"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:00:52.825911"], ["updated_at", "2024-02-02 14:00:52.825911"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:00:52.828719"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:00:52.830717"], ["updated_at", "2024-02-02 14:00:52.830717"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (50.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:01:20.759570"], ["updated_at", "2024-02-02 14:01:20.759570"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:01:20.762299"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:01:20.764379"], ["updated_at", "2024-02-02 14:01:20.764379"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (57.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:01:36.987771"], ["updated_at", "2024-02-02 14:01:36.987771"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:01:36.990417"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:01:36.992525"], ["updated_at", "2024-02-02 14:01:36.992525"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (59.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:02:12.593458"], ["updated_at", "2024-02-02 14:02:12.593458"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:02:12.596164"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:02:12.598276"], ["updated_at", "2024-02-02 14:02:12.598276"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (58.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:02:25.639911"], ["updated_at", "2024-02-02 14:02:25.639911"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:02:25.642589"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:02:25.644680"], ["updated_at", "2024-02-02 14:02:25.644680"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (59.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:10:52.747957"], ["updated_at", "2024-02-02 14:10:52.747957"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:10:52.750639"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:10:52.752674"], ["updated_at", "2024-02-02 14:10:52.752674"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:11:06.255043"], ["updated_at", "2024-02-02 14:11:06.255043"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:11:06.257759"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:11:06.259866"], ["updated_at", "2024-02-02 14:11:06.259866"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:12:56.748772"], ["updated_at", "2024-02-02 14:12:56.748772"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:12:56.751527"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:12:56.753499"], ["updated_at", "2024-02-02 14:12:56.753499"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (4.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (4.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (3.4ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (3.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (55.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (55.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:14:56.516265"], ["updated_at", "2024-02-02 14:14:56.516265"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:14:56.518742"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:14:56.520751"], ["updated_at", "2024-02-02 14:14:56.520751"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mBook Create (1.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:15:03.678844"], ["updated_at", "2024-02-02 14:15:03.678844"]]
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (1.4ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2583f7d2-0569-4b17-a73f-42ca5db16c11', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:15:03.678844000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:15:03.678844000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:15:03.678844000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cb90939b-ccfb-4ffc-a58b-4e1de8d175d0\n"', 'EntityHistory::Events::Created', '2024-02-02 14:15:03.684757', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (1.5ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '2583f7d2-0569-4b17-a73f-42ca5db16c11', '2024-02-02 14:15:03.705062') RETURNING "id"[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (3 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (57.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:17:17.334950"], ["updated_at", "2024-02-02 14:17:17.334950"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:17:17.337682"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:17:17.339543"], ["updated_at", "2024-02-02 14:17:17.339543"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (54.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:17:55.233528"], ["updated_at", "2024-02-02 14:17:55.233528"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:17:55.236828"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:17:55.238905"], ["updated_at", "2024-02-02 14:17:55.238905"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (1.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:18:09.109542"], ["updated_at", "2024-02-02 14:18:09.109542"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (1.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9740e7f3-9d5f-428b-88ec-c8f6e129e836', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:18:09.109542000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:18:09.109542000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:18:09.109542000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 209429ff-0496-4368-b64d-65c27b388160\n"', 'EntityHistory::Events::Created', '2024-02-02 14:18:09.121274', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (1.4ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '9740e7f3-9d5f-428b-88ec-c8f6e129e836', '2024-02-02 14:18:09.136016') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:18:13.948531"], ["updated_at", "2024-02-02 14:18:13.948531"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.5ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bcda47d3-6845-4f27-bb57-c192ac26904b', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:18:13.948531000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:18:13.948531000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:18:13.948531000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b2aca824-4517-4845-8fa8-74117d7090fa\n"', 'EntityHistory::Events::Created', '2024-02-02 14:18:13.955183', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.7ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'bcda47d3-6845-4f27-bb57-c192ac26904b', '2024-02-02 14:18:13.959423') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:18:13.962945"], ["updated_at", "2024-02-02 14:18:13.962945"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b9db7689-a669-4a08-a0f5-d7a1f0f196a3', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:18:13.962945000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:18:13.962945000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:18:13.962945000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: eb5e7d6f-2c82-4f26-a4ec-24d021e15b86\n"', 'EntityHistory::Events::Created', '2024-02-02 14:18:13.966523', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.4ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'b9db7689-a669-4a08-a0f5-d7a1f0f196a3', '2024-02-02 14:18:13.969845') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:18:13.972507"], ["updated_at", "2024-02-02 14:18:13.972507"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e585de21-136a-4271-b4e2-016309f000e9', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:18:13.972507000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:18:13.972507000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:18:13.972507000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a45418cc-0643-4fd2-8ae2-deef1084a6e2\n"', 'EntityHistory::Events::Created', '2024-02-02 14:18:13.975571', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.4ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'e585de21-136a-4271-b4e2-016309f000e9', '2024-02-02 14:18:13.978511') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:18:13.980992"], ["updated_at", "2024-02-02 14:18:13.980992"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ad353745-1148-40ab-bcbe-88d0433f4063', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:18:13.980992000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:18:13.980992000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:18:13.980992000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 24b89702-d52c-466c-9fb3-23e85a3bf25f\n"', 'EntityHistory::Events::Created', '2024-02-02 14:18:13.983850', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'ad353745-1148-40ab-bcbe-88d0433f4063', '2024-02-02 14:18:13.986620') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (63.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:19:00.328994"], ["updated_at", "2024-02-02 14:19:00.328994"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:19:00.331616"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:19:00.333674"], ["updated_at", "2024-02-02 14:19:00.333674"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (53.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:19:21.568329"], ["updated_at", "2024-02-02 14:19:21.568329"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:19:21.571090"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:19:21.573050"], ["updated_at", "2024-02-02 14:19:21.573050"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (52.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:19:48.361169"], ["updated_at", "2024-02-02 14:19:48.361169"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:19:48.363912"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:19:48.365785"], ["updated_at", "2024-02-02 14:19:48.365785"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.453915"], ["updated_at", "2024-02-02 14:19:48.453915"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('36969934-a232-4a98-b272-9786b418107c', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.453915000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.453915000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.453915000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2dadf2f8-2670-40ce-9532-fec1b4d6569a\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.455924', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '36969934-a232-4a98-b272-9786b418107c', '2024-02-02 14:19:48.459535') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.462324"], ["updated_at", "2024-02-02 14:19:48.462324"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d3365b5e-cc0e-4d1c-98fc-cf141aeb87ac', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.462324000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.462324000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.462324000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fe10e723-cbc2-4ab3-b6ba-7b1895a78c0c\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.463581', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'd3365b5e-cc0e-4d1c-98fc-cf141aeb87ac', '2024-02-02 14:19:48.464598') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.465517"], ["updated_at", "2024-02-02 14:19:48.465517"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5400a9fc-e99c-46c3-9cd2-9c6e66f6fcc5', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.465517000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.465517000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.465517000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8234cf30-7f32-4dbe-9e58-0210e3e45cfc\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.466671', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5400a9fc-e99c-46c3-9cd2-9c6e66f6fcc5', '2024-02-02 14:19:48.467701') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.468893"], ["updated_at", "2024-02-02 14:19:48.468893"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('365d9465-d6b2-4cbc-959b-1857b2271911', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.468893000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.468893000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.468893000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 67a46c8c-e648-45d1-a703-c87d24afce1f\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.470030', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '365d9465-d6b2-4cbc-959b-1857b2271911', '2024-02-02 14:19:48.470999') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.471925"], ["updated_at", "2024-02-02 14:19:48.471925"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('91ae6ece-fca4-47a1-a7f7-e8d17891da91', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.471925000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.471925000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.471925000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 38d48028-9334-4fb1-8714-13d3d84e2ca5\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.473105', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '91ae6ece-fca4-47a1-a7f7-e8d17891da91', '2024-02-02 14:19:48.474164') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:19:48.475112"], ["updated_at", "2024-02-02 14:19:48.475112"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e5a10e57-bd62-411b-b6e5-6ccd1aa7f01f', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:19:48.475112000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:19:48.475112000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:19:48.475112000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 37c1b309-c24d-4aff-851a-e1fb9586251b\n"', 'EntityHistory::Events::Created', '2024-02-02 14:19:48.476213', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'e5a10e57-bd62-411b-b6e5-6ccd1aa7f01f', '2024-02-02 14:19:48.477286') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (46.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (52.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:20:31.664454"], ["updated_at", "2024-02-02 14:20:31.664454"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:20:31.666752"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:20:31.668636"], ["updated_at", "2024-02-02 14:20:31.668636"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.762246"], ["updated_at", "2024-02-02 14:20:31.762246"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4b28a0a2-0419-4ea3-ab6a-14e7a33e2a1e', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.762246000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.762246000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.762246000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6c5739b6-9dc4-425d-bb6d-5ad44ac213ba\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.764147', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '4b28a0a2-0419-4ea3-ab6a-14e7a33e2a1e', '2024-02-02 14:20:31.767588') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.770402"], ["updated_at", "2024-02-02 14:20:31.770402"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e1ec0747-f362-48a7-8837-e9c0a409efda', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.770402000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.770402000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.770402000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: eb347f5e-be5c-4589-bb7c-1b17aca12f59\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.771724', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'e1ec0747-f362-48a7-8837-e9c0a409efda', '2024-02-02 14:20:31.772791') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.773754"], ["updated_at", "2024-02-02 14:20:31.773754"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('45c946e7-fcb1-4e6a-9c23-2006de679b94', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.773754000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.773754000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.773754000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5b67fb1a-b2b2-4d00-b40c-4cd979dd4dd4\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.774941', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '45c946e7-fcb1-4e6a-9c23-2006de679b94', '2024-02-02 14:20:31.776070') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.777082"], ["updated_at", "2024-02-02 14:20:31.777082"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7982c72e-411a-4a3b-8783-d6720e9a8a24', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.777082000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.777082000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.777082000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 25a1fd5d-3e63-42ac-b0f5-5cf76808d827\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.778592', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '7982c72e-411a-4a3b-8783-d6720e9a8a24', '2024-02-02 14:20:31.779581') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.780535"], ["updated_at", "2024-02-02 14:20:31.780535"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9023de64-a095-4e69-a0c3-7c7bf2d95e14', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.780535000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.780535000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.780535000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 226ec5ca-2529-4409-9578-19d26af750db\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.781662', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '9023de64-a095-4e69-a0c3-7c7bf2d95e14', '2024-02-02 14:20:31.782676') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:20:31.783617"], ["updated_at", "2024-02-02 14:20:31.783617"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e1684b5f-ca3d-4a80-9ed2-b780a66a1fa8', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:20:31.783617000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:20:31.783617000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:20:31.783617000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cce042f4-37ee-4f2d-8042-3ee2a03d5a8c\n"', 'EntityHistory::Events::Created', '2024-02-02 14:20:31.784836', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'e1684b5f-ca3d-4a80-9ed2-b780a66a1fa8', '2024-02-02 14:20:31.785827') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:24:25.078522"], ["updated_at", "2024-02-02 14:24:25.078522"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:24:25.081248"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:24:25.083195"], ["updated_at", "2024-02-02 14:24:25.083195"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.170464"], ["updated_at", "2024-02-02 14:24:25.170464"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b6a74bd3-b2fa-4f1c-ba98-2787465ddb91', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.170464000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.170464000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.170464000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7360f4c7-d03f-482e-8c9c-4fd1972b55ce\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.172420', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'b6a74bd3-b2fa-4f1c-ba98-2787465ddb91', '2024-02-02 14:24:25.175838') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.178941"], ["updated_at", "2024-02-02 14:24:25.178941"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cf805d0e-0a5c-414b-afc5-d3496ca6decf', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.178941000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.178941000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.178941000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7423c4d6-edd6-402f-86ab-d87d839d2e81\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.180225', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'cf805d0e-0a5c-414b-afc5-d3496ca6decf', '2024-02-02 14:24:25.181238') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.182158"], ["updated_at", "2024-02-02 14:24:25.182158"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f8228213-44eb-4ced-adfb-e0144ce6b3f7', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.182158000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.182158000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.182158000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bb16c41b-dc0e-4039-aadf-f501e3dc412b\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.183310', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f8228213-44eb-4ced-adfb-e0144ce6b3f7', '2024-02-02 14:24:25.184301') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.185249"], ["updated_at", "2024-02-02 14:24:25.185249"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bfee9be9-fe9c-4ce1-a9f3-28034b922d94', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.185249000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.185249000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.185249000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fab21199-9c54-4d40-a11f-3564eece89fd\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.186381', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'bfee9be9-fe9c-4ce1-a9f3-28034b922d94', '2024-02-02 14:24:25.187387') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.188256"], ["updated_at", "2024-02-02 14:24:25.188256"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9c119e8b-ade6-4c25-bbf6-ba891e9d25a1', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.188256000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.188256000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.188256000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e2439286-7cba-49b4-b251-8eeb5a9c81e9\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.189447', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '9c119e8b-ade6-4c25-bbf6-ba891e9d25a1', '2024-02-02 14:24:25.190452') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:24:25.191401"], ["updated_at", "2024-02-02 14:24:25.191401"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('518cbbcd-abc5-40ee-9c21-eefa863e35cc', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:24:25.191401000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.191401000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:24:25.191401000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b19aff72-984d-47b7-8a10-b4fcdd079956\n"', 'EntityHistory::Events::Created', '2024-02-02 14:24:25.192631', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '518cbbcd-abc5-40ee-9c21-eefa863e35cc', '2024-02-02 14:24:25.193593') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_40566"], ["updated_at", "2024-02-02 14:24:25.194481"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f3105865-926a-4b1e-a9df-203e6b941ff2', '"---\n:attributes:\n  id: 2\n  title: Good Job_40566\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:24:25.178941000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.178941000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:24:25.194481000 Z\n    zone: *1\n    time: 2024-02-02 14:24:25.194481000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_40566\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:24:25.178941000 Z\n  - *3\n"', '"---\n:correlation_id: a6213bb4-b123-46c9-9cce-9a35f927bca4\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:24:25.195690', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f3105865-926a-4b1e-a9df-203e6b941ff2', '2024-02-02 14:24:25.196606') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_1304"], ["updated_at", "2024-02-02 14:24:25.197429"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4976c8ab-ad4a-4218-b0a9-237b91c864f4', '"---\n:attributes:\n  id: 3\n  title: Good Job_1304\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:24:25.182158000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.182158000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:24:25.197429000 Z\n    zone: *1\n    time: 2024-02-02 14:24:25.197429000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_1304\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:24:25.182158000 Z\n  - *3\n"', '"---\n:correlation_id: 3994adf0-6d9f-423c-baa9-6918f2226480\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:24:25.198471', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '4976c8ab-ad4a-4218-b0a9-237b91c864f4', '2024-02-02 14:24:25.199370') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_44761"], ["updated_at", "2024-02-02 14:24:25.200184"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('07e94c0e-169c-42db-8ced-8a15e2c97d2b', '"---\n:attributes:\n  id: 4\n  title: Good Job_44761\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:24:25.185249000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.185249000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:24:25.200184000 Z\n    zone: *1\n    time: 2024-02-02 14:24:25.200184000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_44761\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:24:25.185249000 Z\n  - *3\n"', '"---\n:correlation_id: 1fcba06c-5d6f-46f8-b667-eaf60d3aba6b\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:24:25.201228', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '07e94c0e-169c-42db-8ced-8a15e2c97d2b', '2024-02-02 14:24:25.202125') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_94400"], ["updated_at", "2024-02-02 14:24:25.205398"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d52fb989-ba1b-4a31-aa59-02c51f33af19', '"---\n:attributes:\n  id: 5\n  title: Good Job_94400\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:24:25.188256000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.188256000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:24:25.205398000 Z\n    zone: *1\n    time: 2024-02-02 14:24:25.205398000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_94400\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:24:25.188256000 Z\n  - *3\n"', '"---\n:correlation_id: a69a50aa-9cb5-48d9-8181-ac35d48a14b6\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:24:25.206497', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'd52fb989-ba1b-4a31-aa59-02c51f33af19', '2024-02-02 14:24:25.207732') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_52901"], ["updated_at", "2024-02-02 14:24:25.208682"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('58edd22b-9846-4633-8285-dec12b791b12', '"---\n:attributes:\n  id: 6\n  title: Good Job_52901\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:24:25.191401000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:24:25.191401000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:24:25.208682000 Z\n    zone: *1\n    time: 2024-02-02 14:24:25.208682000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_52901\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:24:25.191401000 Z\n  - *3\n"', '"---\n:correlation_id: 70754fc5-beba-4c0d-9476-27971d774556\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:24:25.209791', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '58edd22b-9846-4633-8285-dec12b791b12', '2024-02-02 14:24:25.210912') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:25:11.952148"], ["updated_at", "2024-02-02 14:25:11.952148"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:25:11.954617"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:25:11.956554"], ["updated_at", "2024-02-02 14:25:11.956554"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.043036"], ["updated_at", "2024-02-02 14:25:12.043036"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fc3d53b3-84c3-4d75-b714-85ef44b760c3', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.043036000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.043036000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.043036000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 298a904f-0568-4723-bcf6-be2be6453c2d\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.044879', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'fc3d53b3-84c3-4d75-b714-85ef44b760c3', '2024-02-02 14:25:12.048211') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.050978"], ["updated_at", "2024-02-02 14:25:12.050978"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c53591f2-67a7-4a93-a2cf-3cd008e551bf', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.050978000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.050978000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.050978000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9beeb399-a249-4538-8752-f36d9940fbdd\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.052230', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'c53591f2-67a7-4a93-a2cf-3cd008e551bf', '2024-02-02 14:25:12.053250') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.054161"], ["updated_at", "2024-02-02 14:25:12.054161"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b93d1ecd-bda8-42b5-a1ac-bfd24f223ef3', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.054161000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.054161000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.054161000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 312522fe-8a06-4cd4-9947-76a3db6cf353\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.055302', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'b93d1ecd-bda8-42b5-a1ac-bfd24f223ef3', '2024-02-02 14:25:12.056291') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.057204"], ["updated_at", "2024-02-02 14:25:12.057204"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('36ba2ac7-961d-48b6-b8f9-27f6f7b4c5e7', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.057204000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.057204000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.057204000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 78eef0ed-3317-470e-ab96-46337557dfc2\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.058309', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '36ba2ac7-961d-48b6-b8f9-27f6f7b4c5e7', '2024-02-02 14:25:12.059249') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.060147"], ["updated_at", "2024-02-02 14:25:12.060147"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e622f850-b819-4513-8a48-2eada559b25d', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.060147000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.060147000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.060147000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 78596d50-a8c4-4555-801f-a876023672d1\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.061239', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'e622f850-b819-4513-8a48-2eada559b25d', '2024-02-02 14:25:12.062206') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:25:12.063105"], ["updated_at", "2024-02-02 14:25:12.063105"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dab3cb3d-0faf-4616-8b46-ddd0355274ae', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:25:12.063105000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.063105000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:25:12.063105000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5b1331c0-0085-4b15-9b98-5dbdc7c551b5\n"', 'EntityHistory::Events::Created', '2024-02-02 14:25:12.064330', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'dab3cb3d-0faf-4616-8b46-ddd0355274ae', '2024-02-02 14:25:12.065340') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_20344"], ["updated_at", "2024-02-02 14:25:12.066253"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1fc8685c-9e64-449a-85e4-25b37fc11e8f', '"---\n:attributes:\n  id: 2\n  title: Good Job_20344\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:25:12.050978000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.050978000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:25:12.066253000 Z\n    zone: *1\n    time: 2024-02-02 14:25:12.066253000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_20344\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:25:12.050978000 Z\n  - *3\n"', '"---\n:correlation_id: f62bff57-0aac-42d7-bcb8-45d2b1308091\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:25:12.067450', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '1fc8685c-9e64-449a-85e4-25b37fc11e8f', '2024-02-02 14:25:12.068378') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_72720"], ["updated_at", "2024-02-02 14:25:12.069180"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('367343c0-0959-4571-b9d6-1a60bde62caa', '"---\n:attributes:\n  id: 3\n  title: Good Job_72720\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:25:12.054161000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.054161000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:25:12.069180000 Z\n    zone: *1\n    time: 2024-02-02 14:25:12.069180000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_72720\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:25:12.054161000 Z\n  - *3\n"', '"---\n:correlation_id: 545ee317-1e08-4640-b233-07145c25a728\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:25:12.070218', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '367343c0-0959-4571-b9d6-1a60bde62caa', '2024-02-02 14:25:12.071110') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_25468"], ["updated_at", "2024-02-02 14:25:12.072262"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c5ecc357-bdec-4a86-9a2f-9a79836e9a76', '"---\n:attributes:\n  id: 4\n  title: Good Job_25468\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:25:12.057204000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.057204000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:25:12.072262000 Z\n    zone: *1\n    time: 2024-02-02 14:25:12.072262000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_25468\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:25:12.057204000 Z\n  - *3\n"', '"---\n:correlation_id: 3d54e674-dc1d-4ca4-b397-7f1cf764f10f\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:25:12.073309', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'c5ecc357-bdec-4a86-9a2f-9a79836e9a76', '2024-02-02 14:25:12.074263') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_93840"], ["updated_at", "2024-02-02 14:25:12.077880"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e8872ba2-11f2-427f-8a27-e772ad07a3e0', '"---\n:attributes:\n  id: 5\n  title: Good Job_93840\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:25:12.060147000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.060147000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:25:12.077880000 Z\n    zone: *1\n    time: 2024-02-02 14:25:12.077880000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_93840\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:25:12.060147000 Z\n  - *3\n"', '"---\n:correlation_id: bb77d04e-6155-4cf0-b768-5f6d2c125b90\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:25:12.079008', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'e8872ba2-11f2-427f-8a27-e772ad07a3e0', '2024-02-02 14:25:12.080061') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_31524"], ["updated_at", "2024-02-02 14:25:12.080899"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('42c3c504-49fc-422d-836d-dc255695e646', '"---\n:attributes:\n  id: 6\n  title: Good Job_31524\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:25:12.063105000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:25:12.063105000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:25:12.080899000 Z\n    zone: *1\n    time: 2024-02-02 14:25:12.080899000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_31524\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:25:12.063105000 Z\n  - *3\n"', '"---\n:correlation_id: 461a4c05-7b76-443c-958c-ecc2f7b26895\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:25:12.081952', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '42c3c504-49fc-422d-836d-dc255695e646', '2024-02-02 14:25:12.082865') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (63.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:29:40.262314"], ["updated_at", "2024-02-02 14:29:40.262314"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:29:40.265277"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:29:40.267438"], ["updated_at", "2024-02-02 14:29:40.267438"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.363280"], ["updated_at", "2024-02-02 14:29:40.363280"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f67d87c1-692e-45ff-9baf-cb66eefbd999', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.363280000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.363280000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.363280000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fc3aabee-bf3f-44f8-b5f0-2241632a2c75\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.365086', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'f67d87c1-692e-45ff-9baf-cb66eefbd999', '2024-02-02 14:29:40.368351') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.371266"], ["updated_at", "2024-02-02 14:29:40.371266"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6267c8a4-1e40-4234-979f-05f626cdfd5e', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.371266000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.371266000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.371266000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9e1e55c8-94f6-4852-8b96-021a84bd8be2\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.372530', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '6267c8a4-1e40-4234-979f-05f626cdfd5e', '2024-02-02 14:29:40.373566') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.374478"], ["updated_at", "2024-02-02 14:29:40.374478"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7ab8276e-20b5-41b3-a782-1e6482cd41c4', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.374478000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.374478000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.374478000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2dedf9fc-62f1-4628-9b3b-c0d545daddc3\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.375670', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '7ab8276e-20b5-41b3-a782-1e6482cd41c4', '2024-02-02 14:29:40.376694') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.377631"], ["updated_at", "2024-02-02 14:29:40.377631"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d4d44199-7375-4ac6-9c15-4afd75115246', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.377631000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.377631000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.377631000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3c7f8361-3945-409f-876b-68368e9ef499\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.378758', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'd4d44199-7375-4ac6-9c15-4afd75115246', '2024-02-02 14:29:40.379784') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.380786"], ["updated_at", "2024-02-02 14:29:40.380786"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4fee5f65-aaf2-46bc-83db-0a568a7b2d99', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.380786000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.380786000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.380786000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 240de3d6-7383-4286-ae67-1a2a097e8745\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.382277', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '4fee5f65-aaf2-46bc-83db-0a568a7b2d99', '2024-02-02 14:29:40.383522') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:29:40.384803"], ["updated_at", "2024-02-02 14:29:40.384803"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('97472d06-33eb-427f-b33a-417bf1b1c1da', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:29:40.384803000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.384803000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:29:40.384803000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b204c6a4-68e4-47f9-a02d-def7506cbc47\n"', 'EntityHistory::Events::Created', '2024-02-02 14:29:40.386045', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '97472d06-33eb-427f-b33a-417bf1b1c1da', '2024-02-02 14:29:40.387154') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_27939"], ["updated_at", "2024-02-02 14:29:40.388222"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1d85f27d-acea-4561-b3bd-533ea01d9d22', '"---\n:attributes:\n  id: 2\n  title: Good Job_27939\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:29:40.371266000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.371266000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:29:40.388222000 Z\n    zone: *1\n    time: 2024-02-02 14:29:40.388222000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_27939\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:29:40.371266000 Z\n  - *3\n"', '"---\n:correlation_id: b12a33b8-6c78-4a4c-89ee-5efb66c549bd\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:29:40.389718', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '1d85f27d-acea-4561-b3bd-533ea01d9d22', '2024-02-02 14:29:40.390812') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_25839"], ["updated_at", "2024-02-02 14:29:40.391751"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3d9f43ec-7328-4e3d-9dc3-a70cd82be01d', '"---\n:attributes:\n  id: 3\n  title: Good Job_25839\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:29:40.374478000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.374478000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:29:40.391751000 Z\n    zone: *1\n    time: 2024-02-02 14:29:40.391751000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_25839\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:29:40.374478000 Z\n  - *3\n"', '"---\n:correlation_id: 260b1d83-a82b-4ec9-b0a4-82b41c6dd4c4\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:29:40.392915', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '3d9f43ec-7328-4e3d-9dc3-a70cd82be01d', '2024-02-02 14:29:40.393900') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_70234"], ["updated_at", "2024-02-02 14:29:40.394824"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5143f1ed-fa50-46e1-bf25-9cbc341d6f4c', '"---\n:attributes:\n  id: 4\n  title: Good Job_70234\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:29:40.377631000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.377631000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:29:40.394824000 Z\n    zone: *1\n    time: 2024-02-02 14:29:40.394824000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_70234\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:29:40.377631000 Z\n  - *3\n"', '"---\n:correlation_id: a4ddafdb-099d-401a-9621-028c967b9297\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:29:40.395988', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '5143f1ed-fa50-46e1-bf25-9cbc341d6f4c', '2024-02-02 14:29:40.396963') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_89290"], ["updated_at", "2024-02-02 14:29:40.397864"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.5ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5a371ede-5bed-4316-8291-81df23b4a2d2', '"---\n:attributes:\n  id: 5\n  title: Good Job_89290\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:29:40.380786000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.380786000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:29:40.397864000 Z\n    zone: *1\n    time: 2024-02-02 14:29:40.397864000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_89290\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:29:40.380786000 Z\n  - *3\n"', '"---\n:correlation_id: 29c11dc6-51c2-4fad-9472-e686807c7347\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:29:40.401699', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '5a371ede-5bed-4316-8291-81df23b4a2d2', '2024-02-02 14:29:40.403189') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_51294"], ["updated_at", "2024-02-02 14:29:40.404147"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('96c4a1d8-70c8-4fde-bd47-ac799f0686a1', '"---\n:attributes:\n  id: 6\n  title: Good Job_51294\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:29:40.384803000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:29:40.384803000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:29:40.404147000 Z\n    zone: *1\n    time: 2024-02-02 14:29:40.404147000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_51294\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:29:40.384803000 Z\n  - *3\n"', '"---\n:correlation_id: 6d0cc610-6196-4880-9553-7b45902f183e\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:29:40.405382', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '96c4a1d8-70c8-4fde-bd47-ac799f0686a1', '2024-02-02 14:29:40.406462') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.7ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_1"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.5ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" = $1[0m  [["event_id", "f67d87c1-692e-45ff-9baf-cb66eefbd999"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.8ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 1) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_1"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (49.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (11.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:33:53.843049"], ["updated_at", "2024-02-02 14:33:53.843049"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:33:53.845808"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:33:53.847942"], ["updated_at", "2024-02-02 14:33:53.847942"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:33:53.939858"], ["updated_at", "2024-02-02 14:33:53.939858"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b37e19e4-4776-421c-99f0-341dac089aa4', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:33:53.939858000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:33:53.939858000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:33:53.939858000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1ce6db8a-f50d-44a0-82fe-63d872f567f5\n"', 'EntityHistory::Events::Created', '2024-02-02 14:33:53.941704', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'b37e19e4-4776-421c-99f0-341dac089aa4', '2024-02-02 14:33:53.945065') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:33:53.947846"], ["updated_at", "2024-02-02 14:33:53.947846"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b4998951-65fb-47b7-a341-118f23680d02', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:33:53.947846000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:33:53.947846000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:33:53.947846000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 62465471-25e1-4fe3-8c21-dc727b590978\n"', 'EntityHistory::Events::Created', '2024-02-02 14:33:53.949076', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'b4998951-65fb-47b7-a341-118f23680d02', '2024-02-02 14:33:53.950092') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (58.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:34:17.241915"], ["updated_at", "2024-02-02 14:34:17.241915"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:34:17.244686"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:34:17.246678"], ["updated_at", "2024-02-02 14:34:17.246678"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:34:17.335131"], ["updated_at", "2024-02-02 14:34:17.335131"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a31f5eb3-dca7-4897-9ba9-1e0f9429340b', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:34:17.335131000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:34:17.335131000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:34:17.335131000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1a5f4b77-c1a8-4196-8370-ce96b22a55f2\n"', 'EntityHistory::Events::Created', '2024-02-02 14:34:17.336923', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'a31f5eb3-dca7-4897-9ba9-1e0f9429340b', '2024-02-02 14:34:17.340237') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:34:17.343025"], ["updated_at", "2024-02-02 14:34:17.343025"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4aaffba6-0c4e-439f-bef0-b551bab1a947', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:34:17.343025000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:34:17.343025000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:34:17.343025000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: adf32ee0-41bd-4e94-bdf4-9ec4de01a34b\n"', 'EntityHistory::Events::Created', '2024-02-02 14:34:17.344267', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4aaffba6-0c4e-439f-bef0-b551bab1a947', '2024-02-02 14:34:17.345271') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_88099"], ["updated_at", "2024-02-02 14:34:17.346168"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ec388e30-f10e-4f5b-97b4-25e0a5a3eba7', '"---\n:attributes:\n  id: 2\n  title: Good Job_88099\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:34:17.343025000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:34:17.343025000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:34:17.346168000 Z\n    zone: *1\n    time: 2024-02-02 14:34:17.346168000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_88099\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:34:17.343025000 Z\n  - *3\n"', '"---\n:correlation_id: 38cba348-4179-4dfa-b7c2-880f2db8abf4\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:34:17.347358', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ec388e30-f10e-4f5b-97b4-25e0a5a3eba7', '2024-02-02 14:34:17.348337') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "4aaffba6-0c4e-439f-bef0-b551bab1a947"], ["event_id", "ec388e30-f10e-4f5b-97b4-25e0a5a3eba7"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (54.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:35:32.731023"], ["updated_at", "2024-02-02 14:35:32.731023"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:35:32.733767"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:35:32.735734"], ["updated_at", "2024-02-02 14:35:32.735734"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:35:32.824435"], ["updated_at", "2024-02-02 14:35:32.824435"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2e280c21-f802-4d26-9b6e-9527af3dd8b6', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:35:32.824435000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:35:32.824435000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:35:32.824435000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 70eb3be9-3059-4e9c-80e2-2e2404fbab61\n"', 'EntityHistory::Events::Created', '2024-02-02 14:35:32.826257', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '2e280c21-f802-4d26-9b6e-9527af3dd8b6', '2024-02-02 14:35:32.829635') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:35:32.832447"], ["updated_at", "2024-02-02 14:35:32.832447"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ffefa196-cf2c-4112-8b8b-2afe52eece19', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:35:32.832447000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:35:32.832447000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:35:32.832447000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e17f75b3-c1b2-4505-988c-32ca49916c42\n"', 'EntityHistory::Events::Created', '2024-02-02 14:35:32.833679', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ffefa196-cf2c-4112-8b8b-2afe52eece19', '2024-02-02 14:35:32.834670') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_16271"], ["updated_at", "2024-02-02 14:35:32.835577"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('92a831d7-f6c7-4f59-8677-83c4529cd7aa', '"---\n:attributes:\n  id: 2\n  title: Good Job_16271\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:35:32.832447000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:35:32.832447000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:35:32.835577000 Z\n    zone: *1\n    time: 2024-02-02 14:35:32.835577000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_16271\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:35:32.832447000 Z\n  - *3\n"', '"---\n:correlation_id: 54ac5fc6-5d4f-45ac-8b52-43330796b248\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:35:32.836804', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '92a831d7-f6c7-4f59-8677-83c4529cd7aa', '2024-02-02 14:35:32.837742') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ffefa196-cf2c-4112-8b8b-2afe52eece19"], ["event_id", "92a831d7-f6c7-4f59-8677-83c4529cd7aa"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (50.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:36:02.145309"], ["updated_at", "2024-02-02 14:36:02.145309"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:36:02.147983"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:36:02.150069"], ["updated_at", "2024-02-02 14:36:02.150069"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:36:02.237700"], ["updated_at", "2024-02-02 14:36:02.237700"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d5fee598-f2ed-41fe-97aa-360698f7cc2c', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:36:02.237700000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:36:02.237700000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:36:02.237700000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1f0fb06d-6230-459c-a46b-276cb4f9cb30\n"', 'EntityHistory::Events::Created', '2024-02-02 14:36:02.239772', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'd5fee598-f2ed-41fe-97aa-360698f7cc2c', '2024-02-02 14:36:02.243152') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:36:02.245950"], ["updated_at", "2024-02-02 14:36:02.245950"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('17e98b03-d245-4157-8ba6-3cbc8dd2a729', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:36:02.245950000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:36:02.245950000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:36:02.245950000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e48622f4-4ad7-4fe0-81f8-bf482d89b374\n"', 'EntityHistory::Events::Created', '2024-02-02 14:36:02.247187', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '17e98b03-d245-4157-8ba6-3cbc8dd2a729', '2024-02-02 14:36:02.248190') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_99959"], ["updated_at", "2024-02-02 14:36:02.249102"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5985c81c-efd6-4a83-a7cc-030a893065ab', '"---\n:attributes:\n  id: 2\n  title: Good Job_99959\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:36:02.245950000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:36:02.245950000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:36:02.249102000 Z\n    zone: *1\n    time: 2024-02-02 14:36:02.249102000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_99959\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:36:02.245950000 Z\n  - *3\n"', '"---\n:correlation_id: 6d43a792-33f9-4dcb-847e-a10344c0ae8d\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:36:02.250331', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '5985c81c-efd6-4a83-a7cc-030a893065ab', '2024-02-02 14:36:02.251271') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "17e98b03-d245-4157-8ba6-3cbc8dd2a729"], ["event_id", "5985c81c-efd6-4a83-a7cc-030a893065ab"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:38:42.101807"], ["updated_at", "2024-02-02 14:38:42.101807"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:38:42.104329"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:38:42.106236"], ["updated_at", "2024-02-02 14:38:42.106236"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:38:59.757186"], ["updated_at", "2024-02-02 14:38:59.757186"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:38:59.759893"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:38:59.761775"], ["updated_at", "2024-02-02 14:38:59.761775"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:38:59.851154"], ["updated_at", "2024-02-02 14:38:59.851154"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('597db162-6690-45c9-b47e-9f238b438539', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:38:59.851154000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:38:59.851154000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:38:59.851154000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9eb9634d-ca6a-40a1-8799-6431330a77d1\n"', 'EntityHistory::Events::Created', '2024-02-02 14:38:59.853269', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '597db162-6690-45c9-b47e-9f238b438539', '2024-02-02 14:38:59.856655') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:38:59.859412"], ["updated_at", "2024-02-02 14:38:59.859412"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('96ab49d8-5dc4-4510-86f8-b23e8e21266e', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:38:59.859412000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:38:59.859412000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:38:59.859412000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5c419d47-f961-46d9-8215-452e3eca8f83\n"', 'EntityHistory::Events::Created', '2024-02-02 14:38:59.860567', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '96ab49d8-5dc4-4510-86f8-b23e8e21266e', '2024-02-02 14:38:59.861564') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_37034"], ["updated_at", "2024-02-02 14:38:59.862447"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4b868321-37d3-4403-96d8-e568d41bd842', '"---\n:attributes:\n  id: 2\n  title: Good Job_37034\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:38:59.859412000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:38:59.859412000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:38:59.862447000 Z\n    zone: *1\n    time: 2024-02-02 14:38:59.862447000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_37034\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:38:59.859412000 Z\n  - *3\n"', '"---\n:correlation_id: bd87b1d3-523d-44cd-b5a0-40d711e037ae\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:38:59.863643', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4b868321-37d3-4403-96d8-e568d41bd842', '2024-02-02 14:38:59.864591') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "96ab49d8-5dc4-4510-86f8-b23e8e21266e"], ["event_id", "4b868321-37d3-4403-96d8-e568d41bd842"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:38:59.874561"], ["updated_at", "2024-02-02 14:38:59.874561"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('41a69d64-bec3-4ceb-9caf-6f5569f9ed8c', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:38:59.874561000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:38:59.874561000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:38:59.874561000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0a78f74c-70e3-4a2e-8087-ccf40743e2ca\n"', 'EntityHistory::Events::Created', '2024-02-02 14:38:59.875751', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '41a69d64-bec3-4ceb-9caf-6f5569f9ed8c', '2024-02-02 14:38:59.876771') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_93515"], ["updated_at", "2024-02-02 14:38:59.877679"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ab3de8d3-0945-474f-b99e-81192f1b5969', '"---\n:attributes:\n  id: 3\n  title: Good Job_93515\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:38:59.874561000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:38:59.874561000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:38:59.877679000 Z\n    zone: *1\n    time: 2024-02-02 14:38:59.877679000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_93515\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:38:59.874561000 Z\n  - *3\n"', '"---\n:correlation_id: 1c608e8d-f07a-4855-9688-8b9ce007d5c1\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:38:59.878745', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'ab3de8d3-0945-474f-b99e-81192f1b5969', '2024-02-02 14:38:59.879673') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (1.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.6ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "41a69d64-bec3-4ceb-9caf-6f5569f9ed8c"], ["event_id", "ab3de8d3-0945-474f-b99e-81192f1b5969"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.5ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (57.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:39:31.035196"], ["updated_at", "2024-02-02 14:39:31.035196"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:39:31.038089"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:39:31.040227"], ["updated_at", "2024-02-02 14:39:31.040227"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:39:31.127084"], ["updated_at", "2024-02-02 14:39:31.127084"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('37803b0e-1edd-4fc8-8f9b-1c387a836cb9', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:39:31.127084000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:39:31.127084000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:39:31.127084000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ed267742-732a-486b-b63e-7f35b2c34ccf\n"', 'EntityHistory::Events::Created', '2024-02-02 14:39:31.128974', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '37803b0e-1edd-4fc8-8f9b-1c387a836cb9', '2024-02-02 14:39:31.132313') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:39:31.135057"], ["updated_at", "2024-02-02 14:39:31.135057"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('141f8260-03eb-4705-9bb7-f753847aa072', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:39:31.135057000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:39:31.135057000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:39:31.135057000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e9bf2104-ba27-4554-9ac5-6f86ff249dab\n"', 'EntityHistory::Events::Created', '2024-02-02 14:39:31.136255', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '141f8260-03eb-4705-9bb7-f753847aa072', '2024-02-02 14:39:31.137308') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_4688"], ["updated_at", "2024-02-02 14:39:31.138203"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fa972554-1509-4504-a22a-56f677b2305b', '"---\n:attributes:\n  id: 2\n  title: Good Job_4688\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:39:31.135057000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:39:31.135057000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:39:31.138203000 Z\n    zone: *1\n    time: 2024-02-02 14:39:31.138203000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_4688\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:39:31.135057000 Z\n  - *3\n"', '"---\n:correlation_id: ad9d2ab9-e7cb-4db6-bd82-c5c7082fde23\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:39:31.139412', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fa972554-1509-4504-a22a-56f677b2305b', '2024-02-02 14:39:31.140345') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "141f8260-03eb-4705-9bb7-f753847aa072"], ["event_id", "fa972554-1509-4504-a22a-56f677b2305b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:39:31.155367"], ["updated_at", "2024-02-02 14:39:31.155367"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e46373bc-fe03-46ed-a571-97ec353c3516', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:39:31.155367000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:39:31.155367000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:39:31.155367000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ca8accb7-e31f-4acc-afa9-7ce95fddb3ab\n"', 'EntityHistory::Events::Created', '2024-02-02 14:39:31.156826', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'e46373bc-fe03-46ed-a571-97ec353c3516', '2024-02-02 14:39:31.157990') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_70850"], ["updated_at", "2024-02-02 14:39:31.159437"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d6e968d2-15be-4143-908b-97e4d8bce0b6', '"---\n:attributes:\n  id: 3\n  title: Good Job_70850\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:39:31.155367000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:39:31.155367000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:39:31.159437000 Z\n    zone: *1\n    time: 2024-02-02 14:39:31.159437000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_70850\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:39:31.155367000 Z\n  - *3\n"', '"---\n:correlation_id: 7bbaf3a7-2804-4072-81f4-158914d09927\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:39:31.160612', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd6e968d2-15be-4143-908b-97e4d8bce0b6', '2024-02-02 14:39:31.161749') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (1.0ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.6ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e46373bc-fe03-46ed-a571-97ec353c3516"], ["event_id", "d6e968d2-15be-4143-908b-97e4d8bce0b6"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.5ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (52.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:40:46.131647"], ["updated_at", "2024-02-02 14:40:46.131647"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:40:46.134396"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:40:46.136374"], ["updated_at", "2024-02-02 14:40:46.136374"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:40:46.225474"], ["updated_at", "2024-02-02 14:40:46.225474"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d863ac57-60eb-442a-b32a-51462ea178d3', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:40:46.225474000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:40:46.225474000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:40:46.225474000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a771138e-f8e9-4622-ba1c-2661357e5284\n"', 'EntityHistory::Events::Created', '2024-02-02 14:40:46.227232', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'd863ac57-60eb-442a-b32a-51462ea178d3', '2024-02-02 14:40:46.230545') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:40:46.233410"], ["updated_at", "2024-02-02 14:40:46.233410"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('894b9115-5e56-4e3b-bacf-c58cff02f3a9', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:40:46.233410000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:40:46.233410000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:40:46.233410000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e819cd66-ccfd-4a1e-a70f-94d4b57b0349\n"', 'EntityHistory::Events::Created', '2024-02-02 14:40:46.234571', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '894b9115-5e56-4e3b-bacf-c58cff02f3a9', '2024-02-02 14:40:46.235591') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_29290"], ["updated_at", "2024-02-02 14:40:46.236494"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b30df517-f23a-4057-abd9-c5580b7dc6c1', '"---\n:attributes:\n  id: 2\n  title: Good Job_29290\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:40:46.233410000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:40:46.233410000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:40:46.236494000 Z\n    zone: *1\n    time: 2024-02-02 14:40:46.236494000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_29290\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:40:46.233410000 Z\n  - *3\n"', '"---\n:correlation_id: 5f43620e-7f69-4028-9b85-5a1e12e9c79b\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:40:46.237683', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'b30df517-f23a-4057-abd9-c5580b7dc6c1', '2024-02-02 14:40:46.238618') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "894b9115-5e56-4e3b-bacf-c58cff02f3a9"], ["event_id", "b30df517-f23a-4057-abd9-c5580b7dc6c1"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:40:46.248589"], ["updated_at", "2024-02-02 14:40:46.248589"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('28cbec17-86e9-425f-920e-3c7753b1eb17', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:40:46.248589000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:40:46.248589000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:40:46.248589000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e4808929-ee29-4dd6-bd7f-abcbf03e6633\n"', 'EntityHistory::Events::Created', '2024-02-02 14:40:46.249861', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '28cbec17-86e9-425f-920e-3c7753b1eb17', '2024-02-02 14:40:46.250856') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_16316"], ["updated_at", "2024-02-02 14:40:46.251756"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1939b115-b7a3-44a4-9e56-c149669bfd2d', '"---\n:attributes:\n  id: 3\n  title: Good Job_16316\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:40:46.248589000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:40:46.248589000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:40:46.251756000 Z\n    zone: *1\n    time: 2024-02-02 14:40:46.251756000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_16316\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:40:46.248589000 Z\n  - *3\n"', '"---\n:correlation_id: 9beb0f74-60bd-4802-ac39-2390d8179c3e\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:40:46.252882', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1939b115-b7a3-44a4-9e56-c149669bfd2d', '2024-02-02 14:40:46.253936') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.4ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "28cbec17-86e9-425f-920e-3c7753b1eb17"], ["event_id", "1939b115-b7a3-44a4-9e56-c149669bfd2d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (4.8ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:41:47.695022"], ["updated_at", "2024-02-02 14:41:47.695022"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:41:47.697565"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:41:47.699534"], ["updated_at", "2024-02-02 14:41:47.699534"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:41:47.784789"], ["updated_at", "2024-02-02 14:41:47.784789"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('882a36fb-d9ea-45ce-8e98-2f738836ae0b', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:41:47.784789000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:41:47.784789000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:41:47.784789000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 95fcd001-c047-45ec-a1d5-59d23534d235\n"', 'EntityHistory::Events::Created', '2024-02-02 14:41:47.786666', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '882a36fb-d9ea-45ce-8e98-2f738836ae0b', '2024-02-02 14:41:47.790242') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:41:47.793178"], ["updated_at", "2024-02-02 14:41:47.793178"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6f238409-0006-4ddb-959a-a6cd1a8833ec', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:41:47.793178000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:41:47.793178000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:41:47.793178000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b4aba191-65ed-4fdf-817d-6fa33a11ae37\n"', 'EntityHistory::Events::Created', '2024-02-02 14:41:47.794350', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '6f238409-0006-4ddb-959a-a6cd1a8833ec', '2024-02-02 14:41:47.795377') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_48374"], ["updated_at", "2024-02-02 14:41:47.796532"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3cec39e2-92ec-4524-9af5-5babdd81fb90', '"---\n:attributes:\n  id: 2\n  title: Good Job_48374\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:41:47.793178000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:41:47.793178000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:41:47.796532000 Z\n    zone: *1\n    time: 2024-02-02 14:41:47.796532000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_48374\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:41:47.793178000 Z\n  - *3\n"', '"---\n:correlation_id: ee8519aa-f628-4a28-928f-f8a9153c477a\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:41:47.797741', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '3cec39e2-92ec-4524-9af5-5babdd81fb90', '2024-02-02 14:41:47.798692') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6f238409-0006-4ddb-959a-a6cd1a8833ec"], ["event_id", "3cec39e2-92ec-4524-9af5-5babdd81fb90"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:41:47.824924"], ["updated_at", "2024-02-02 14:41:47.824924"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cec61a38-024c-4845-b87d-251676a23a3d', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:41:47.824924000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:41:47.824924000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:41:47.824924000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2ecbebeb-3034-455b-87f5-74fa030a9b2d\n"', 'EntityHistory::Events::Created', '2024-02-02 14:41:47.826534', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'cec61a38-024c-4845-b87d-251676a23a3d', '2024-02-02 14:41:47.830787') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_65746"], ["updated_at", "2024-02-02 14:41:47.831806"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9b669bff-3536-4ba5-be7f-490bbe65c489', '"---\n:attributes:\n  id: 3\n  title: Good Job_65746\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:41:47.824924000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:41:47.824924000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:41:47.831806000 Z\n    zone: *1\n    time: 2024-02-02 14:41:47.831806000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_65746\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:41:47.824924000 Z\n  - *3\n"', '"---\n:correlation_id: 9a9d2d83-8b02-41c4-ae0b-59fa457d0840\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:41:47.832916', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '9b669bff-3536-4ba5-be7f-490bbe65c489', '2024-02-02 14:41:47.833914') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "cec61a38-024c-4845-b87d-251676a23a3d"], ["event_id", "9b669bff-3536-4ba5-be7f-490bbe65c489"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:42:16.172415"], ["updated_at", "2024-02-02 14:42:16.172415"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:42:16.175181"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:42:16.177106"], ["updated_at", "2024-02-02 14:42:16.177106"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:16.265558"], ["updated_at", "2024-02-02 14:42:16.265558"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a822f580-77da-4d3a-8574-4927f0f62843', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:16.265558000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:16.265558000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:16.265558000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8508b9ff-8915-41ce-999f-3d3ec2427abb\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:16.267340', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'a822f580-77da-4d3a-8574-4927f0f62843', '2024-02-02 14:42:16.270712') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:16.273514"], ["updated_at", "2024-02-02 14:42:16.273514"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6c61f351-72f1-4efa-b1d9-252d6fbcd61f', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:16.273514000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:16.273514000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:16.273514000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 89e65629-8121-48c4-b5e2-fb76cfd83523\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:16.274749', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '6c61f351-72f1-4efa-b1d9-252d6fbcd61f', '2024-02-02 14:42:16.275769') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_44269"], ["updated_at", "2024-02-02 14:42:16.276677"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fec34d74-b8d2-4e3a-8a05-5e393371512a', '"---\n:attributes:\n  id: 2\n  title: Good Job_44269\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:16.273514000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:16.273514000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:16.276677000 Z\n    zone: *1\n    time: 2024-02-02 14:42:16.276677000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_44269\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:16.273514000 Z\n  - *3\n"', '"---\n:correlation_id: fbb65108-dd8b-4735-9bd7-94de0e13779b\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:16.277895', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fec34d74-b8d2-4e3a-8a05-5e393371512a', '2024-02-02 14:42:16.278812') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.2ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6c61f351-72f1-4efa-b1d9-252d6fbcd61f"], ["event_id", "fec34d74-b8d2-4e3a-8a05-5e393371512a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:16.301611"], ["updated_at", "2024-02-02 14:42:16.301611"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8d1320fe-0b1c-4dc2-bf80-1aa8a6899f52', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:16.301611000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:16.301611000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:16.301611000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d4c5017b-6d4a-4335-9901-e6adc2cc3a4a\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:16.302938', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '8d1320fe-0b1c-4dc2-bf80-1aa8a6899f52', '2024-02-02 14:42:16.304060') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_3199"], ["updated_at", "2024-02-02 14:42:16.305123"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('05a25203-e5d6-4e44-81e9-d6194ff0e1bf', '"---\n:attributes:\n  id: 3\n  title: Good Job_3199\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:16.301611000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:16.301611000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:16.305123000 Z\n    zone: *1\n    time: 2024-02-02 14:42:16.305123000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_3199\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:16.301611000 Z\n  - *3\n"', '"---\n:correlation_id: d22db082-8a39-4566-b568-87dec2a30bdf\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:16.309217', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '05a25203-e5d6-4e44-81e9-d6194ff0e1bf', '2024-02-02 14:42:16.310290') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.3ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "8d1320fe-0b1c-4dc2-bf80-1aa8a6899f52"], ["event_id", "05a25203-e5d6-4e44-81e9-d6194ff0e1bf"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (56.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:42:43.700837"], ["updated_at", "2024-02-02 14:42:43.700837"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:42:43.703605"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:42:43.705494"], ["updated_at", "2024-02-02 14:42:43.705494"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:43.792775"], ["updated_at", "2024-02-02 14:42:43.792775"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('526591c7-c2fb-427f-9c5f-10b7f77baca2', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:43.792775000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:43.792775000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:43.792775000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e59da77f-009f-4c2d-a84c-d418e878200b\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:43.794987', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '526591c7-c2fb-427f-9c5f-10b7f77baca2', '2024-02-02 14:42:43.798294') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:43.801142"], ["updated_at", "2024-02-02 14:42:43.801142"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('24517bdc-6598-4e4e-a238-0c4c6c168305', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:43.801142000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:43.801142000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:43.801142000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 76b3a826-35f2-4b81-b9c9-3405e1e9ef97\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:43.802361', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '24517bdc-6598-4e4e-a238-0c4c6c168305', '2024-02-02 14:42:43.803363') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_69023"], ["updated_at", "2024-02-02 14:42:43.804261"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('603dfbfd-76c9-41fd-bf92-a9961b743cef', '"---\n:attributes:\n  id: 2\n  title: Good Job_69023\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:43.801142000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:43.801142000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:43.804261000 Z\n    zone: *1\n    time: 2024-02-02 14:42:43.804261000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_69023\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:43.801142000 Z\n  - *3\n"', '"---\n:correlation_id: 4eb2c297-d54a-4fa0-aa5c-4891ed1df1bc\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:43.805484', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '603dfbfd-76c9-41fd-bf92-a9961b743cef', '2024-02-02 14:42:43.806420') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "24517bdc-6598-4e4e-a238-0c4c6c168305"], ["event_id", "603dfbfd-76c9-41fd-bf92-a9961b743cef"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:43.816141"], ["updated_at", "2024-02-02 14:42:43.816141"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2f122e89-a3ec-4b58-9123-88a2318929c5', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:43.816141000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:43.816141000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:43.816141000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 73e80f19-4a6b-4ac9-8ac5-3ed94a88e4d4\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:43.817387', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '2f122e89-a3ec-4b58-9123-88a2318929c5', '2024-02-02 14:42:43.818402') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_21399"], ["updated_at", "2024-02-02 14:42:43.819316"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('47b546b3-5a54-449a-8c89-92d08628b9eb', '"---\n:attributes:\n  id: 3\n  title: Good Job_21399\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:43.816141000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:43.816141000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:43.819316000 Z\n    zone: *1\n    time: 2024-02-02 14:42:43.819316000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_21399\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:43.816141000 Z\n  - *3\n"', '"---\n:correlation_id: cc962658-4385-4ac1-be3b-82533d3cb7fa\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:43.820413', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '47b546b3-5a54-449a-8c89-92d08628b9eb', '2024-02-02 14:42:43.821506') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2f122e89-a3ec-4b58-9123-88a2318929c5"], ["event_id", "47b546b3-5a54-449a-8c89-92d08628b9eb"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (57.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:42:56.601815"], ["updated_at", "2024-02-02 14:42:56.601815"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:42:56.604540"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:42:56.606599"], ["updated_at", "2024-02-02 14:42:56.606599"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:56.697215"], ["updated_at", "2024-02-02 14:42:56.697215"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('27ff929b-1ff0-4d88-a9f4-0f42e47d8057', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:56.697215000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:56.697215000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:56.697215000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 968344d5-3c3f-4e0f-bf5b-c02a08c9d81e\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:56.699012', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '27ff929b-1ff0-4d88-a9f4-0f42e47d8057', '2024-02-02 14:42:56.702475') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:56.705343"], ["updated_at", "2024-02-02 14:42:56.705343"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ba146c03-da1b-415e-9e54-5616cae91270', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:56.705343000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:56.705343000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:56.705343000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fb04162f-8e12-41c5-8587-6ac10af6e127\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:56.706622', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ba146c03-da1b-415e-9e54-5616cae91270', '2024-02-02 14:42:56.707643') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_50512"], ["updated_at", "2024-02-02 14:42:56.708550"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f51686da-b2f8-4871-a853-77425646b24f', '"---\n:attributes:\n  id: 2\n  title: Good Job_50512\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:56.705343000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:56.705343000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:56.708550000 Z\n    zone: *1\n    time: 2024-02-02 14:42:56.708550000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_50512\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:56.705343000 Z\n  - *3\n"', '"---\n:correlation_id: 8db18105-d338-46bd-a992-071e2ae32d5a\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:56.709762', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f51686da-b2f8-4871-a853-77425646b24f', '2024-02-02 14:42:56.710715') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ba146c03-da1b-415e-9e54-5616cae91270"], ["event_id", "f51686da-b2f8-4871-a853-77425646b24f"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:42:56.720618"], ["updated_at", "2024-02-02 14:42:56.720618"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('458f2783-6788-4720-b2e7-1dcce1dfa139', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:42:56.720618000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:56.720618000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:42:56.720618000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 61c65068-da0d-41fb-888e-70bb184ca8ac\n"', 'EntityHistory::Events::Created', '2024-02-02 14:42:56.722754', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '458f2783-6788-4720-b2e7-1dcce1dfa139', '2024-02-02 14:42:56.724204') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_9879"], ["updated_at", "2024-02-02 14:42:56.725420"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0ea4b9fa-1708-40f9-8e06-2e65dc7e6ac9', '"---\n:attributes:\n  id: 3\n  title: Good Job_9879\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:42:56.720618000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:42:56.720618000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:42:56.725420000 Z\n    zone: *1\n    time: 2024-02-02 14:42:56.725420000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_9879\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:42:56.720618000 Z\n  - *3\n"', '"---\n:correlation_id: 229ec5b9-a22b-4812-8ab0-263df7cd066a\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:42:56.726842', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '0ea4b9fa-1708-40f9-8e06-2e65dc7e6ac9', '2024-02-02 14:42:56.727942') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "458f2783-6788-4720-b2e7-1dcce1dfa139"], ["event_id", "0ea4b9fa-1708-40f9-8e06-2e65dc7e6ac9"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (36.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (55.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:43:04.446318"], ["updated_at", "2024-02-02 14:43:04.446318"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:43:04.448667"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:43:04.450441"], ["updated_at", "2024-02-02 14:43:04.450441"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:04.535125"], ["updated_at", "2024-02-02 14:43:04.535125"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9da66b3d-3b0f-4895-a40c-0ab47643eb44', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:04.535125000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:04.535125000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:04.535125000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''08bae19b-3348-4db6-af8a-d258829a0783''\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:04.536879', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '9da66b3d-3b0f-4895-a40c-0ab47643eb44', '2024-02-02 14:43:04.540343') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:04.543545"], ["updated_at", "2024-02-02 14:43:04.543545"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('00a8c1b1-171d-41eb-8755-0412c11b37a9', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:04.543545000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:04.543545000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:04.543545000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: eea50d46-f88b-4dda-89fd-d3a98ba33df0\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:04.544795', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '00a8c1b1-171d-41eb-8755-0412c11b37a9', '2024-02-02 14:43:04.545799') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_13273"], ["updated_at", "2024-02-02 14:43:04.546706"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('49c029a0-43c0-4577-af4f-c9af1c3d4200', '"---\n:attributes:\n  id: 2\n  title: Good Job_13273\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:43:04.543545000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:04.543545000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:43:04.546706000 Z\n    zone: *1\n    time: 2024-02-02 14:43:04.546706000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_13273\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:43:04.543545000 Z\n  - *3\n"', '"---\n:correlation_id: e5c52ff7-8366-41e2-85c5-788262ec6bdc\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:43:04.547909', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '49c029a0-43c0-4577-af4f-c9af1c3d4200', '2024-02-02 14:43:04.548835') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "00a8c1b1-171d-41eb-8755-0412c11b37a9"], ["event_id", "49c029a0-43c0-4577-af4f-c9af1c3d4200"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:04.558704"], ["updated_at", "2024-02-02 14:43:04.558704"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a699ad14-cf8d-402d-afdf-bacccf8d1612', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:04.558704000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:04.558704000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:04.558704000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7d4063cc-cc62-492f-a6fb-eac9b7879bf6\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:04.559949', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'a699ad14-cf8d-402d-afdf-bacccf8d1612', '2024-02-02 14:43:04.560979') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_77849"], ["updated_at", "2024-02-02 14:43:04.561888"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c9e63759-0495-4b47-a013-5595e7dfa696', '"---\n:attributes:\n  id: 3\n  title: Good Job_77849\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:43:04.558704000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:04.558704000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:43:04.561888000 Z\n    zone: *1\n    time: 2024-02-02 14:43:04.561888000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_77849\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:43:04.558704000 Z\n  - *3\n"', '"---\n:correlation_id: b677caaa-b1ad-43ba-89a6-dfb492f6ce22\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:43:04.562976', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c9e63759-0495-4b47-a013-5595e7dfa696', '2024-02-02 14:43:04.563916') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "a699ad14-cf8d-402d-afdf-bacccf8d1612"], ["event_id", "c9e63759-0495-4b47-a013-5595e7dfa696"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (36.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (60.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:43:25.872017"], ["updated_at", "2024-02-02 14:43:25.872017"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:43:25.874805"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:43:25.876808"], ["updated_at", "2024-02-02 14:43:25.876808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:25.961483"], ["updated_at", "2024-02-02 14:43:25.961483"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cad79f55-2edb-4b6f-bfc3-774986dbee32', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:25.961483000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:25.961483000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:25.961483000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 65970337-bb64-41e8-806b-708bad4bd573\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:25.963281', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'cad79f55-2edb-4b6f-bfc3-774986dbee32', '2024-02-02 14:43:25.966592') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:25.969346"], ["updated_at", "2024-02-02 14:43:25.969346"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d2aacd57-869c-4cc0-8bef-e390c7454687', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:25.969346000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:25.969346000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:25.969346000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 82e9089c-6b62-44d7-b794-7ebe4e8cae83\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:25.970589', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'd2aacd57-869c-4cc0-8bef-e390c7454687', '2024-02-02 14:43:25.971628') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_27214"], ["updated_at", "2024-02-02 14:43:25.972545"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d17424f5-f64d-43a2-9ffc-7f14aa0b111e', '"---\n:attributes:\n  id: 2\n  title: Good Job_27214\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:43:25.969346000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:25.969346000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:43:25.972545000 Z\n    zone: *1\n    time: 2024-02-02 14:43:25.972545000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_27214\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:43:25.969346000 Z\n  - *3\n"', '"---\n:correlation_id: 48985ec6-edb3-4e9a-843a-c32d03f4c9c0\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:43:25.973740', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'd17424f5-f64d-43a2-9ffc-7f14aa0b111e', '2024-02-02 14:43:25.974677') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d2aacd57-869c-4cc0-8bef-e390c7454687"], ["event_id", "d17424f5-f64d-43a2-9ffc-7f14aa0b111e"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:43:25.989502"], ["updated_at", "2024-02-02 14:43:25.989502"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('63d97c0f-df39-4bd0-8c5f-1bfea6590c24', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:43:25.989502000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:25.989502000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:43:25.989502000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1260d97f-bf55-41db-8865-51c752ca993d\n"', 'EntityHistory::Events::Created', '2024-02-02 14:43:25.991285', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '63d97c0f-df39-4bd0-8c5f-1bfea6590c24', '2024-02-02 14:43:25.992412') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_58711"], ["updated_at", "2024-02-02 14:43:25.993371"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('161d866b-8749-4206-b702-c38c53388c10', '"---\n:attributes:\n  id: 3\n  title: Good Job_58711\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:43:25.989502000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:43:25.989502000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:43:25.993371000 Z\n    zone: *1\n    time: 2024-02-02 14:43:25.993371000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_58711\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:43:25.989502000 Z\n  - *3\n"', '"---\n:correlation_id: e1c6cf3b-6b87-478a-a4d2-519bfff9739d\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:43:25.994496', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '161d866b-8749-4206-b702-c38c53388c10', '2024-02-02 14:43:25.995437') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "63d97c0f-df39-4bd0-8c5f-1bfea6590c24"], ["event_id", "161d866b-8749-4206-b702-c38c53388c10"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:45:41.791116"], ["updated_at", "2024-02-02 14:45:41.791116"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:45:41.793868"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:45:41.795853"], ["updated_at", "2024-02-02 14:45:41.795853"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:45:41.883503"], ["updated_at", "2024-02-02 14:45:41.883503"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('184ea01e-3d50-4485-83a5-9853c5254d63', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:45:41.883503000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:45:41.883503000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:45:41.883503000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cf5e0af4-f87b-446e-8070-ef3f836f9e8a\n"', 'EntityHistory::Events::Created', '2024-02-02 14:45:41.885489', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '184ea01e-3d50-4485-83a5-9853c5254d63', '2024-02-02 14:45:41.888953') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:45:41.891812"], ["updated_at", "2024-02-02 14:45:41.891812"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('59dae124-99ac-493e-96f3-3f4ba9e5ca21', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:45:41.891812000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:45:41.891812000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:45:41.891812000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b7dc1918-d2d4-43ce-9816-07a7aeeec42e\n"', 'EntityHistory::Events::Created', '2024-02-02 14:45:41.893065', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '59dae124-99ac-493e-96f3-3f4ba9e5ca21', '2024-02-02 14:45:41.894078') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_51352"], ["updated_at", "2024-02-02 14:45:41.895026"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('414004e1-4a30-4853-8455-a54062cb82a4', '"---\n:attributes:\n  id: 2\n  title: Good Job_51352\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:45:41.891812000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:45:41.891812000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:45:41.895026000 Z\n    zone: *1\n    time: 2024-02-02 14:45:41.895026000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_51352\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:45:41.891812000 Z\n  - *3\n"', '"---\n:correlation_id: 211186a3-3b5f-40bf-9fa6-41b7219a3ef8\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:45:41.896247', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '414004e1-4a30-4853-8455-a54062cb82a4', '2024-02-02 14:45:41.897191') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "59dae124-99ac-493e-96f3-3f4ba9e5ca21"], ["event_id", "414004e1-4a30-4853-8455-a54062cb82a4"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:45:41.906932"], ["updated_at", "2024-02-02 14:45:41.906932"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('385a76d0-937f-4268-a41b-9723015e7099', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:45:41.906932000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:45:41.906932000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:45:41.906932000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e88f1a20-5e8b-4534-8309-aed4e30d570a\n"', 'EntityHistory::Events::Created', '2024-02-02 14:45:41.908142', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '385a76d0-937f-4268-a41b-9723015e7099', '2024-02-02 14:45:41.909204') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_91049"], ["updated_at", "2024-02-02 14:45:41.910438"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bfc20d38-7c87-419a-aff5-6b79f6924081', '"---\n:attributes:\n  id: 3\n  title: Good Job_91049\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:45:41.906932000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:45:41.906932000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:45:41.910438000 Z\n    zone: *1\n    time: 2024-02-02 14:45:41.910438000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_91049\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:45:41.906932000 Z\n  - *3\n"', '"---\n:correlation_id: e1a78f57-cc9e-4a8d-8024-d0c816d336f3\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:45:41.911528', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'bfc20d38-7c87-419a-aff5-6b79f6924081', '2024-02-02 14:45:41.912496') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "385a76d0-937f-4268-a41b-9723015e7099"], ["event_id", "bfc20d38-7c87-419a-aff5-6b79f6924081"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:46:05.696668"], ["updated_at", "2024-02-02 14:46:05.696668"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:46:05.699683"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:46:05.701750"], ["updated_at", "2024-02-02 14:46:05.701750"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:46:05.789870"], ["updated_at", "2024-02-02 14:46:05.789870"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('01b135be-33ac-43d5-803c-b24e1fea2eea', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:46:05.789870000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:46:05.789870000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:46:05.789870000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5b44f9a5-4f97-4f71-93dc-53ea22c2ac81\n"', 'EntityHistory::Events::Created', '2024-02-02 14:46:05.791635', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '01b135be-33ac-43d5-803c-b24e1fea2eea', '2024-02-02 14:46:05.795018') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:46:05.797818"], ["updated_at", "2024-02-02 14:46:05.797818"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ffbaf783-80b3-4d17-bd1c-36002c8396b6', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:46:05.797818000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:46:05.797818000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:46:05.797818000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 79e94859-6e04-4445-844b-029ce59f9919\n"', 'EntityHistory::Events::Created', '2024-02-02 14:46:05.799049', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ffbaf783-80b3-4d17-bd1c-36002c8396b6', '2024-02-02 14:46:05.800048') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_19116"], ["updated_at", "2024-02-02 14:46:05.800954"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('afd2d5eb-747e-43a8-939f-030668cf0d74', '"---\n:attributes:\n  id: 2\n  title: Good Job_19116\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:46:05.797818000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:46:05.797818000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:46:05.800954000 Z\n    zone: *1\n    time: 2024-02-02 14:46:05.800954000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_19116\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:46:05.797818000 Z\n  - *3\n"', '"---\n:correlation_id: 27632c10-38c9-4b8e-b8cd-7a8c86ceb37e\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:46:05.802165', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'afd2d5eb-747e-43a8-939f-030668cf0d74', '2024-02-02 14:46:05.803119') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ffbaf783-80b3-4d17-bd1c-36002c8396b6"], ["event_id", "afd2d5eb-747e-43a8-939f-030668cf0d74"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:46:05.812961"], ["updated_at", "2024-02-02 14:46:05.812961"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('584dcc43-5a07-411d-96c2-86eef943b845', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:46:05.812961000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:46:05.812961000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:46:05.812961000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b82dfdd2-787e-4105-9bd4-016e46cd9ef4\n"', 'EntityHistory::Events::Created', '2024-02-02 14:46:05.814295', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '584dcc43-5a07-411d-96c2-86eef943b845', '2024-02-02 14:46:05.815394') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_64706"], ["updated_at", "2024-02-02 14:46:05.816462"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c2c324f8-24b5-4c8e-b92a-a38c4b5860ef', '"---\n:attributes:\n  id: 3\n  title: Good Job_64706\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:46:05.812961000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:46:05.812961000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:46:05.816462000 Z\n    zone: *1\n    time: 2024-02-02 14:46:05.816462000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_64706\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:46:05.812961000 Z\n  - *3\n"', '"---\n:correlation_id: 5b98e497-4b0e-43ab-9ee8-c7a65c0cd694\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:46:05.817698', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c2c324f8-24b5-4c8e-b92a-a38c4b5860ef', '2024-02-02 14:46:05.818644') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "584dcc43-5a07-411d-96c2-86eef943b845"], ["event_id", "c2c324f8-24b5-4c8e-b92a-a38c4b5860ef"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (36.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:47:09.834297"], ["updated_at", "2024-02-02 14:47:09.834297"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:47:09.836450"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:47:09.838239"], ["updated_at", "2024-02-02 14:47:09.838239"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:47:09.915450"], ["updated_at", "2024-02-02 14:47:09.915450"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7af0a99c-d64b-4ebe-bd1b-4e8cfc367552', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:47:09.915450000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:47:09.915450000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:47:09.915450000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cbc0ff86-0b64-4611-a402-bfd40a4ebc27\n"', 'EntityHistory::Events::Created', '2024-02-02 14:47:09.917731', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '7af0a99c-d64b-4ebe-bd1b-4e8cfc367552', '2024-02-02 14:47:09.921739') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:47:09.925074"], ["updated_at", "2024-02-02 14:47:09.925074"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c2cb08b1-24e8-4f55-a6cc-e1bd72654f36', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:47:09.925074000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:47:09.925074000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:47:09.925074000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2c16116c-4a61-418b-ba6a-cfb9943a2c3e\n"', 'EntityHistory::Events::Created', '2024-02-02 14:47:09.926684', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'c2cb08b1-24e8-4f55-a6cc-e1bd72654f36', '2024-02-02 14:47:09.928024') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_55390"], ["updated_at", "2024-02-02 14:47:09.929176"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ed00c4ca-e2e2-445a-bc38-91f03945906b', '"---\n:attributes:\n  id: 2\n  title: Good Job_55390\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:47:09.925074000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:47:09.925074000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:47:09.929176000 Z\n    zone: *1\n    time: 2024-02-02 14:47:09.929176000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_55390\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:47:09.925074000 Z\n  - *3\n"', '"---\n:correlation_id: d07c2e45-5645-4020-a2c3-522ba07ef228\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:47:09.930769', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ed00c4ca-e2e2-445a-bc38-91f03945906b', '2024-02-02 14:47:09.931932') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c2cb08b1-24e8-4f55-a6cc-e1bd72654f36"], ["event_id", "ed00c4ca-e2e2-445a-bc38-91f03945906b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:47:09.942900"], ["updated_at", "2024-02-02 14:47:09.942900"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0ab0b999-7fbc-4d7f-a626-cbd734c06ca8', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:47:09.942900000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:47:09.942900000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:47:09.942900000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0ed55aa9-7803-473d-a045-6cbef6b0fead\n"', 'EntityHistory::Events::Created', '2024-02-02 14:47:09.944396', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '0ab0b999-7fbc-4d7f-a626-cbd734c06ca8', '2024-02-02 14:47:09.945561') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_24149"], ["updated_at", "2024-02-02 14:47:09.946939"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('503045e3-5bba-4a7b-abff-8e32301077bd', '"---\n:attributes:\n  id: 3\n  title: Good Job_24149\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:47:09.942900000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:47:09.942900000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:47:09.946939000 Z\n    zone: *1\n    time: 2024-02-02 14:47:09.946939000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_24149\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:47:09.942900000 Z\n  - *3\n"', '"---\n:correlation_id: b1b5d529-8db9-4f85-8619-4c070ff6c010\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:47:09.948153', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '503045e3-5bba-4a7b-abff-8e32301077bd', '2024-02-02 14:47:09.949159') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0ab0b999-7fbc-4d7f-a626-cbd734c06ca8"], ["event_id", "503045e3-5bba-4a7b-abff-8e32301077bd"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (58.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:53:43.924747"], ["updated_at", "2024-02-02 14:53:43.924747"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:53:43.927213"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:53:43.929133"], ["updated_at", "2024-02-02 14:53:43.929133"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:53:44.017177"], ["updated_at", "2024-02-02 14:53:44.017177"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7936e744-931d-4b61-9293-6d6ef75d77b6', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:53:44.017177000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:53:44.017177000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:53:44.017177000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ee6f80a5-ad70-445c-9b1e-4b6668ad3e10\n"', 'EntityHistory::Events::Created', '2024-02-02 14:53:44.018945', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '7936e744-931d-4b61-9293-6d6ef75d77b6', '2024-02-02 14:53:44.022532') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:53:44.025441"], ["updated_at", "2024-02-02 14:53:44.025441"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f05b064f-afc1-4cb9-8a8f-3530815417b4', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:53:44.025441000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:53:44.025441000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:53:44.025441000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 92e4326c-cba4-441b-8330-a589d483332f\n"', 'EntityHistory::Events::Created', '2024-02-02 14:53:44.026616', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f05b064f-afc1-4cb9-8a8f-3530815417b4', '2024-02-02 14:53:44.027757') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_28258"], ["updated_at", "2024-02-02 14:53:44.028741"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fffe02ef-58d4-4fe4-99f0-d0ccdddb8982', '"---\n:attributes:\n  id: 2\n  title: Good Job_28258\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:53:44.025441000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:53:44.025441000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:53:44.028741000 Z\n    zone: *1\n    time: 2024-02-02 14:53:44.028741000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_28258\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:53:44.025441000 Z\n  - *3\n"', '"---\n:correlation_id: f6a5369c-c16a-4136-9919-0390fbfd0121\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:53:44.029996', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fffe02ef-58d4-4fe4-99f0-d0ccdddb8982', '2024-02-02 14:53:44.031006') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f05b064f-afc1-4cb9-8a8f-3530815417b4"], ["event_id", "fffe02ef-58d4-4fe4-99f0-d0ccdddb8982"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:53:44.045377"], ["updated_at", "2024-02-02 14:53:44.045377"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1e26eb27-b620-48c5-bd56-4f1117380610', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:53:44.045377000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:53:44.045377000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:53:44.045377000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b6aebd57-b080-4577-ad6d-3e92283fc3c7\n"', 'EntityHistory::Events::Created', '2024-02-02 14:53:44.046504', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1e26eb27-b620-48c5-bd56-4f1117380610', '2024-02-02 14:53:44.047825') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_50186"], ["updated_at", "2024-02-02 14:53:44.048841"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c7dfc12d-2e63-493f-b23a-f3504ef714a4', '"---\n:attributes:\n  id: 3\n  title: Good Job_50186\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:53:44.045377000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:53:44.045377000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:53:44.048841000 Z\n    zone: *1\n    time: 2024-02-02 14:53:44.048841000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_50186\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:53:44.045377000 Z\n  - *3\n"', '"---\n:correlation_id: 21f4356e-b854-4607-9470-f287877b7788\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:53:44.050098', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c7dfc12d-2e63-493f-b23a-f3504ef714a4', '2024-02-02 14:53:44.051047') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "1e26eb27-b620-48c5-bd56-4f1117380610"], ["event_id", "c7dfc12d-2e63-493f-b23a-f3504ef714a4"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (53.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:58:46.090296"], ["updated_at", "2024-02-02 14:58:46.090296"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:58:46.092500"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:58:46.094226"], ["updated_at", "2024-02-02 14:58:46.094226"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:58:46.188517"], ["updated_at", "2024-02-02 14:58:46.188517"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b56e7b75-7a27-4744-a032-d9277b448974', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:58:46.188517000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:58:46.188517000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:58:46.188517000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9ced6177-ec70-40f2-8799-91a1f68b8b38\n"', 'EntityHistory::Events::Created', '2024-02-02 14:58:46.190291', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'b56e7b75-7a27-4744-a032-d9277b448974', '2024-02-02 14:58:46.193649') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:58:46.196345"], ["updated_at", "2024-02-02 14:58:46.196345"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9ebce867-4b88-4c19-b07f-66ecbdde6cb2', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:58:46.196345000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:58:46.196345000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:58:46.196345000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 50f8df03-6113-4a88-9f51-11a66d7bb158\n"', 'EntityHistory::Events::Created', '2024-02-02 14:58:46.197535', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '9ebce867-4b88-4c19-b07f-66ecbdde6cb2', '2024-02-02 14:58:46.198636') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_44689"], ["updated_at", "2024-02-02 14:58:46.199588"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('08c199de-f508-4a82-88e5-ac081363e34e', '"---\n:attributes:\n  id: 2\n  title: Good Job_44689\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:58:46.196345000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:58:46.196345000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:58:46.199588000 Z\n    zone: *1\n    time: 2024-02-02 14:58:46.199588000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_44689\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:58:46.196345000 Z\n  - *3\n"', '"---\n:correlation_id: bbd07e2b-e23b-46c9-9631-15984322a50e\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:58:46.200822', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '08c199de-f508-4a82-88e5-ac081363e34e', '2024-02-02 14:58:46.204657') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "9ebce867-4b88-4c19-b07f-66ecbdde6cb2"], ["event_id", "08c199de-f508-4a82-88e5-ac081363e34e"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:58:46.216588"], ["updated_at", "2024-02-02 14:58:46.216588"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ae596374-3212-446e-b3c8-bcc9dd8e5370', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:58:46.216588000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:58:46.216588000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:58:46.216588000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 27a29413-7410-4904-ae32-ce274950e280\n"', 'EntityHistory::Events::Created', '2024-02-02 14:58:46.218029', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'ae596374-3212-446e-b3c8-bcc9dd8e5370', '2024-02-02 14:58:46.219257') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_92357"], ["updated_at", "2024-02-02 14:58:46.220265"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4836da90-cdd2-4e8a-93c1-247595b37fa0', '"---\n:attributes:\n  id: 3\n  title: Good Job_92357\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:58:46.216588000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:58:46.216588000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:58:46.220265000 Z\n    zone: *1\n    time: 2024-02-02 14:58:46.220265000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_92357\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:58:46.216588000 Z\n  - *3\n"', '"---\n:correlation_id: 1a132817-e087-4ace-ae14-faadf78fe9fe\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:58:46.221282', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '4836da90-cdd2-4e8a-93c1-247595b37fa0', '2024-02-02 14:58:46.222183') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ae596374-3212-446e-b3c8-bcc9dd8e5370"], ["event_id", "4836da90-cdd2-4e8a-93c1-247595b37fa0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (50.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:59:00.802702"], ["updated_at", "2024-02-02 14:59:00.802702"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:59:00.804866"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:59:00.806561"], ["updated_at", "2024-02-02 14:59:00.806561"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:00.900132"], ["updated_at", "2024-02-02 14:59:00.900132"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('82406e1e-d445-4337-8e76-99309da2af10', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:00.900132000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:00.900132000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:00.900132000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9845f004-bfd3-4243-ba79-faa298cd277c\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:00.901857', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '82406e1e-d445-4337-8e76-99309da2af10', '2024-02-02 14:59:00.905486') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:00.908227"], ["updated_at", "2024-02-02 14:59:00.908227"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2bb0013d-57f5-459e-9859-f1308a194502', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:00.908227000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:00.908227000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:00.908227000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e3025328-342a-4985-9d17-b2a8a9385504\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:00.909446', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '2bb0013d-57f5-459e-9859-f1308a194502', '2024-02-02 14:59:00.910540') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_45792"], ["updated_at", "2024-02-02 14:59:00.911480"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f32ea117-0e0b-4216-9857-91435aad1785', '"---\n:attributes:\n  id: 2\n  title: Good Job_45792\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:00.908227000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:00.908227000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:00.911480000 Z\n    zone: *1\n    time: 2024-02-02 14:59:00.911480000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_45792\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:00.908227000 Z\n  - *3\n"', '"---\n:correlation_id: cff201dd-3156-4c4d-92cd-e843b7d4fe56\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:00.912765', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f32ea117-0e0b-4216-9857-91435aad1785', '2024-02-02 14:59:00.913791') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2bb0013d-57f5-459e-9859-f1308a194502"], ["event_id", "f32ea117-0e0b-4216-9857-91435aad1785"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:00.927650"], ["updated_at", "2024-02-02 14:59:00.927650"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5c39d5c1-ecd2-45fc-a713-a48451056cbb', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:00.927650000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:00.927650000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:00.927650000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 453de018-d2ab-4f4c-aa70-a5eab72990c6\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:00.928892', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5c39d5c1-ecd2-45fc-a713-a48451056cbb', '2024-02-02 14:59:00.929844') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_92763"], ["updated_at", "2024-02-02 14:59:00.930799"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1383b8ea-091e-489a-858d-19780dc4aa6c', '"---\n:attributes:\n  id: 3\n  title: Good Job_92763\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:00.927650000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:00.927650000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:00.930799000 Z\n    zone: *1\n    time: 2024-02-02 14:59:00.930799000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_92763\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:00.927650000 Z\n  - *3\n"', '"---\n:correlation_id: c41c6a58-dec0-40f6-a3ec-fcde549eb581\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:00.931889', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1383b8ea-091e-489a-858d-19780dc4aa6c', '2024-02-02 14:59:00.932840') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5c39d5c1-ecd2-45fc-a713-a48451056cbb"], ["event_id", "1383b8ea-091e-489a-858d-19780dc4aa6c"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (59.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:59:06.471171"], ["updated_at", "2024-02-02 14:59:06.471171"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:59:06.473777"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:59:06.475769"], ["updated_at", "2024-02-02 14:59:06.475769"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.5ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:06.575725"], ["updated_at", "2024-02-02 14:59:06.575725"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1f698fb2-d71b-43d8-941d-40e9c870d531', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:06.575725000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:06.575725000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:06.575725000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bdf96d75-3363-4471-8807-d0c75ee86cce\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:06.577670', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '1f698fb2-d71b-43d8-941d-40e9c870d531', '2024-02-02 14:59:06.581212') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:06.584197"], ["updated_at", "2024-02-02 14:59:06.584197"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dab3d517-be8e-4cb4-8808-b0c087b38bee', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:06.584197000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:06.584197000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:06.584197000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c0c500f8-4dbb-4d7e-99f1-aa75cc21f40e\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:06.585532', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'dab3d517-be8e-4cb4-8808-b0c087b38bee', '2024-02-02 14:59:06.586782') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_67639"], ["updated_at", "2024-02-02 14:59:06.588007"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8832b25e-a099-4754-88ae-44a0b175fc17', '"---\n:attributes:\n  id: 2\n  title: Good Job_67639\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:06.584197000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:06.584197000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:06.588007000 Z\n    zone: *1\n    time: 2024-02-02 14:59:06.588007000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_67639\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:06.584197000 Z\n  - *3\n"', '"---\n:correlation_id: 7d2e7925-39fa-434f-a810-c19668f01f36\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:06.589351', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '8832b25e-a099-4754-88ae-44a0b175fc17', '2024-02-02 14:59:06.590446') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.4ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "dab3d517-be8e-4cb4-8808-b0c087b38bee"], ["event_id", "8832b25e-a099-4754-88ae-44a0b175fc17"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.3ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:06.604255"], ["updated_at", "2024-02-02 14:59:06.604255"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6ea08f00-133e-427c-beed-b63edc9e506d', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:06.604255000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:06.604255000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:06.604255000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a9af9e2e-89c3-4b00-b4db-2f166217ebbb\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:06.605789', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '6ea08f00-133e-427c-beed-b63edc9e506d', '2024-02-02 14:59:06.606977') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_1407"], ["updated_at", "2024-02-02 14:59:06.608081"], ["id", 3]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a0e65da8-fd35-4739-80ba-7af3997b635f', '"---\n:attributes:\n  id: 3\n  title: Good Job_1407\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:06.604255000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:06.604255000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:06.608081000 Z\n    zone: *1\n    time: 2024-02-02 14:59:06.608081000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_1407\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:06.604255000 Z\n  - *3\n"', '"---\n:correlation_id: 0a3215de-3244-49d9-86f0-a45b46c85dd1\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:06.609439', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'a0e65da8-fd35-4739-80ba-7af3997b635f', '2024-02-02 14:59:06.610492') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.2ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6ea08f00-133e-427c-beed-b63edc9e506d"], ["event_id", "a0e65da8-fd35-4739-80ba-7af3997b635f"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.6ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 14:59:31.744950"], ["updated_at", "2024-02-02 14:59:31.744950"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 14:59:31.747184"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 14:59:31.748947"], ["updated_at", "2024-02-02 14:59:31.748947"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:31.844881"], ["updated_at", "2024-02-02 14:59:31.844881"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('452059b3-b60f-45f5-897f-5aefbd26d8d1', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:31.844881000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:31.844881000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:31.844881000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3a256604-8dee-4ad8-b63c-1d4f5d04fccd\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:31.846584', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '452059b3-b60f-45f5-897f-5aefbd26d8d1', '2024-02-02 14:59:31.849968') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:31.852674"], ["updated_at", "2024-02-02 14:59:31.852674"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3d9bf24e-a3c3-4a78-864b-93bbbd1b12e8', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:31.852674000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:31.852674000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:31.852674000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fe3e1f8b-f2d4-4e87-9157-988ca4839b78\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:31.853855', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '3d9bf24e-a3c3-4a78-864b-93bbbd1b12e8', '2024-02-02 14:59:31.854934') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_38171"], ["updated_at", "2024-02-02 14:59:31.855862"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('94b5879f-92d4-4b4d-97de-aa08bf1508c6', '"---\n:attributes:\n  id: 2\n  title: Good Job_38171\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:31.852674000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:31.852674000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:31.855862000 Z\n    zone: *1\n    time: 2024-02-02 14:59:31.855862000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_38171\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:31.852674000 Z\n  - *3\n"', '"---\n:correlation_id: 65712ea0-0995-4416-8468-bbc102715cd2\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:31.860012', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '94b5879f-92d4-4b4d-97de-aa08bf1508c6', '2024-02-02 14:59:31.861297') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "3d9bf24e-a3c3-4a78-864b-93bbbd1b12e8"], ["event_id", "94b5879f-92d4-4b4d-97de-aa08bf1508c6"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 14:59:31.871576"], ["updated_at", "2024-02-02 14:59:31.871576"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6ce6e544-46d0-48d2-b91c-fb8a3f435ddf', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 14:59:31.871576000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:31.871576000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 14:59:31.871576000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e5613a19-4bc1-4ff6-ab34-fb25081ed7a6\n"', 'EntityHistory::Events::Created', '2024-02-02 14:59:31.872730', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '6ce6e544-46d0-48d2-b91c-fb8a3f435ddf', '2024-02-02 14:59:31.873698') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_11855"], ["updated_at", "2024-02-02 14:59:31.874536"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c3367f42-3376-4b19-8e4f-5fc48d48dfa1', '"---\n:attributes:\n  id: 3\n  title: Good Job_11855\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 14:59:31.871576000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 14:59:31.871576000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 14:59:31.874536000 Z\n    zone: *1\n    time: 2024-02-02 14:59:31.874536000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_11855\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 14:59:31.871576000 Z\n  - *3\n"', '"---\n:correlation_id: 57ee4fef-78b7-4d36-8077-68006deb858a\n"', 'EntityHistory::Events::Updated', '2024-02-02 14:59:31.875584', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c3367f42-3376-4b19-8e4f-5fc48d48dfa1', '2024-02-02 14:59:31.876514') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6ce6e544-46d0-48d2-b91c-fb8a3f435ddf"], ["event_id", "c3367f42-3376-4b19-8e4f-5fc48d48dfa1"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:00:07.346173"], ["updated_at", "2024-02-02 15:00:07.346173"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:00:07.348266"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:00:07.349885"], ["updated_at", "2024-02-02 15:00:07.349885"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:07.432344"], ["updated_at", "2024-02-02 15:00:07.432344"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bb92594a-6e36-4068-bdcf-bf4b97f1a8fb', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:07.432344000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:07.432344000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:07.432344000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a5d075eb-6f3f-4b5a-8374-5e73091539a4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:07.434699', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'bb92594a-6e36-4068-bdcf-bf4b97f1a8fb', '2024-02-02 15:00:07.438330') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:07.441331"], ["updated_at", "2024-02-02 15:00:07.441331"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7b39ca36-e4f1-468b-8b2d-dcde572ddb48', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:07.441331000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:07.441331000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:07.441331000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: dedc2e56-f9c3-4843-8fd5-b0f2f56b7b01\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:07.442626', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7b39ca36-e4f1-468b-8b2d-dcde572ddb48', '2024-02-02 15:00:07.443782') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_69427"], ["updated_at", "2024-02-02 15:00:07.444765"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9291f8c7-d8a7-4cde-8c50-5af85c0cd8e3', '"---\n:attributes:\n  id: 2\n  title: Good Job_69427\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:07.441331000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:07.441331000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:07.444765000 Z\n    zone: *1\n    time: 2024-02-02 15:00:07.444765000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_69427\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:07.441331000 Z\n  - *3\n"', '"---\n:correlation_id: 9ccf6a9d-58e1-475b-91f9-b4fb9782ce1a\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:07.446029', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '9291f8c7-d8a7-4cde-8c50-5af85c0cd8e3', '2024-02-02 15:00:07.447044') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "7b39ca36-e4f1-468b-8b2d-dcde572ddb48"], ["event_id", "9291f8c7-d8a7-4cde-8c50-5af85c0cd8e3"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:07.459302"], ["updated_at", "2024-02-02 15:00:07.459302"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1463b49c-592a-43d1-87f3-2d6be7028faa', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:07.459302000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:07.459302000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:07.459302000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 060bec32-8727-440d-ae7f-6792603b39d4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:07.460467', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1463b49c-592a-43d1-87f3-2d6be7028faa', '2024-02-02 15:00:07.461643') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_51271"], ["updated_at", "2024-02-02 15:00:07.462531"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('40670bea-3c04-462e-8d86-55e9e5d97b89', '"---\n:attributes:\n  id: 3\n  title: Good Job_51271\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:07.459302000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:07.459302000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:07.462531000 Z\n    zone: *1\n    time: 2024-02-02 15:00:07.462531000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_51271\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:07.459302000 Z\n  - *3\n"', '"---\n:correlation_id: 36e22a2c-7cf1-4b98-97fb-8b31cc5f21e5\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:07.463728', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '40670bea-3c04-462e-8d86-55e9e5d97b89', '2024-02-02 15:00:07.464628') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "1463b49c-592a-43d1-87f3-2d6be7028faa"], ["event_id", "40670bea-3c04-462e-8d86-55e9e5d97b89"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:00:25.471932"], ["updated_at", "2024-02-02 15:00:25.471932"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:00:25.474234"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:00:25.475987"], ["updated_at", "2024-02-02 15:00:25.475987"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:25.559189"], ["updated_at", "2024-02-02 15:00:25.559189"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dab67967-aafc-4ce7-8d64-935339239ad6', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:25.559189000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:25.559189000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:25.559189000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8461fe03-f277-4f16-add4-6a1a218dc1af\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:25.561116', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'dab67967-aafc-4ce7-8d64-935339239ad6', '2024-02-02 15:00:25.565062') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:25.568165"], ["updated_at", "2024-02-02 15:00:25.568165"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9a7ab28c-dd47-4972-92da-a984aaa20ff7', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:25.568165000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:25.568165000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:25.568165000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 86abebb6-ee0c-4522-87c3-90d48e276759\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:25.569503', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '9a7ab28c-dd47-4972-92da-a984aaa20ff7', '2024-02-02 15:00:25.570724') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_17151"], ["updated_at", "2024-02-02 15:00:25.571778"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('aeeaf9d2-8a61-4aad-802f-867ac255c626', '"---\n:attributes:\n  id: 2\n  title: Good Job_17151\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:25.568165000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:25.568165000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:25.571778000 Z\n    zone: *1\n    time: 2024-02-02 15:00:25.571778000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_17151\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:25.568165000 Z\n  - *3\n"', '"---\n:correlation_id: c8c971c9-ebb1-4f84-a216-8e8dcd05456e\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:25.573099', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'aeeaf9d2-8a61-4aad-802f-867ac255c626', '2024-02-02 15:00:25.574146') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "9a7ab28c-dd47-4972-92da-a984aaa20ff7"], ["event_id", "aeeaf9d2-8a61-4aad-802f-867ac255c626"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:25.587400"], ["updated_at", "2024-02-02 15:00:25.587400"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6a005fd3-b50f-4c41-afac-900252eb2d4b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:25.587400000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:25.587400000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:25.587400000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 12f233db-75bb-4513-875e-59c1226ba0fe\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:25.588674', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '6a005fd3-b50f-4c41-afac-900252eb2d4b', '2024-02-02 15:00:25.589875') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_50503"], ["updated_at", "2024-02-02 15:00:25.590783"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d43a3711-0736-4147-9529-9dd828363da0', '"---\n:attributes:\n  id: 3\n  title: Good Job_50503\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:25.587400000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:25.587400000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:25.590783000 Z\n    zone: *1\n    time: 2024-02-02 15:00:25.590783000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_50503\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:25.587400000 Z\n  - *3\n"', '"---\n:correlation_id: d9040c58-b97e-46f8-b9cc-8cac1b05c064\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:25.591998', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd43a3711-0736-4147-9529-9dd828363da0', '2024-02-02 15:00:25.592888') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6a005fd3-b50f-4c41-afac-900252eb2d4b"], ["event_id", "d43a3711-0736-4147-9529-9dd828363da0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:00:59.311449"], ["updated_at", "2024-02-02 15:00:59.311449"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:00:59.313550"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:00:59.315090"], ["updated_at", "2024-02-02 15:00:59.315090"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:59.397017"], ["updated_at", "2024-02-02 15:00:59.397017"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6d84800c-0ed1-4c2a-b751-7e7d45ba52c9', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:59.397017000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:59.397017000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:59.397017000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: dec1508e-3c97-4dbf-a223-489caf8a44b1\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:59.398732', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '6d84800c-0ed1-4c2a-b751-7e7d45ba52c9', '2024-02-02 15:00:59.402201') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:59.405152"], ["updated_at", "2024-02-02 15:00:59.405152"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c5b247d5-746c-406e-ac75-e482c34220f3', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:59.405152000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:59.405152000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:59.405152000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2b311a50-e3a3-43bd-849d-d21ae996ea62\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:59.406452', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'c5b247d5-746c-406e-ac75-e482c34220f3', '2024-02-02 15:00:59.407556') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_35132"], ["updated_at", "2024-02-02 15:00:59.408508"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('76648281-1ba5-4a42-9175-73efe3cc21d2', '"---\n:attributes:\n  id: 2\n  title: Good Job_35132\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:59.405152000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:59.405152000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:59.408508000 Z\n    zone: *1\n    time: 2024-02-02 15:00:59.408508000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_35132\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:59.405152000 Z\n  - *3\n"', '"---\n:correlation_id: cd2153f3-449f-4673-9ed1-e79713a6ce98\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:59.409791', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '76648281-1ba5-4a42-9175-73efe3cc21d2', '2024-02-02 15:00:59.410847') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c5b247d5-746c-406e-ac75-e482c34220f3"], ["event_id", "76648281-1ba5-4a42-9175-73efe3cc21d2"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:00:59.423308"], ["updated_at", "2024-02-02 15:00:59.423308"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2ced1868-c620-427f-9514-6a1ae636a809', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:00:59.423308000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:59.423308000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:00:59.423308000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 554df5ea-7dc5-43b6-9e4d-563638528c16\n"', 'EntityHistory::Events::Created', '2024-02-02 15:00:59.424565', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '2ced1868-c620-427f-9514-6a1ae636a809', '2024-02-02 15:00:59.425675') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_30568"], ["updated_at", "2024-02-02 15:00:59.426567"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('962fd738-0f76-4611-904a-f4809309116a', '"---\n:attributes:\n  id: 3\n  title: Good Job_30568\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:00:59.423308000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:00:59.423308000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:00:59.426567000 Z\n    zone: *1\n    time: 2024-02-02 15:00:59.426567000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_30568\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:00:59.423308000 Z\n  - *3\n"', '"---\n:correlation_id: fc292a3b-4e4e-4de6-8804-6b984979746f\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:00:59.427578', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '962fd738-0f76-4611-904a-f4809309116a', '2024-02-02 15:00:59.428585') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2ced1868-c620-427f-9514-6a1ae636a809"], ["event_id", "962fd738-0f76-4611-904a-f4809309116a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:01:09.361599"], ["updated_at", "2024-02-02 15:01:09.361599"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:01:09.363694"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:01:09.365471"], ["updated_at", "2024-02-02 15:01:09.365471"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:01:09.458955"], ["updated_at", "2024-02-02 15:01:09.458955"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('33b1f019-6b79-40d0-b9d5-3628e0b8cc58', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:01:09.458955000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:01:09.458955000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:01:09.458955000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 478350b6-7423-4b4f-ae03-933f16f63028\n"', 'EntityHistory::Events::Created', '2024-02-02 15:01:09.460684', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '33b1f019-6b79-40d0-b9d5-3628e0b8cc58', '2024-02-02 15:01:09.464321') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:01:09.467165"], ["updated_at", "2024-02-02 15:01:09.467165"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5c158042-59cb-45c7-acfb-4a39daae7d61', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:01:09.467165000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:01:09.467165000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:01:09.467165000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6337372f-a319-4a4b-acb5-8ca1c94dfeff\n"', 'EntityHistory::Events::Created', '2024-02-02 15:01:09.468392', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '5c158042-59cb-45c7-acfb-4a39daae7d61', '2024-02-02 15:01:09.469463') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_5300"], ["updated_at", "2024-02-02 15:01:09.470401"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('67780baa-2117-4bb8-95c1-3cb3e24413a8', '"---\n:attributes:\n  id: 2\n  title: Good Job_5300\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:01:09.467165000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:01:09.467165000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:01:09.470401000 Z\n    zone: *1\n    time: 2024-02-02 15:01:09.470401000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_5300\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:01:09.467165000 Z\n  - *3\n"', '"---\n:correlation_id: 6a7e86ba-cc62-43f2-97c6-281fdf0ca9fc\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:01:09.474595', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '67780baa-2117-4bb8-95c1-3cb3e24413a8', '2024-02-02 15:01:09.475574') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5c158042-59cb-45c7-acfb-4a39daae7d61"], ["event_id", "67780baa-2117-4bb8-95c1-3cb3e24413a8"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:01:09.485970"], ["updated_at", "2024-02-02 15:01:09.485970"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('564ce1c2-9a9d-45d2-804b-731a999894a6', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:01:09.485970000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:01:09.485970000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:01:09.485970000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5a8f196b-2506-4bec-869c-cb0f78f6690d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:01:09.487114', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '564ce1c2-9a9d-45d2-804b-731a999894a6', '2024-02-02 15:01:09.488088') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_59943"], ["updated_at", "2024-02-02 15:01:09.488955"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0f66e60f-be18-4332-9019-a7e6e7cd9338', '"---\n:attributes:\n  id: 3\n  title: Good Job_59943\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:01:09.485970000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:01:09.485970000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:01:09.488955000 Z\n    zone: *1\n    time: 2024-02-02 15:01:09.488955000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_59943\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:01:09.485970000 Z\n  - *3\n"', '"---\n:correlation_id: 2ae0a615-a825-4a75-926e-9745ae02c017\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:01:09.490003', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '0f66e60f-be18-4332-9019-a7e6e7cd9338', '2024-02-02 15:01:09.490909') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "564ce1c2-9a9d-45d2-804b-731a999894a6"], ["event_id", "0f66e60f-be18-4332-9019-a7e6e7cd9338"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (51.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:05:08.967509"], ["updated_at", "2024-02-02 15:05:08.967509"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:05:08.969775"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:05:08.971538"], ["updated_at", "2024-02-02 15:05:08.971538"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (15.6ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:09.075832"], ["updated_at", "2024-02-02 15:05:09.075832"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1d3460d7-f53d-41fe-97fa-379c4740c88c', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:09.075832000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.075832000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:09.075832000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: aa27b672-60b3-431b-aeb2-ecffb6b941ae\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:09.077988', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '1d3460d7-f53d-41fe-97fa-379c4740c88c', '2024-02-02 15:05:09.081964') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:09.088249"], ["updated_at", "2024-02-02 15:05:09.088249"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('629efbb1-0328-4666-b2bb-6f7f9584bf72', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:09.088249000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.088249000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:09.088249000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 87a9e557-ee12-4286-9faa-abc62a5e6f0d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:09.089561', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '629efbb1-0328-4666-b2bb-6f7f9584bf72', '2024-02-02 15:05:09.090715') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:09.092100"], ["updated_at", "2024-02-02 15:05:09.092100"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6a613d29-670d-49c8-a475-98828442c349', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:09.092100000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.092100000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:09.092100000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 736fe343-63e9-47c6-84c9-7c14e76d621f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:09.093335', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '6a613d29-670d-49c8-a475-98828442c349', '2024-02-02 15:05:09.094511') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_17507"], ["updated_at", "2024-02-02 15:05:09.095512"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f7dead3c-b036-476b-8729-5f45686863e9', '"---\n:attributes:\n  id: 3\n  title: Good Job_17507\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:05:09.092100000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.092100000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:05:09.095512000 Z\n    zone: *1\n    time: 2024-02-02 15:05:09.095512000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_17507\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:05:09.092100000 Z\n  - *3\n"', '"---\n:correlation_id: d80a4063-9cbf-470a-9a79-e4a6a1adb305\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:05:09.096784', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f7dead3c-b036-476b-8729-5f45686863e9', '2024-02-02 15:05:09.100841') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.4ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6a613d29-670d-49c8-a475-98828442c349"], ["event_id", "f7dead3c-b036-476b-8729-5f45686863e9"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.3ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:09.111483"], ["updated_at", "2024-02-02 15:05:09.111483"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('29f40373-bcbf-4d77-ae7b-b0fcd1cabad9', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:09.111483000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.111483000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:09.111483000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6c65d442-962f-4000-bcfe-b02eae15b5d1\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:09.112986', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '29f40373-bcbf-4d77-ae7b-b0fcd1cabad9', '2024-02-02 15:05:09.114149') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_98435"], ["updated_at", "2024-02-02 15:05:09.115218"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b9d4dfff-78b7-4af8-9200-cc7a4516748a', '"---\n:attributes:\n  id: 4\n  title: Good Job_98435\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:05:09.111483000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:09.111483000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:05:09.115218000 Z\n    zone: *1\n    time: 2024-02-02 15:05:09.115218000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_98435\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:05:09.111483000 Z\n  - *3\n"', '"---\n:correlation_id: 127c64ce-fef9-4ee6-aea6-6303e5bf5bbb\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:05:09.116480', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b9d4dfff-78b7-4af8-9200-cc7a4516748a', '2024-02-02 15:05:09.117501') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.2ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "29f40373-bcbf-4d77-ae7b-b0fcd1cabad9"], ["event_id", "b9d4dfff-78b7-4af8-9200-cc7a4516748a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:05:26.308125"], ["updated_at", "2024-02-02 15:05:26.308125"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:05:26.310279"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:05:26.311995"], ["updated_at", "2024-02-02 15:05:26.311995"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:26.397330"], ["updated_at", "2024-02-02 15:05:26.397330"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2a912397-9e6e-40d6-b62a-d348173d1be4', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:26.397330000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:26.397330000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:26.397330000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4eab8340-c48c-4bfa-9064-90c32c1cce23\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:26.399229', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '2a912397-9e6e-40d6-b62a-d348173d1be4', '2024-02-02 15:05:26.402895') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:26.405910"], ["updated_at", "2024-02-02 15:05:26.405910"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('faa7ac87-9f7e-4c85-8a1f-a0a0b1e2eb45', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:26.405910000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:26.405910000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:26.405910000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''039ea652-d007-4880-8852-895632c97c00''\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:26.407186', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'faa7ac87-9f7e-4c85-8a1f-a0a0b1e2eb45', '2024-02-02 15:05:26.408320') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_61763"], ["updated_at", "2024-02-02 15:05:26.409312"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7fa0e575-856e-4a8b-95aa-8f77723c207b', '"---\n:attributes:\n  id: 2\n  title: Good Job_61763\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:05:26.405910000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:26.405910000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:05:26.409312000 Z\n    zone: *1\n    time: 2024-02-02 15:05:26.409312000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_61763\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:05:26.405910000 Z\n  - *3\n"', '"---\n:correlation_id: 1e632674-dbc6-4893-9529-f431658a6139\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:05:26.410645', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7fa0e575-856e-4a8b-95aa-8f77723c207b', '2024-02-02 15:05:26.411661') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "faa7ac87-9f7e-4c85-8a1f-a0a0b1e2eb45"], ["event_id", "7fa0e575-856e-4a8b-95aa-8f77723c207b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:05:26.424303"], ["updated_at", "2024-02-02 15:05:26.424303"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8e6d6c65-6df3-4f23-b0a0-4988f59217fe', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:05:26.424303000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:26.424303000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:05:26.424303000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d1421c71-e303-4632-ae0d-890db61f6fee\n"', 'EntityHistory::Events::Created', '2024-02-02 15:05:26.425653', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '8e6d6c65-6df3-4f23-b0a0-4988f59217fe', '2024-02-02 15:05:26.426632') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_19672"], ["updated_at", "2024-02-02 15:05:26.427613"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('153bcdb6-3f2e-42c9-8b1a-d4eeaa23712b', '"---\n:attributes:\n  id: 3\n  title: Good Job_19672\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:05:26.424303000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:05:26.424303000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:05:26.427613000 Z\n    zone: *1\n    time: 2024-02-02 15:05:26.427613000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_19672\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:05:26.424303000 Z\n  - *3\n"', '"---\n:correlation_id: 229f1ded-11ee-47d3-ad28-d92435ec5161\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:05:26.428900', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '153bcdb6-3f2e-42c9-8b1a-d4eeaa23712b', '2024-02-02 15:05:26.429886') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "8e6d6c65-6df3-4f23-b0a0-4988f59217fe"], ["event_id", "153bcdb6-3f2e-42c9-8b1a-d4eeaa23712b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (54.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:09:22.770364"], ["updated_at", "2024-02-02 15:09:22.770364"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:09:22.772573"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:09:22.774327"], ["updated_at", "2024-02-02 15:09:22.774327"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:22.861458"], ["updated_at", "2024-02-02 15:09:22.861458"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3b6cb1a6-e860-4016-ab12-ea9e3d14029b', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:22.861458000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.861458000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:22.861458000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 626575d4-2ab6-4bc2-930f-34da82611e44\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:22.863210', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '3b6cb1a6-e860-4016-ab12-ea9e3d14029b', '2024-02-02 15:09:22.866965') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:22.873308"], ["updated_at", "2024-02-02 15:09:22.873308"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5fdccc60-dbe7-4722-a68d-e90a4f51da65', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:22.873308000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.873308000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:22.873308000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 82dae9c0-406a-4dd5-9c77-7447d807a754\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:22.874521', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '5fdccc60-dbe7-4722-a68d-e90a4f51da65', '2024-02-02 15:09:22.875565') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:22.876638"], ["updated_at", "2024-02-02 15:09:22.876638"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fff92a16-caa2-4596-a066-6491b179250e', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:22.876638000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.876638000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:22.876638000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1b097aa0-e5e4-4048-bf4e-6d3f3988fc9a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:22.877793', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'fff92a16-caa2-4596-a066-6491b179250e', '2024-02-02 15:09:22.878837') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_19474"], ["updated_at", "2024-02-02 15:09:22.879734"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fb127e56-7a9a-40e4-8850-5c6550d5f473', '"---\n:attributes:\n  id: 3\n  title: Good Job_19474\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:22.876638000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.876638000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:22.879734000 Z\n    zone: *1\n    time: 2024-02-02 15:09:22.879734000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_19474\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:22.876638000 Z\n  - *3\n"', '"---\n:correlation_id: 54b4ab79-f90a-470a-a01d-75993198a7e7\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:22.880925', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'fb127e56-7a9a-40e4-8850-5c6550d5f473', '2024-02-02 15:09:22.884769') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "fff92a16-caa2-4596-a066-6491b179250e"], ["event_id", "fb127e56-7a9a-40e4-8850-5c6550d5f473"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:22.895815"], ["updated_at", "2024-02-02 15:09:22.895815"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8557e360-7296-4889-a29a-cc7accf57a65', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:22.895815000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.895815000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:22.895815000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8ae8d35d-1b94-4894-986d-a9da0c43782f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:22.897195', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '8557e360-7296-4889-a29a-cc7accf57a65', '2024-02-02 15:09:22.898220') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_67910"], ["updated_at", "2024-02-02 15:09:22.899040"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('274cb625-5f72-4fd8-a6cc-17177d651751', '"---\n:attributes:\n  id: 4\n  title: Good Job_67910\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:22.895815000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:22.895815000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:22.899040000 Z\n    zone: *1\n    time: 2024-02-02 15:09:22.899040000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_67910\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:22.895815000 Z\n  - *3\n"', '"---\n:correlation_id: b5d301c7-7ad7-439b-bad2-51c73078b068\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:22.900080', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '274cb625-5f72-4fd8-a6cc-17177d651751', '2024-02-02 15:09:22.900971') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "8557e360-7296-4889-a29a-cc7accf57a65"], ["event_id", "274cb625-5f72-4fd8-a6cc-17177d651751"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:09:40.476631"], ["updated_at", "2024-02-02 15:09:40.476631"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:09:40.478655"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:09:40.480315"], ["updated_at", "2024-02-02 15:09:40.480315"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:40.563460"], ["updated_at", "2024-02-02 15:09:40.563460"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('80c3adbd-a6a2-4bee-a48a-f6ef30908546', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:40.563460000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.563460000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:40.563460000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 30365073-8136-424e-bb06-183ec50dfa4a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:40.565317', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '80c3adbd-a6a2-4bee-a48a-f6ef30908546', '2024-02-02 15:09:40.569052') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:40.574986"], ["updated_at", "2024-02-02 15:09:40.574986"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eef1cd7d-26c0-4ed0-ab97-3a411eb44518', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:40.574986000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.574986000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:40.574986000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 664cb7cd-108e-4a6c-992c-4d12bea7b3b3\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:40.576261', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'eef1cd7d-26c0-4ed0-ab97-3a411eb44518', '2024-02-02 15:09:40.577341') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:40.578718"], ["updated_at", "2024-02-02 15:09:40.578718"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5c90271b-9f80-450f-94f3-9c2dd12cff51', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:40.578718000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.578718000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:40.578718000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 07a2d5b9-be78-41b6-a369-8974fc2f8d1c\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:40.579916', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5c90271b-9f80-450f-94f3-9c2dd12cff51', '2024-02-02 15:09:40.580983') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_99570"], ["updated_at", "2024-02-02 15:09:40.581914"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('04f46604-1615-479b-80ca-ff941fe1d608', '"---\n:attributes:\n  id: 3\n  title: Good Job_99570\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:40.578718000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.578718000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:40.581914000 Z\n    zone: *1\n    time: 2024-02-02 15:09:40.581914000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_99570\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:40.578718000 Z\n  - *3\n"', '"---\n:correlation_id: 913037e7-ea34-40e1-a32a-09c28718f306\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:40.583149', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '04f46604-1615-479b-80ca-ff941fe1d608', '2024-02-02 15:09:40.586830') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5c90271b-9f80-450f-94f3-9c2dd12cff51"], ["event_id", "04f46604-1615-479b-80ca-ff941fe1d608"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:40.596685"], ["updated_at", "2024-02-02 15:09:40.596685"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2a2da0c7-34ab-43a4-801b-04c636b301a7', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:40.596685000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.596685000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:40.596685000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 56f27053-7681-40e3-8322-b77ff88c6525\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:40.598033', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '2a2da0c7-34ab-43a4-801b-04c636b301a7', '2024-02-02 15:09:40.599037') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_68332"], ["updated_at", "2024-02-02 15:09:40.599887"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('88aed96d-c650-4afa-9d10-dbf267fc33f8', '"---\n:attributes:\n  id: 4\n  title: Good Job_68332\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:40.596685000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:40.596685000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:40.599887000 Z\n    zone: *1\n    time: 2024-02-02 15:09:40.599887000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_68332\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:40.596685000 Z\n  - *3\n"', '"---\n:correlation_id: 7ce790f6-5fc7-4b38-a977-3492ca91d2b5\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:40.600911', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '88aed96d-c650-4afa-9d10-dbf267fc33f8', '2024-02-02 15:09:40.601773') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2a2da0c7-34ab-43a4-801b-04c636b301a7"], ["event_id", "88aed96d-c650-4afa-9d10-dbf267fc33f8"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:09:59.684673"], ["updated_at", "2024-02-02 15:09:59.684673"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:09:59.686966"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:09:59.688737"], ["updated_at", "2024-02-02 15:09:59.688737"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:59.772149"], ["updated_at", "2024-02-02 15:09:59.772149"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f0bb52b5-1761-41ae-a552-af846356e703', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:59.772149000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:59.772149000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:59.772149000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 938eb3bc-3369-48fb-90ed-80425edbd6f5\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:59.773905', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'f0bb52b5-1761-41ae-a552-af846356e703', '2024-02-02 15:09:59.777574') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:59.780559"], ["updated_at", "2024-02-02 15:09:59.780559"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c4653ab4-f1dd-4650-874d-b1e1db4881e9', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:59.780559000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:59.780559000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:59.780559000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d866c061-32f3-4194-b3ac-248181269a8d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:59.781845', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'c4653ab4-f1dd-4650-874d-b1e1db4881e9', '2024-02-02 15:09:59.782964') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_26627"], ["updated_at", "2024-02-02 15:09:59.783917"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3d5a056a-3f54-4f3f-ade7-6651bc08e614', '"---\n:attributes:\n  id: 2\n  title: Good Job_26627\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:59.780559000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:59.780559000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:59.783917000 Z\n    zone: *1\n    time: 2024-02-02 15:09:59.783917000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_26627\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:59.780559000 Z\n  - *3\n"', '"---\n:correlation_id: 1ca948fe-dd9b-4194-aae2-afedb65c99f3\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:59.785157', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '3d5a056a-3f54-4f3f-ade7-6651bc08e614', '2024-02-02 15:09:59.786167') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c4653ab4-f1dd-4650-874d-b1e1db4881e9"], ["event_id", "3d5a056a-3f54-4f3f-ade7-6651bc08e614"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:09:59.798505"], ["updated_at", "2024-02-02 15:09:59.798505"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e787ec14-a442-49aa-94f3-90a76e96a59a', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:09:59.798505000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:59.798505000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:09:59.798505000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3de62b49-1fda-481d-984c-aec5778df158\n"', 'EntityHistory::Events::Created', '2024-02-02 15:09:59.800082', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'e787ec14-a442-49aa-94f3-90a76e96a59a', '2024-02-02 15:09:59.801103') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_47758"], ["updated_at", "2024-02-02 15:09:59.801969"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d6f50a87-8530-4d6c-a705-4b0d24d78c98', '"---\n:attributes:\n  id: 3\n  title: Good Job_47758\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:09:59.798505000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:09:59.798505000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:09:59.801969000 Z\n    zone: *1\n    time: 2024-02-02 15:09:59.801969000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_47758\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:09:59.798505000 Z\n  - *3\n"', '"---\n:correlation_id: f8ccbeaf-bc3a-48bc-be38-8b03f1193702\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:09:59.803124', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd6f50a87-8530-4d6c-a705-4b0d24d78c98', '2024-02-02 15:09:59.804059') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e787ec14-a442-49aa-94f3-90a76e96a59a"], ["event_id", "d6f50a87-8530-4d6c-a705-4b0d24d78c98"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:10:13.767480"], ["updated_at", "2024-02-02 15:10:13.767480"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:10:13.769728"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:10:13.771328"], ["updated_at", "2024-02-02 15:10:13.771328"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:10:18.495185"], ["updated_at", "2024-02-02 15:10:18.495185"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.7ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1aedec50-32a4-4c37-9e86-e088c569ef73', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:10:18.495185000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:10:18.495185000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:10:18.495185000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7d7494a9-cab9-4aff-94fa-1789236ae406\n"', 'EntityHistory::Events::Created', '2024-02-02 15:10:18.500412', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.9ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '1aedec50-32a4-4c37-9e86-e088c569ef73', '2024-02-02 15:10:18.514346') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (53.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:11:16.639502"], ["updated_at", "2024-02-02 15:11:16.639502"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:11:16.641645"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:11:16.643289"], ["updated_at", "2024-02-02 15:11:16.643289"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:16.729541"], ["updated_at", "2024-02-02 15:11:16.729541"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f140c962-e4e4-414e-a058-0e1134664fa0', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:16.729541000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:16.729541000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:16.729541000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''09035d07-81f9-444a-adcb-528be5f374e9''\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:16.731665', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'f140c962-e4e4-414e-a058-0e1134664fa0', '2024-02-02 15:11:16.735275') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:16.738234"], ["updated_at", "2024-02-02 15:11:16.738234"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0386a0cc-8c4b-4f62-830b-72a5e914cc00', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:16.738234000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:16.738234000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:16.738234000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 52a77eeb-b812-4987-92d3-53377c3e4921\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:16.739538', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '0386a0cc-8c4b-4f62-830b-72a5e914cc00', '2024-02-02 15:11:16.740681') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_14095"], ["updated_at", "2024-02-02 15:11:16.741646"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('843fe3de-572a-47b4-b5f4-90cdc8b69110', '"---\n:attributes:\n  id: 2\n  title: Good Job_14095\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:16.738234000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:16.738234000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:16.741646000 Z\n    zone: *1\n    time: 2024-02-02 15:11:16.741646000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_14095\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:16.738234000 Z\n  - *3\n"', '"---\n:correlation_id: 85e3e7bf-ee5f-418d-96af-4e94461534b8\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:16.742952', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '843fe3de-572a-47b4-b5f4-90cdc8b69110', '2024-02-02 15:11:16.744009') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0386a0cc-8c4b-4f62-830b-72a5e914cc00"], ["event_id", "843fe3de-572a-47b4-b5f4-90cdc8b69110"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:16.756649"], ["updated_at", "2024-02-02 15:11:16.756649"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('996b8a17-e589-43bd-a2af-06ed92eedb6b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:16.756649000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:16.756649000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:16.756649000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 518e92a2-1ea3-4e33-8bc9-3c28969c99e8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:16.757842', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '996b8a17-e589-43bd-a2af-06ed92eedb6b', '2024-02-02 15:11:16.759013') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_65959"], ["updated_at", "2024-02-02 15:11:16.760131"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fa950bb4-d06b-4372-b2e2-3d937eeed33b', '"---\n:attributes:\n  id: 3\n  title: Good Job_65959\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:16.756649000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:16.756649000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:16.760131000 Z\n    zone: *1\n    time: 2024-02-02 15:11:16.760131000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_65959\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:16.756649000 Z\n  - *3\n"', '"---\n:correlation_id: 557c7475-bb3c-445f-8814-872e943da990\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:16.761296', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'fa950bb4-d06b-4372-b2e2-3d937eeed33b', '2024-02-02 15:11:16.762236') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "996b8a17-e589-43bd-a2af-06ed92eedb6b"], ["event_id", "fa950bb4-d06b-4372-b2e2-3d937eeed33b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:11:44.599217"], ["updated_at", "2024-02-02 15:11:44.599217"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:11:44.601397"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:11:44.603125"], ["updated_at", "2024-02-02 15:11:44.603125"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:44.684536"], ["updated_at", "2024-02-02 15:11:44.684536"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('74aecbad-8d65-4ec1-8a5b-73293415e310', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:44.684536000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:44.684536000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:44.684536000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7b761c7f-6871-4c1d-9e47-cd7f1df6627f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:44.687013', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '74aecbad-8d65-4ec1-8a5b-73293415e310', '2024-02-02 15:11:44.690651') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:44.693822"], ["updated_at", "2024-02-02 15:11:44.693822"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('53a28726-8ce4-421d-ad73-fbd74405eba3', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:44.693822000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:44.693822000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:44.693822000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8d3ff0d9-e421-4246-9f2c-b065b6c4c902\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:44.695169', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '53a28726-8ce4-421d-ad73-fbd74405eba3', '2024-02-02 15:11:44.696329') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_30001"], ["updated_at", "2024-02-02 15:11:44.697323"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c52dc7e6-b948-48b4-b9f0-043252652bed', '"---\n:attributes:\n  id: 2\n  title: Good Job_30001\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:44.693822000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:44.693822000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:44.697323000 Z\n    zone: *1\n    time: 2024-02-02 15:11:44.697323000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_30001\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:44.693822000 Z\n  - *3\n"', '"---\n:correlation_id: 6858eb33-addb-4406-9035-c5e6b23a01b7\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:44.698659', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'c52dc7e6-b948-48b4-b9f0-043252652bed', '2024-02-02 15:11:44.699700') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "53a28726-8ce4-421d-ad73-fbd74405eba3"], ["event_id", "c52dc7e6-b948-48b4-b9f0-043252652bed"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:44.712962"], ["updated_at", "2024-02-02 15:11:44.712962"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8c39e95e-4cac-4815-9a0c-e9487cfd67c0', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:44.712962000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:44.712962000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:44.712962000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 24a2af8b-0bf5-490b-bcc7-8f5135e004fc\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:44.714409', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '8c39e95e-4cac-4815-9a0c-e9487cfd67c0', '2024-02-02 15:11:44.715474') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_83104"], ["updated_at", "2024-02-02 15:11:44.716464"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c3ba4e25-40d7-42f3-9d20-88a9aa21cdfb', '"---\n:attributes:\n  id: 3\n  title: Good Job_83104\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:44.712962000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:44.712962000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:44.716464000 Z\n    zone: *1\n    time: 2024-02-02 15:11:44.716464000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_83104\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:44.712962000 Z\n  - *3\n"', '"---\n:correlation_id: 163c8eea-9ec1-470b-acda-0b20d79c9ec3\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:44.717533', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c3ba4e25-40d7-42f3-9d20-88a9aa21cdfb', '2024-02-02 15:11:44.718592') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "8c39e95e-4cac-4815-9a0c-e9487cfd67c0"], ["event_id", "c3ba4e25-40d7-42f3-9d20-88a9aa21cdfb"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:11:58.251382"], ["updated_at", "2024-02-02 15:11:58.251382"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:11:58.253676"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:11:58.255414"], ["updated_at", "2024-02-02 15:11:58.255414"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:58.338084"], ["updated_at", "2024-02-02 15:11:58.338084"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9d67a5b8-94a1-4ab9-bb21-f05b873cd1df', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:58.338084000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.338084000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:58.338084000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 44b6a6a9-5c43-46d3-be63-7d41c39633ff\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:58.339889', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '9d67a5b8-94a1-4ab9-bb21-f05b873cd1df', '2024-02-02 15:11:58.343739') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:58.349713"], ["updated_at", "2024-02-02 15:11:58.349713"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fc125f5b-f64c-49fa-acf1-ea6e7d20d346', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:58.349713000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.349713000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:58.349713000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7fe20b28-ca15-41c7-84da-4e54a69ceb19\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:58.351018', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fc125f5b-f64c-49fa-acf1-ea6e7d20d346', '2024-02-02 15:11:58.352169') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:58.353686"], ["updated_at", "2024-02-02 15:11:58.353686"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2985ea52-e5b8-4910-acea-528a61f584d0', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:58.353686000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.353686000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:58.353686000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bf9c8dfb-7d3c-4c2c-b7d3-805f74252b28\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:58.354925', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '2985ea52-e5b8-4910-acea-528a61f584d0', '2024-02-02 15:11:58.356019') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_99835"], ["updated_at", "2024-02-02 15:11:58.356986"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('87174664-a5c0-43f0-8663-6ed7dc84f252', '"---\n:attributes:\n  id: 3\n  title: Good Job_99835\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:58.353686000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.353686000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:58.356986000 Z\n    zone: *1\n    time: 2024-02-02 15:11:58.356986000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_99835\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:58.353686000 Z\n  - *3\n"', '"---\n:correlation_id: 7ff07a0f-4e81-463a-ade4-4b4971cfdb55\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:58.358250', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '87174664-a5c0-43f0-8663-6ed7dc84f252', '2024-02-02 15:11:58.359255') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2985ea52-e5b8-4910-acea-528a61f584d0"], ["event_id", "87174664-a5c0-43f0-8663-6ed7dc84f252"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:11:58.371932"], ["updated_at", "2024-02-02 15:11:58.371932"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b8df1c50-3167-488f-835a-f1d4f041e1c1', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:11:58.371932000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.371932000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:11:58.371932000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e7c7a681-cf19-4a01-a8e6-f9bd0e3bb4ca\n"', 'EntityHistory::Events::Created', '2024-02-02 15:11:58.373259', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b8df1c50-3167-488f-835a-f1d4f041e1c1', '2024-02-02 15:11:58.374280') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_93831"], ["updated_at", "2024-02-02 15:11:58.375184"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c8314c0c-bcc7-4128-9409-14166a62c86f', '"---\n:attributes:\n  id: 4\n  title: Good Job_93831\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:11:58.371932000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:11:58.371932000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:11:58.375184000 Z\n    zone: *1\n    time: 2024-02-02 15:11:58.375184000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_93831\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:11:58.371932000 Z\n  - *3\n"', '"---\n:correlation_id: bdbeba7c-1a55-45b5-8bb6-0536f9b5d8ad\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:11:58.376257', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'c8314c0c-bcc7-4128-9409-14166a62c86f', '2024-02-02 15:11:58.377213') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "b8df1c50-3167-488f-835a-f1d4f041e1c1"], ["event_id", "c8314c0c-bcc7-4128-9409-14166a62c86f"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:12:14.590498"], ["updated_at", "2024-02-02 15:12:14.590498"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:12:14.592532"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:12:14.594085"], ["updated_at", "2024-02-02 15:12:14.594085"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:14.689270"], ["updated_at", "2024-02-02 15:12:14.689270"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('81b03699-b769-4a2a-a6bc-b4b3e0f45f8b', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:14.689270000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:14.689270000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:14.689270000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4a9975da-a90d-470d-81f0-6f6b80dad0e8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:14.691096', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '81b03699-b769-4a2a-a6bc-b4b3e0f45f8b', '2024-02-02 15:12:14.694481') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:14.697391"], ["updated_at", "2024-02-02 15:12:14.697391"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b5ae45b8-d8f9-422c-a1e4-2123344cd81a', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:14.697391000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:14.697391000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:14.697391000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9378134f-def6-4b00-adc7-bf3fa62f8089\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:14.698598', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'b5ae45b8-d8f9-422c-a1e4-2123344cd81a', '2024-02-02 15:12:14.699675') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_7278"], ["updated_at", "2024-02-02 15:12:14.700587"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('df1cf7ac-db47-4ec9-bfe5-1c8245995b1d', '"---\n:attributes:\n  id: 2\n  title: Good Job_7278\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:12:14.697391000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:14.697391000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:12:14.700587000 Z\n    zone: *1\n    time: 2024-02-02 15:12:14.700587000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_7278\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:12:14.697391000 Z\n  - *3\n"', '"---\n:correlation_id: e7bf1ddb-6ed5-4a26-9919-daa531b3c340\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:12:14.701862', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'df1cf7ac-db47-4ec9-bfe5-1c8245995b1d', '2024-02-02 15:12:14.705692') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "b5ae45b8-d8f9-422c-a1e4-2123344cd81a"], ["event_id", "df1cf7ac-db47-4ec9-bfe5-1c8245995b1d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:14.716608"], ["updated_at", "2024-02-02 15:12:14.716608"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b821a4bc-9fc8-4df9-b554-e997c6cf4ba0', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:14.716608000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:14.716608000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:14.716608000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 20db0c8c-2c24-442a-af0b-bf33d67d42b9\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:14.717865', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'b821a4bc-9fc8-4df9-b554-e997c6cf4ba0', '2024-02-02 15:12:14.718873') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_94550"], ["updated_at", "2024-02-02 15:12:14.719723"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3aa1837b-56c4-4e50-817e-d29dcf5598fe', '"---\n:attributes:\n  id: 3\n  title: Good Job_94550\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:12:14.716608000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:14.716608000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:12:14.719723000 Z\n    zone: *1\n    time: 2024-02-02 15:12:14.719723000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_94550\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:12:14.716608000 Z\n  - *3\n"', '"---\n:correlation_id: 25f4db19-7958-4d45-9559-06e888ef1b84\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:12:14.720764', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '3aa1837b-56c4-4e50-817e-d29dcf5598fe', '2024-02-02 15:12:14.721689') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "b821a4bc-9fc8-4df9-b554-e997c6cf4ba0"], ["event_id", "3aa1837b-56c4-4e50-817e-d29dcf5598fe"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:12:32.639638"], ["updated_at", "2024-02-02 15:12:32.639638"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:12:32.641630"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:12:32.643251"], ["updated_at", "2024-02-02 15:12:32.643251"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:32.725177"], ["updated_at", "2024-02-02 15:12:32.725177"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('27db9ba6-6e8f-4468-9ebd-28fbe830d545', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:32.725177000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:32.725177000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:32.725177000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1bb549df-4940-4f24-9dce-cf31f2e1c74f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:32.726989', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '27db9ba6-6e8f-4468-9ebd-28fbe830d545', '2024-02-02 15:12:32.730455') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:32.733345"], ["updated_at", "2024-02-02 15:12:32.733345"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eb9d92ac-4628-42c3-b637-0a77d14389db', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:32.733345000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:32.733345000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:32.733345000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 832d4766-2e15-40d7-a552-958923ddad2e\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:32.734595', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'eb9d92ac-4628-42c3-b637-0a77d14389db', '2024-02-02 15:12:32.735686') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_75103"], ["updated_at", "2024-02-02 15:12:32.736654"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5e9285bf-86f1-4a29-ab56-8130a90eb999', '"---\n:attributes:\n  id: 2\n  title: Good Job_75103\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:12:32.733345000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:32.733345000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:12:32.736654000 Z\n    zone: *1\n    time: 2024-02-02 15:12:32.736654000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_75103\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:12:32.733345000 Z\n  - *3\n"', '"---\n:correlation_id: 3ddd0e0c-2c93-46de-8cca-a1af817fa3b3\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:12:32.737924', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '5e9285bf-86f1-4a29-ab56-8130a90eb999', '2024-02-02 15:12:32.738915') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "eb9d92ac-4628-42c3-b637-0a77d14389db"], ["event_id", "5e9285bf-86f1-4a29-ab56-8130a90eb999"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:12:32.751612"], ["updated_at", "2024-02-02 15:12:32.751612"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f8f25054-9e10-4218-9e9e-c80cffa3fc83', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:12:32.751612000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:32.751612000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:12:32.751612000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 27ae97ae-87bf-4f1d-9da8-76a84c1c60d4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:12:32.752772', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f8f25054-9e10-4218-9e9e-c80cffa3fc83', '2024-02-02 15:12:32.753888') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_3821"], ["updated_at", "2024-02-02 15:12:32.754838"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cacf976e-113e-4667-8938-e0935298c860', '"---\n:attributes:\n  id: 3\n  title: Good Job_3821\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:12:32.751612000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:12:32.751612000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:12:32.754838000 Z\n    zone: *1\n    time: 2024-02-02 15:12:32.754838000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_3821\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:12:32.751612000 Z\n  - *3\n"', '"---\n:correlation_id: 2cf374dc-44e3-49a3-bcc9-66e876a18d3d\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:12:32.755995', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'cacf976e-113e-4667-8938-e0935298c860', '2024-02-02 15:12:32.756875') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f8f25054-9e10-4218-9e9e-c80cffa3fc83"], ["event_id", "cacf976e-113e-4667-8938-e0935298c860"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:13:20.141771"], ["updated_at", "2024-02-02 15:13:20.141771"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:13:20.143880"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:13:20.145520"], ["updated_at", "2024-02-02 15:13:20.145520"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:20.228568"], ["updated_at", "2024-02-02 15:13:20.228568"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eeb01259-55cd-4416-a63d-2fe21f89e9be', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:20.228568000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:20.228568000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:20.228568000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ef5fa9a0-021b-4e44-90b2-816c2018410e\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:20.230502', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'eeb01259-55cd-4416-a63d-2fe21f89e9be', '2024-02-02 15:13:20.234495') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:20.237606"], ["updated_at", "2024-02-02 15:13:20.237606"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fda60d7a-d9f5-45f8-a13d-b0b067b8a779', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:20.237606000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:20.237606000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:20.237606000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 195be1f8-d013-4476-b98b-686ba91ba4d8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:20.238917', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fda60d7a-d9f5-45f8-a13d-b0b067b8a779', '2024-02-02 15:13:20.240103') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_14686"], ["updated_at", "2024-02-02 15:13:20.241220"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('417d4f19-ae50-4037-920a-464cd3ddf9e8', '"---\n:attributes:\n  id: 2\n  title: Good Job_14686\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:13:20.237606000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:20.237606000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:13:20.241220000 Z\n    zone: *1\n    time: 2024-02-02 15:13:20.241220000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_14686\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:13:20.237606000 Z\n  - *3\n"', '"---\n:correlation_id: e6eea091-2ca6-4a00-8998-1969836be63c\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:13:20.242499', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '417d4f19-ae50-4037-920a-464cd3ddf9e8', '2024-02-02 15:13:20.243499') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "fda60d7a-d9f5-45f8-a13d-b0b067b8a779"], ["event_id", "417d4f19-ae50-4037-920a-464cd3ddf9e8"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:20.256166"], ["updated_at", "2024-02-02 15:13:20.256166"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7763b7b7-b4b0-4ce1-9993-a43838f28b05', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:20.256166000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:20.256166000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:20.256166000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a3faae3b-9a31-4b7e-90f6-1db3280c9833\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:20.257353', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '7763b7b7-b4b0-4ce1-9993-a43838f28b05', '2024-02-02 15:13:20.258534') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_64461"], ["updated_at", "2024-02-02 15:13:20.259397"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('02daae27-e5e5-44bc-adba-1c0b89334096', '"---\n:attributes:\n  id: 3\n  title: Good Job_64461\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:13:20.256166000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:20.256166000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:13:20.259397000 Z\n    zone: *1\n    time: 2024-02-02 15:13:20.259397000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_64461\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:13:20.256166000 Z\n  - *3\n"', '"---\n:correlation_id: f6703575-7d2d-4adc-9235-9d1f6b8ff267\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:13:20.260609', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '02daae27-e5e5-44bc-adba-1c0b89334096', '2024-02-02 15:13:20.261510') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "7763b7b7-b4b0-4ce1-9993-a43838f28b05"], ["event_id", "02daae27-e5e5-44bc-adba-1c0b89334096"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:13:29.268924"], ["updated_at", "2024-02-02 15:13:29.268924"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:13:29.270975"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:13:29.272657"], ["updated_at", "2024-02-02 15:13:29.272657"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:29.359807"], ["updated_at", "2024-02-02 15:13:29.359807"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('11fef887-b588-460b-9e1a-636b2ae023a7', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:29.359807000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:29.359807000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:29.359807000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 94338702-3236-4dbd-8713-4f249fb7593d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:29.361724', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '11fef887-b588-460b-9e1a-636b2ae023a7', '2024-02-02 15:13:29.365439') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:29.368471"], ["updated_at", "2024-02-02 15:13:29.368471"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('12b9aeb7-9f33-429d-8401-760011b71bb5', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:29.368471000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:29.368471000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:29.368471000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b056f59a-c437-47fb-a6a0-e66b755cb2b1\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:29.369762', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '12b9aeb7-9f33-429d-8401-760011b71bb5', '2024-02-02 15:13:29.370917') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_92827"], ["updated_at", "2024-02-02 15:13:29.372258"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f6f3611f-8453-4b3f-8c31-d223e4d980c9', '"---\n:attributes:\n  id: 2\n  title: Good Job_92827\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:13:29.368471000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:29.368471000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:13:29.372258000 Z\n    zone: *1\n    time: 2024-02-02 15:13:29.372258000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_92827\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:13:29.368471000 Z\n  - *3\n"', '"---\n:correlation_id: 9441671d-8319-4c77-98a9-3f6108b6d60a\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:13:29.373550', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f6f3611f-8453-4b3f-8c31-d223e4d980c9', '2024-02-02 15:13:29.374555') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "12b9aeb7-9f33-429d-8401-760011b71bb5"], ["event_id", "f6f3611f-8453-4b3f-8c31-d223e4d980c9"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:13:29.384029"], ["updated_at", "2024-02-02 15:13:29.384029"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('84afb6de-0698-4b52-9d51-f80cf93539fc', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:13:29.384029000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:29.384029000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:13:29.384029000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 93a131fc-235f-4875-b597-7c000607cf85\n"', 'EntityHistory::Events::Created', '2024-02-02 15:13:29.388255', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '84afb6de-0698-4b52-9d51-f80cf93539fc', '2024-02-02 15:13:29.389617') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_83539"], ["updated_at", "2024-02-02 15:13:29.390506"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('56920e9e-140f-47cf-8a27-acde434c2ea0', '"---\n:attributes:\n  id: 3\n  title: Good Job_83539\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:13:29.384029000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:13:29.384029000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:13:29.390506000 Z\n    zone: *1\n    time: 2024-02-02 15:13:29.390506000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_83539\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:13:29.384029000 Z\n  - *3\n"', '"---\n:correlation_id: 58eb1899-f79e-4a72-b9b6-4b1f9f19260e\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:13:29.391716', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '56920e9e-140f-47cf-8a27-acde434c2ea0', '2024-02-02 15:13:29.392656') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "84afb6de-0698-4b52-9d51-f80cf93539fc"], ["event_id", "56920e9e-140f-47cf-8a27-acde434c2ea0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (56.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (50.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:18:26.717424"], ["updated_at", "2024-02-02 15:18:26.717424"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:18:26.719496"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:18:26.721118"], ["updated_at", "2024-02-02 15:18:26.721118"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:26.812017"], ["updated_at", "2024-02-02 15:18:26.812017"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ca970ce2-997e-42ac-b143-f919b4e0fb74', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:26.812017000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:26.812017000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:26.812017000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 06dc0300-e296-4c3b-900d-cf146550f48d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:26.813788', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'ca970ce2-997e-42ac-b143-f919b4e0fb74', '2024-02-02 15:18:26.817496') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:26.820219"], ["updated_at", "2024-02-02 15:18:26.820219"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('39b6d0fb-c8de-4f8d-8874-d92875a0fad7', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:26.820219000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:26.820219000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:26.820219000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 26007594-acbe-40dc-adee-52b089b8a77e\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:26.821395', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '39b6d0fb-c8de-4f8d-8874-d92875a0fad7', '2024-02-02 15:18:26.822496') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_67164"], ["updated_at", "2024-02-02 15:18:26.823609"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('08063dd7-bc2c-4d7b-a190-8f05f6dec269', '"---\n:attributes:\n  id: 2\n  title: Good Job_67164\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:18:26.820219000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:26.820219000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:18:26.823609000 Z\n    zone: *1\n    time: 2024-02-02 15:18:26.823609000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_67164\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:18:26.820219000 Z\n  - *3\n"', '"---\n:correlation_id: 65019482-a7dd-4af6-9dd2-5c1263e32a98\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:18:26.824859', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '08063dd7-bc2c-4d7b-a190-8f05f6dec269', '2024-02-02 15:18:26.825838') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "39b6d0fb-c8de-4f8d-8874-d92875a0fad7"], ["event_id", "08063dd7-bc2c-4d7b-a190-8f05f6dec269"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:26.839652"], ["updated_at", "2024-02-02 15:18:26.839652"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('36e38c7c-e5d5-4343-957d-69320f3ea69c', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:26.839652000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:26.839652000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:26.839652000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c57b3758-b9f0-479c-aa70-e6d72435e326\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:26.840937', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '36e38c7c-e5d5-4343-957d-69320f3ea69c', '2024-02-02 15:18:26.842006') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_46572"], ["updated_at", "2024-02-02 15:18:26.843092"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('696dc276-71c7-4a73-9431-466bd57ee307', '"---\n:attributes:\n  id: 3\n  title: Good Job_46572\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:18:26.839652000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:26.839652000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:18:26.843092000 Z\n    zone: *1\n    time: 2024-02-02 15:18:26.843092000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_46572\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:18:26.839652000 Z\n  - *3\n"', '"---\n:correlation_id: dd357b3a-47e1-409e-8590-e5a845e19cbd\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:18:26.844191', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '696dc276-71c7-4a73-9431-466bd57ee307', '2024-02-02 15:18:26.845190') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "36e38c7c-e5d5-4343-957d-69320f3ea69c"], ["event_id", "696dc276-71c7-4a73-9431-466bd57ee307"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:18:39.045664"], ["updated_at", "2024-02-02 15:18:39.045664"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:18:39.047775"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:18:39.049559"], ["updated_at", "2024-02-02 15:18:39.049559"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:39.122006"], ["updated_at", "2024-02-02 15:18:39.122006"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('286f8e92-1cdc-4ae3-b836-a2079c01f50a', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:39.122006000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:39.122006000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:39.122006000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''063877a4-ad6a-4fd2-8c17-f1b61ea9aab0''\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:39.123812', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '286f8e92-1cdc-4ae3-b836-a2079c01f50a', '2024-02-02 15:18:39.127417') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:39.130955"], ["updated_at", "2024-02-02 15:18:39.130955"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('40100f9e-8416-407c-ab6f-c7a89ee5ffd6', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:39.130955000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:39.130955000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:39.130955000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 15969321-4a74-4ef0-b356-40559e12f171\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:39.132335', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '40100f9e-8416-407c-ab6f-c7a89ee5ffd6', '2024-02-02 15:18:39.133483') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_56267"], ["updated_at", "2024-02-02 15:18:39.134500"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('70223d62-269c-429b-972b-2e5fffb2522b', '"---\n:attributes:\n  id: 2\n  title: Good Job_56267\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:18:39.130955000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:39.130955000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:18:39.134500000 Z\n    zone: *1\n    time: 2024-02-02 15:18:39.134500000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_56267\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:18:39.130955000 Z\n  - *3\n"', '"---\n:correlation_id: ab135cc3-603b-4244-874d-87945294f4e5\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:18:39.135842', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '70223d62-269c-429b-972b-2e5fffb2522b', '2024-02-02 15:18:39.136888') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "40100f9e-8416-407c-ab6f-c7a89ee5ffd6"], ["event_id", "70223d62-269c-429b-972b-2e5fffb2522b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:18:39.149755"], ["updated_at", "2024-02-02 15:18:39.149755"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5cca7554-3139-4704-9efb-9e055df51b0b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:18:39.149755000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:39.149755000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:18:39.149755000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a8cf50a5-6e97-4831-9a80-e0f9031a6fb3\n"', 'EntityHistory::Events::Created', '2024-02-02 15:18:39.150927', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5cca7554-3139-4704-9efb-9e055df51b0b', '2024-02-02 15:18:39.152037') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_45906"], ["updated_at", "2024-02-02 15:18:39.152910"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bdc01311-b673-486b-8f57-32921c3d8dd6', '"---\n:attributes:\n  id: 3\n  title: Good Job_45906\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:18:39.149755000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:18:39.149755000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:18:39.152910000 Z\n    zone: *1\n    time: 2024-02-02 15:18:39.152910000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_45906\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:18:39.149755000 Z\n  - *3\n"', '"---\n:correlation_id: 2695d600-8405-4ed1-abaf-9b03c2418d2e\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:18:39.154067', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'bdc01311-b673-486b-8f57-32921c3d8dd6', '2024-02-02 15:18:39.154986') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5cca7554-3139-4704-9efb-9e055df51b0b"], ["event_id", "bdc01311-b673-486b-8f57-32921c3d8dd6"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (51.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:18:46.841870"], ["updated_at", "2024-02-02 15:18:46.841870"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:18:46.843868"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:18:46.845501"], ["updated_at", "2024-02-02 15:18:46.845501"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mBook Create (3.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:01.900182"], ["updated_at", "2024-02-02 15:19:01.900182"]]
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (1.4ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7ed0f335-cfe6-4307-bd7d-4844173b2508', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:01.900182000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:01.900182000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:01.900182000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: f9104528-9f81-435b-a29d-6ed2f498d254\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:01.909585', NULL) RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (1.0ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '7ed0f335-cfe6-4307-bd7d-4844173b2508', '2024-02-02 15:19:01.926518') RETURNING "id"[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ (byebug):1:in `block (4 levels) in <top (required)>'
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:19:21.469507"], ["updated_at", "2024-02-02 15:19:21.469507"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:19:21.471543"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:19:21.473073"], ["updated_at", "2024-02-02 15:19:21.473073"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:21.559363"], ["updated_at", "2024-02-02 15:19:21.559363"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c3db442c-d0e4-48c9-a46f-3eb48f752b6f', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:21.559363000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:21.559363000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:21.559363000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ca5c5aac-e600-4a0e-8377-7519633fa43f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:21.562315', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'c3db442c-d0e4-48c9-a46f-3eb48f752b6f', '2024-02-02 15:19:21.566804') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:21.570318"], ["updated_at", "2024-02-02 15:19:21.570318"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e0b2bd5d-bf73-4be7-b137-9202342913eb', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:21.570318000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:21.570318000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:21.570318000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b15c1449-87f4-4e29-90cc-223feba7febc\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:21.571760', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'e0b2bd5d-bf73-4be7-b137-9202342913eb', '2024-02-02 15:19:21.573006') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_60093"], ["updated_at", "2024-02-02 15:19:21.574295"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6f79d952-d228-4919-abf4-e947d249e862', '"---\n:attributes:\n  id: 2\n  title: Good Job_60093\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:19:21.570318000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:21.570318000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:19:21.574295000 Z\n    zone: *1\n    time: 2024-02-02 15:19:21.574295000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_60093\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:19:21.570318000 Z\n  - *3\n"', '"---\n:correlation_id: b6530c4d-f4ba-477e-8ebf-4d0d6884a949\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:19:21.575719', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '6f79d952-d228-4919-abf4-e947d249e862', '2024-02-02 15:19:21.576885') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e0b2bd5d-bf73-4be7-b137-9202342913eb"], ["event_id", "6f79d952-d228-4919-abf4-e947d249e862"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:21.591080"], ["updated_at", "2024-02-02 15:19:21.591080"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('28f03799-f898-459d-9a48-98f011e8ce5b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:21.591080000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:21.591080000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:21.591080000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 77ca9a50-2937-432a-b2a0-0e5a8e46b86b\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:21.592450', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '28f03799-f898-459d-9a48-98f011e8ce5b', '2024-02-02 15:19:21.593743') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_22974"], ["updated_at", "2024-02-02 15:19:21.594850"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9edfcce4-83f6-4561-9dec-5781adb0e4c7', '"---\n:attributes:\n  id: 3\n  title: Good Job_22974\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:19:21.591080000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:21.591080000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:19:21.594850000 Z\n    zone: *1\n    time: 2024-02-02 15:19:21.594850000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_22974\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:19:21.591080000 Z\n  - *3\n"', '"---\n:correlation_id: 6a14dbe4-bd03-4de5-adb1-e642c715d90d\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:19:21.596050', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '9edfcce4-83f6-4561-9dec-5781adb0e4c7', '2024-02-02 15:19:21.596993') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "28f03799-f898-459d-9a48-98f011e8ce5b"], ["event_id", "9edfcce4-83f6-4561-9dec-5781adb0e4c7"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:19:26.409981"], ["updated_at", "2024-02-02 15:19:26.409981"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:19:26.412110"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:19:26.413723"], ["updated_at", "2024-02-02 15:19:26.413723"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:26.482890"], ["updated_at", "2024-02-02 15:19:26.482890"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c27c7095-6052-412e-9f51-ab69ef42abd8', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:26.482890000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:26.482890000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:26.482890000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ab33ddcd-9418-4686-ab02-a43026a5270d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:26.484806', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'c27c7095-6052-412e-9f51-ab69ef42abd8', '2024-02-02 15:19:26.488475') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:26.491637"], ["updated_at", "2024-02-02 15:19:26.491637"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('82e221a2-9d81-455e-a5f5-d37fa979d475', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:26.491637000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:26.491637000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:26.491637000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8473582c-d270-4859-8ac3-a014cd7e068a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:26.492947', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '82e221a2-9d81-455e-a5f5-d37fa979d475', '2024-02-02 15:19:26.494101') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_96511"], ["updated_at", "2024-02-02 15:19:26.495091"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b2814282-69cd-4697-8481-c9c465de62e0', '"---\n:attributes:\n  id: 2\n  title: Good Job_96511\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:19:26.491637000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:26.491637000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:19:26.495091000 Z\n    zone: *1\n    time: 2024-02-02 15:19:26.495091000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_96511\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:19:26.491637000 Z\n  - *3\n"', '"---\n:correlation_id: 54f04fa4-f61b-457b-a5c3-ce39f68d4fc6\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:19:26.496399', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'b2814282-69cd-4697-8481-c9c465de62e0', '2024-02-02 15:19:26.497460') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "82e221a2-9d81-455e-a5f5-d37fa979d475"], ["event_id", "b2814282-69cd-4697-8481-c9c465de62e0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:19:26.509977"], ["updated_at", "2024-02-02 15:19:26.509977"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('122391ff-3464-4895-833e-8342068737cd', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:19:26.509977000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:26.509977000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:19:26.509977000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 62df00ac-fb54-428d-a7ce-700a19739162\n"', 'EntityHistory::Events::Created', '2024-02-02 15:19:26.511315', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '122391ff-3464-4895-833e-8342068737cd', '2024-02-02 15:19:26.512425') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_94456"], ["updated_at", "2024-02-02 15:19:26.513296"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cf60bc47-4c52-4740-ac58-13d6b6d5264e', '"---\n:attributes:\n  id: 3\n  title: Good Job_94456\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:19:26.509977000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:19:26.509977000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:19:26.513296000 Z\n    zone: *1\n    time: 2024-02-02 15:19:26.513296000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_94456\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:19:26.509977000 Z\n  - *3\n"', '"---\n:correlation_id: 74ce5c75-f956-45a0-95fe-6cde84aa61cd\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:19:26.514346', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'cf60bc47-4c52-4740-ac58-13d6b6d5264e', '2024-02-02 15:19:26.515478') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "122391ff-3464-4895-833e-8342068737cd"], ["event_id", "cf60bc47-4c52-4740-ac58-13d6b6d5264e"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:21:03.086796"], ["updated_at", "2024-02-02 15:21:03.086796"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:21:03.089128"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:21:03.091020"], ["updated_at", "2024-02-02 15:21:03.091020"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:03.173317"], ["updated_at", "2024-02-02 15:21:03.173317"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('67a100eb-c70a-4c50-8ea3-cd51506838da', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:03.173317000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:03.173317000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:03.173317000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d8b64c37-5032-4438-892d-4e8fa9a54f9e\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:03.175197', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '67a100eb-c70a-4c50-8ea3-cd51506838da', '2024-02-02 15:21:03.178764') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:03.181746"], ["updated_at", "2024-02-02 15:21:03.181746"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dd8bc5f7-99ef-4492-a57b-c67e493a45fe', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:03.181746000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:03.181746000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:03.181746000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e9336454-5cad-435c-8707-fb544d8eac0d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:03.183005', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'dd8bc5f7-99ef-4492-a57b-c67e493a45fe', '2024-02-02 15:21:03.184091') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_39741"], ["updated_at", "2024-02-02 15:21:03.185453"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dd6f5b11-0231-4f74-ae9d-369e8b0b8fce', '"---\n:attributes:\n  id: 2\n  title: Good Job_39741\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:03.181746000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:03.181746000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:03.185453000 Z\n    zone: *1\n    time: 2024-02-02 15:21:03.185453000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_39741\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:03.181746000 Z\n  - *3\n"', '"---\n:correlation_id: 11d64382-0dd2-451e-b107-c1fb18cc6367\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:03.186735', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'dd6f5b11-0231-4f74-ae9d-369e8b0b8fce', '2024-02-02 15:21:03.187745') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "dd8bc5f7-99ef-4492-a57b-c67e493a45fe"], ["event_id", "dd6f5b11-0231-4f74-ae9d-369e8b0b8fce"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:03.200026"], ["updated_at", "2024-02-02 15:21:03.200026"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f094fff7-4a34-4ddc-b7f0-2366d089cc44', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:03.200026000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:03.200026000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:03.200026000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e2f32c60-c0ef-45d1-b1a9-73a9bf507e33\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:03.201201', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f094fff7-4a34-4ddc-b7f0-2366d089cc44', '2024-02-02 15:21:03.202344') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_25067"], ["updated_at", "2024-02-02 15:21:03.203306"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5f6ff19c-cf89-4848-b427-db94fc0c591c', '"---\n:attributes:\n  id: 3\n  title: Good Job_25067\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:03.200026000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:03.200026000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:03.203306000 Z\n    zone: *1\n    time: 2024-02-02 15:21:03.203306000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_25067\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:03.200026000 Z\n  - *3\n"', '"---\n:correlation_id: e3ae3054-34a0-4fb9-9d75-219424271fa1\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:03.204613', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5f6ff19c-cf89-4848-b427-db94fc0c591c', '2024-02-02 15:21:03.205470') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f094fff7-4a34-4ddc-b7f0-2366d089cc44"], ["event_id", "5f6ff19c-cf89-4848-b427-db94fc0c591c"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (55.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:21:16.079013"], ["updated_at", "2024-02-02 15:21:16.079013"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:21:16.081273"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:21:16.083016"], ["updated_at", "2024-02-02 15:21:16.083016"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:16.166533"], ["updated_at", "2024-02-02 15:21:16.166533"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('69c23a03-a090-47c3-9028-09e94bbe072d', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:16.166533000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:16.166533000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:16.166533000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: dba02deb-38c8-4abc-a363-49aeba95dd2d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:16.168446', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '69c23a03-a090-47c3-9028-09e94bbe072d', '2024-02-02 15:21:16.171984') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:16.175056"], ["updated_at", "2024-02-02 15:21:16.175056"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fe5a3bed-a684-4fe5-8437-7115d299d8c3', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:16.175056000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:16.175056000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:16.175056000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3a73f88c-daa2-403d-b114-02bead7bb1bb\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:16.176385', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fe5a3bed-a684-4fe5-8437-7115d299d8c3', '2024-02-02 15:21:16.177546') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_54271"], ["updated_at", "2024-02-02 15:21:16.178547"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a3d89a1d-89c0-4f12-85bc-8dad78585580', '"---\n:attributes:\n  id: 2\n  title: Good Job_54271\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:16.175056000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:16.175056000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:16.178547000 Z\n    zone: *1\n    time: 2024-02-02 15:21:16.178547000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_54271\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:16.175056000 Z\n  - *3\n"', '"---\n:correlation_id: cbf50235-5f8b-455c-8af0-cc61f2dc2875\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:16.179868', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'a3d89a1d-89c0-4f12-85bc-8dad78585580', '2024-02-02 15:21:16.180899') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "fe5a3bed-a684-4fe5-8437-7115d299d8c3"], ["event_id", "a3d89a1d-89c0-4f12-85bc-8dad78585580"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:16.193977"], ["updated_at", "2024-02-02 15:21:16.193977"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0d7f756f-5749-4d38-b469-c13ef5bc7155', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:16.193977000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:16.193977000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:16.193977000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cba2e493-2e9a-4144-be3f-48a16cffa846\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:16.195327', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '0d7f756f-5749-4d38-b469-c13ef5bc7155', '2024-02-02 15:21:16.196355') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_45819"], ["updated_at", "2024-02-02 15:21:16.197325"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('779f2ee9-119b-42c7-b784-877e81235f99', '"---\n:attributes:\n  id: 3\n  title: Good Job_45819\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:16.193977000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:16.193977000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:16.197325000 Z\n    zone: *1\n    time: 2024-02-02 15:21:16.197325000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_45819\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:16.193977000 Z\n  - *3\n"', '"---\n:correlation_id: 93624de8-b911-44bd-87de-01e27e5d6895\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:16.198374', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '779f2ee9-119b-42c7-b784-877e81235f99', '2024-02-02 15:21:16.199408') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0d7f756f-5749-4d38-b469-c13ef5bc7155"], ["event_id", "779f2ee9-119b-42c7-b784-877e81235f99"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (53.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:21:29.750658"], ["updated_at", "2024-02-02 15:21:29.750658"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:21:29.752786"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:21:29.754492"], ["updated_at", "2024-02-02 15:21:29.754492"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:29.837886"], ["updated_at", "2024-02-02 15:21:29.837886"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d90d5fdf-04b0-426c-b762-e331eb7fd7a4', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:29.837886000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.837886000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:29.837886000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 11e69d88-8cd5-4992-acfe-ce8529bed6f9\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:29.839975', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'd90d5fdf-04b0-426c-b762-e331eb7fd7a4', '2024-02-02 15:21:29.843686') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:29.851623"], ["updated_at", "2024-02-02 15:21:29.851623"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fb001992-b426-4238-ba74-bd0caa75575b', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:29.851623000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.851623000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:29.851623000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''08eac9fa-d371-43cd-acb9-31661bfd22c8''\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:29.852897', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fb001992-b426-4238-ba74-bd0caa75575b', '2024-02-02 15:21:29.854038') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:29.855196"], ["updated_at", "2024-02-02 15:21:29.855196"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5c53af41-721c-41fa-adbf-e45e36f0460b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:29.855196000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.855196000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:29.855196000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1a19b02d-44f4-4a1f-9188-0a746354e9f8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:29.856417', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5c53af41-721c-41fa-adbf-e45e36f0460b', '2024-02-02 15:21:29.857496') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_90521"], ["updated_at", "2024-02-02 15:21:29.858457"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('249d8e42-c4b8-4d97-ae50-e30fa9f8eabe', '"---\n:attributes:\n  id: 3\n  title: Good Job_90521\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:29.855196000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.855196000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:29.858457000 Z\n    zone: *1\n    time: 2024-02-02 15:21:29.858457000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_90521\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:29.855196000 Z\n  - *3\n"', '"---\n:correlation_id: afc2a972-903a-49dd-80d1-dc89009d9d3f\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:29.859708', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '249d8e42-c4b8-4d97-ae50-e30fa9f8eabe', '2024-02-02 15:21:29.860699') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5c53af41-721c-41fa-adbf-e45e36f0460b"], ["event_id", "249d8e42-c4b8-4d97-ae50-e30fa9f8eabe"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:29.873257"], ["updated_at", "2024-02-02 15:21:29.873257"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('251be851-85c3-46d7-ad67-cff1dec2b869', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:29.873257000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.873257000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:29.873257000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: edde8193-a8ef-4560-b857-def3ed607f57\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:29.874460', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '251be851-85c3-46d7-ad67-cff1dec2b869', '2024-02-02 15:21:29.875547') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_67014"], ["updated_at", "2024-02-02 15:21:29.876464"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b539b41e-498e-459b-a86b-2b48b4399389', '"---\n:attributes:\n  id: 4\n  title: Good Job_67014\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:29.873257000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:29.873257000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:29.876464000 Z\n    zone: *1\n    time: 2024-02-02 15:21:29.876464000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_67014\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:29.873257000 Z\n  - *3\n"', '"---\n:correlation_id: 6a50ee40-2b30-4e77-beab-1fc38f96030c\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:29.877648', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b539b41e-498e-459b-a86b-2b48b4399389', '2024-02-02 15:21:29.878642') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "251be851-85c3-46d7-ad67-cff1dec2b869"], ["event_id", "b539b41e-498e-459b-a86b-2b48b4399389"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (36.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:21:52.101527"], ["updated_at", "2024-02-02 15:21:52.101527"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:21:52.103823"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:21:52.105563"], ["updated_at", "2024-02-02 15:21:52.105563"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:52.189330"], ["updated_at", "2024-02-02 15:21:52.189330"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cc37756b-2a6c-4eba-9d95-911d5ba8f05a', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:52.189330000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.189330000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:52.189330000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: da18cd17-8c7e-45e7-aaca-2f813c36ee7f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:52.194641', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (4.8ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, 'cc37756b-2a6c-4eba-9d95-911d5ba8f05a', '2024-02-02 15:21:52.198702') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:52.209405"], ["updated_at", "2024-02-02 15:21:52.209405"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('717775d1-f07e-43a9-ac1b-738402b73c1e', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:52.209405000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.209405000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:52.209405000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 991c2c4f-c997-487b-9898-957ca58394f9\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:52.210750', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '717775d1-f07e-43a9-ac1b-738402b73c1e', '2024-02-02 15:21:52.211942') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:52.213132"], ["updated_at", "2024-02-02 15:21:52.213132"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ff82dd96-dc46-4d32-ae06-19f1fbb1bef5', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:52.213132000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.213132000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:52.213132000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b2347c21-f42a-4e8b-976e-80827678c1f0\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:52.214478', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'ff82dd96-dc46-4d32-ae06-19f1fbb1bef5', '2024-02-02 15:21:52.215587') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_95049"], ["updated_at", "2024-02-02 15:21:52.216591"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d3deb3af-8fc3-40b0-b3c5-9176efd48d52', '"---\n:attributes:\n  id: 3\n  title: Good Job_95049\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:52.213132000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.213132000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:52.216591000 Z\n    zone: *1\n    time: 2024-02-02 15:21:52.216591000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_95049\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:52.213132000 Z\n  - *3\n"', '"---\n:correlation_id: 75b51ab2-3af6-46ae-bf35-7080688e3448\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:52.217937', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd3deb3af-8fc3-40b0-b3c5-9176efd48d52', '2024-02-02 15:21:52.219009') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ff82dd96-dc46-4d32-ae06-19f1fbb1bef5"], ["event_id", "d3deb3af-8fc3-40b0-b3c5-9176efd48d52"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:21:52.232762"], ["updated_at", "2024-02-02 15:21:52.232762"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('03378b64-b9d4-4e6d-b080-45fdc541e5e1', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:21:52.232762000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.232762000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:21:52.232762000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 202f9034-2d0e-4a1e-b424-188d74931b4a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:21:52.234151', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '03378b64-b9d4-4e6d-b080-45fdc541e5e1', '2024-02-02 15:21:52.235178') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_73471"], ["updated_at", "2024-02-02 15:21:52.236058"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1a9b3494-0530-4988-974d-56fd145b3278', '"---\n:attributes:\n  id: 4\n  title: Good Job_73471\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:21:52.232762000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:21:52.232762000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:21:52.236058000 Z\n    zone: *1\n    time: 2024-02-02 15:21:52.236058000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_73471\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:21:52.232762000 Z\n  - *3\n"', '"---\n:correlation_id: 57ffb734-ecf1-4eb2-b796-51ed29928860\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:21:52.237126', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '1a9b3494-0530-4988-974d-56fd145b3278', '2024-02-02 15:21:52.238070') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "03378b64-b9d4-4e6d-b080-45fdc541e5e1"], ["event_id", "1a9b3494-0530-4988-974d-56fd145b3278"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (52.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:27:23.616100"], ["updated_at", "2024-02-02 15:27:23.616100"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:27:23.618341"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:27:23.620022"], ["updated_at", "2024-02-02 15:27:23.620022"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:23.706080"], ["updated_at", "2024-02-02 15:27:23.706080"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('66917ca3-a264-4854-b357-d4c14aa7a971', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:23.706080000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:23.706080000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:23.706080000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 38a5a093-d184-49a4-969c-87523863ee63\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:23.707995', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '66917ca3-a264-4854-b357-d4c14aa7a971', '2024-02-02 15:27:23.711810') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:23.714672"], ["updated_at", "2024-02-02 15:27:23.714672"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ce5c5a01-f095-45ef-9363-b31a20b6a05f', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:23.714672000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:23.714672000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:23.714672000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c24b40b6-148c-4f8f-af89-263166002690\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:23.715898', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ce5c5a01-f095-45ef-9363-b31a20b6a05f', '2024-02-02 15:27:23.717083') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_87635"], ["updated_at", "2024-02-02 15:27:23.718053"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7e5b0ada-89b1-44c6-8837-72ba984b50de', '"---\n:attributes:\n  id: 2\n  title: Good Job_87635\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:23.714672000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:23.714672000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:23.718053000 Z\n    zone: *1\n    time: 2024-02-02 15:27:23.718053000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_87635\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:23.714672000 Z\n  - *3\n"', '"---\n:correlation_id: c1883fc1-54ca-47d8-9d79-a323362bffa8\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:23.719322', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7e5b0ada-89b1-44c6-8837-72ba984b50de', '2024-02-02 15:27:23.720336') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ce5c5a01-f095-45ef-9363-b31a20b6a05f"], ["event_id", "7e5b0ada-89b1-44c6-8837-72ba984b50de"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:23.734542"], ["updated_at", "2024-02-02 15:27:23.734542"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c2c5a9c2-9b7d-41c0-a458-d7b69316c1f0', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:23.734542000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:23.734542000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:23.734542000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 937af1f0-4a67-46b9-ac0b-96120e998681\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:23.735686', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c2c5a9c2-9b7d-41c0-a458-d7b69316c1f0', '2024-02-02 15:27:23.736889') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_33396"], ["updated_at", "2024-02-02 15:27:23.737740"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d0759b16-dd2b-41d3-ba2d-e7dece4f9073', '"---\n:attributes:\n  id: 3\n  title: Good Job_33396\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:23.734542000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:23.734542000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:23.737740000 Z\n    zone: *1\n    time: 2024-02-02 15:27:23.737740000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_33396\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:23.734542000 Z\n  - *3\n"', '"---\n:correlation_id: 49b4f482-dea8-400a-b1cb-09c3e0295e28\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:23.738839', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd0759b16-dd2b-41d3-ba2d-e7dece4f9073', '2024-02-02 15:27:23.739793') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c2c5a9c2-9b7d-41c0-a458-d7b69316c1f0"], ["event_id", "d0759b16-dd2b-41d3-ba2d-e7dece4f9073"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:27:37.492760"], ["updated_at", "2024-02-02 15:27:37.492760"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:27:37.494803"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:27:37.496468"], ["updated_at", "2024-02-02 15:27:37.496468"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:37.582560"], ["updated_at", "2024-02-02 15:27:37.582560"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('464441e5-412f-455c-820b-80b767e27511', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:37.582560000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:37.582560000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:37.582560000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4da895c4-3b64-45ab-8c8a-f82b2ee4b9ee\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:37.584381', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '464441e5-412f-455c-820b-80b767e27511', '2024-02-02 15:27:37.588067') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:37.590847"], ["updated_at", "2024-02-02 15:27:37.590847"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0b91d43a-b53f-4a6d-af85-1f48ca073100', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:37.590847000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:37.590847000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:37.590847000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5dbe0f79-dd89-474f-9a97-97f427abc1e6\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:37.592051', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '0b91d43a-b53f-4a6d-af85-1f48ca073100', '2024-02-02 15:27:37.593182') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_20951"], ["updated_at", "2024-02-02 15:27:37.594131"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eb9b3176-64e9-417e-b399-1dfbe19f19cc', '"---\n:attributes:\n  id: 2\n  title: Good Job_20951\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:37.590847000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:37.590847000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:37.594131000 Z\n    zone: *1\n    time: 2024-02-02 15:27:37.594131000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_20951\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:37.590847000 Z\n  - *3\n"', '"---\n:correlation_id: a72609db-e1c8-4a2f-95b3-cc4acc50c97d\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:37.595398', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'eb9b3176-64e9-417e-b399-1dfbe19f19cc', '2024-02-02 15:27:37.596426') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0b91d43a-b53f-4a6d-af85-1f48ca073100"], ["event_id", "eb9b3176-64e9-417e-b399-1dfbe19f19cc"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:37.608977"], ["updated_at", "2024-02-02 15:27:37.608977"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9954c070-54d8-4560-9564-f9182470c3d3', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:37.608977000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:37.608977000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:37.608977000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c40478b2-ad1b-49bd-8b70-6b1835c19475\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:37.610181', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '9954c070-54d8-4560-9564-f9182470c3d3', '2024-02-02 15:27:37.611320') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_31723"], ["updated_at", "2024-02-02 15:27:37.612258"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9a21c9e2-7fd7-433b-87c6-f04099d48949', '"---\n:attributes:\n  id: 3\n  title: Good Job_31723\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:37.608977000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:37.608977000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:37.612258000 Z\n    zone: *1\n    time: 2024-02-02 15:27:37.612258000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_31723\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:37.608977000 Z\n  - *3\n"', '"---\n:correlation_id: fd9d4838-a7ec-4c33-afd2-006ac30faa15\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:37.613477', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '9a21c9e2-7fd7-433b-87c6-f04099d48949', '2024-02-02 15:27:37.614361') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "9954c070-54d8-4560-9564-f9182470c3d3"], ["event_id", "9a21c9e2-7fd7-433b-87c6-f04099d48949"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:27:54.018013"], ["updated_at", "2024-02-02 15:27:54.018013"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:27:54.019996"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:27:54.021509"], ["updated_at", "2024-02-02 15:27:54.021509"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:54.094993"], ["updated_at", "2024-02-02 15:27:54.094993"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1a9e5564-3bd8-4a0f-be1c-044a9a81533f', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:54.094993000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:54.094993000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:54.094993000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7ac3918c-9c9e-44f7-8892-f8ff6189a3c3\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:54.096863', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '1a9e5564-3bd8-4a0f-be1c-044a9a81533f', '2024-02-02 15:27:54.100628') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:54.103768"], ["updated_at", "2024-02-02 15:27:54.103768"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7526e2e0-9b94-45ae-b7f6-59d124626971', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:54.103768000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:54.103768000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:54.103768000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4d7e4e77-1a0e-4eb5-94ba-5ad6ab546a39\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:54.105184', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7526e2e0-9b94-45ae-b7f6-59d124626971', '2024-02-02 15:27:54.106334') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_38479"], ["updated_at", "2024-02-02 15:27:54.107342"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2ccfe41b-aae1-4b8d-a0c9-e826bacfa814', '"---\n:attributes:\n  id: 2\n  title: Good Job_38479\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:54.103768000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:54.103768000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:54.107342000 Z\n    zone: *1\n    time: 2024-02-02 15:27:54.107342000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_38479\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:54.103768000 Z\n  - *3\n"', '"---\n:correlation_id: db15a106-770f-491d-be24-aef6d7a258ff\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:54.108722', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '2ccfe41b-aae1-4b8d-a0c9-e826bacfa814', '2024-02-02 15:27:54.109794') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "7526e2e0-9b94-45ae-b7f6-59d124626971"], ["event_id", "2ccfe41b-aae1-4b8d-a0c9-e826bacfa814"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:27:54.123280"], ["updated_at", "2024-02-02 15:27:54.123280"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c2bf5191-8669-462c-b2a8-9ceb7b8e92ed', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:27:54.123280000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:54.123280000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:27:54.123280000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1e8feeda-6dc4-4521-a882-c07ad7eb7fbe\n"', 'EntityHistory::Events::Created', '2024-02-02 15:27:54.124496', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c2bf5191-8669-462c-b2a8-9ceb7b8e92ed', '2024-02-02 15:27:54.125655') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_87654"], ["updated_at", "2024-02-02 15:27:54.126670"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('25db91cb-4c5e-4848-aa33-9d51922c177a', '"---\n:attributes:\n  id: 3\n  title: Good Job_87654\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:27:54.123280000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:27:54.123280000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:27:54.126670000 Z\n    zone: *1\n    time: 2024-02-02 15:27:54.126670000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_87654\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:27:54.123280000 Z\n  - *3\n"', '"---\n:correlation_id: 5ff45aac-49b1-453c-8f0f-4847d401a91f\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:27:54.127941', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '25db91cb-4c5e-4848-aa33-9d51922c177a', '2024-02-02 15:27:54.128867') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c2bf5191-8669-462c-b2a8-9ceb7b8e92ed"], ["event_id", "25db91cb-4c5e-4848-aa33-9d51922c177a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:28:16.852491"], ["updated_at", "2024-02-02 15:28:16.852491"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:28:16.854758"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:28:16.856421"], ["updated_at", "2024-02-02 15:28:16.856421"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:16.941079"], ["updated_at", "2024-02-02 15:28:16.941079"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:16.942938"], ["updated_at", "2024-02-02 15:28:16.942938"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ddbee3f7-ef93-426b-b6ca-0b54f9365ac8', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:16.942938000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:16.942938000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:16.942938000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 70fab07c-e095-4dd3-a113-175936e7fe37\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:16.944349', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ddbee3f7-ef93-426b-b6ca-0b54f9365ac8', '2024-02-02 15:28:16.947816') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:16.950699"], ["updated_at", "2024-02-02 15:28:16.950699"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ab2f56ed-bf99-4dda-b3cd-b9c6b4a7cd73', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:16.950699000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:16.950699000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:16.950699000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: eb178563-01af-422b-bff4-04b8e56d4b36\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:16.951977', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'ab2f56ed-bf99-4dda-b3cd-b9c6b4a7cd73', '2024-02-02 15:28:16.953099') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_59909"], ["updated_at", "2024-02-02 15:28:16.954081"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a9d87be3-344c-498b-91f8-c15ef9735db8', '"---\n:attributes:\n  id: 3\n  title: Good Job_59909\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:28:16.950699000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:16.950699000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:28:16.954081000 Z\n    zone: *1\n    time: 2024-02-02 15:28:16.954081000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_59909\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:28:16.950699000 Z\n  - *3\n"', '"---\n:correlation_id: 63f59201-384d-4da9-ada7-2c01ffdfc009\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:28:16.955409', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'a9d87be3-344c-498b-91f8-c15ef9735db8', '2024-02-02 15:28:16.956425') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ab2f56ed-bf99-4dda-b3cd-b9c6b4a7cd73"], ["event_id", "a9d87be3-344c-498b-91f8-c15ef9735db8"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:16.969032"], ["updated_at", "2024-02-02 15:28:16.969032"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('25b4c8af-24b3-4c3b-a66c-9efde1358359', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:16.969032000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:16.969032000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:16.969032000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 71d57358-e24f-4a73-bd1f-063607ce5927\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:16.970455', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '25b4c8af-24b3-4c3b-a66c-9efde1358359', '2024-02-02 15:28:16.971451') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_19069"], ["updated_at", "2024-02-02 15:28:16.972433"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3d7c512f-6071-43af-becf-cd88335e815c', '"---\n:attributes:\n  id: 4\n  title: Good Job_19069\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:28:16.969032000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:16.969032000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:28:16.972433000 Z\n    zone: *1\n    time: 2024-02-02 15:28:16.972433000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_19069\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:28:16.969032000 Z\n  - *3\n"', '"---\n:correlation_id: a52ad489-d3cf-4fe7-a0cf-2dfa52d9af1b\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:28:16.973604', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '3d7c512f-6071-43af-becf-cd88335e815c', '2024-02-02 15:28:16.974602') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "25b4c8af-24b3-4c3b-a66c-9efde1358359"], ["event_id", "3d7c512f-6071-43af-becf-cd88335e815c"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (1.0ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (43.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:28:47.961784"], ["updated_at", "2024-02-02 15:28:47.961784"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:28:47.964030"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:28:47.965637"], ["updated_at", "2024-02-02 15:28:47.965637"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:48.037582"], ["updated_at", "2024-02-02 15:28:48.037582"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7f5a45af-9eac-47bb-b374-c6241f40f0ab', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:48.037582000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.037582000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:48.037582000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5fba9b98-bff5-484e-81c1-f1913aa36fb2\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:48.039336', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '7f5a45af-9eac-47bb-b374-c6241f40f0ab', '2024-02-02 15:28:48.043031') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:48.046628"], ["updated_at", "2024-02-02 15:28:48.046628"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('842e1b23-cfba-474d-98dd-bc36f9c3487e', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:48.046628000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.046628000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:48.046628000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2bf8083e-357d-4c09-879c-53b4f3ce330d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:48.048017', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '842e1b23-cfba-474d-98dd-bc36f9c3487e', '2024-02-02 15:28:48.049250') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:48.050466"], ["updated_at", "2024-02-02 15:28:48.050466"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7c844b4e-352b-401a-94b7-5b406d47b7ad', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:48.050466000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.050466000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:48.050466000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cdd8579c-cc1c-4bbe-977c-79b2a0da3d93\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:48.051772', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '7c844b4e-352b-401a-94b7-5b406d47b7ad', '2024-02-02 15:28:48.052897') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_48053"], ["updated_at", "2024-02-02 15:28:48.053905"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('da78e31f-9b19-4594-bb12-6eab4db3ac46', '"---\n:attributes:\n  id: 3\n  title: Good Job_48053\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:28:48.050466000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.050466000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:28:48.053905000 Z\n    zone: *1\n    time: 2024-02-02 15:28:48.053905000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_48053\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:28:48.050466000 Z\n  - *3\n"', '"---\n:correlation_id: 84f04ec2-d1d8-460c-9870-f3a434335fa6\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:28:48.058128', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'da78e31f-9b19-4594-bb12-6eab4db3ac46', '2024-02-02 15:28:48.059169') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "7c844b4e-352b-401a-94b7-5b406d47b7ad"], ["event_id", "da78e31f-9b19-4594-bb12-6eab4db3ac46"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 4) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:28:48.070022"], ["updated_at", "2024-02-02 15:28:48.070022"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fdf90ace-79f5-4937-9dc6-a4a0316bd345', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:28:48.070022000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.070022000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:28:48.070022000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d9b46a0a-ca12-45f3-8f45-ba9b38b03d62\n"', 'EntityHistory::Events::Created', '2024-02-02 15:28:48.071262', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'fdf90ace-79f5-4937-9dc6-a4a0316bd345', '2024-02-02 15:28:48.072327') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_25865"], ["updated_at", "2024-02-02 15:28:48.073216"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fe4d6644-4c26-432b-a3db-78c071b0136f', '"---\n:attributes:\n  id: 4\n  title: Good Job_25865\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:28:48.070022000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:28:48.070022000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:28:48.073216000 Z\n    zone: *1\n    time: 2024-02-02 15:28:48.073216000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_25865\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:28:48.070022000 Z\n  - *3\n"', '"---\n:correlation_id: 2692cadf-c84a-4b62-afc5-612cd3eaad68\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:28:48.074335', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'fe4d6644-4c26-432b-a3db-78c071b0136f', '2024-02-02 15:28:48.075246') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "fdf90ace-79f5-4937-9dc6-a4a0316bd345"], ["event_id", "fe4d6644-4c26-432b-a3db-78c071b0136f"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 6) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:29:23.376179"], ["updated_at", "2024-02-02 15:29:23.376179"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:29:23.378295"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:29:23.379918"], ["updated_at", "2024-02-02 15:29:23.379918"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:29:23.462237"], ["updated_at", "2024-02-02 15:29:23.462237"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3b7f551c-6317-4c81-a49b-3546971b5d8b', '"---\n:attributes:\n  id: 1\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:29:23.462237000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:29:23.462237000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:29:23.462237000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 1\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 20d231df-1295-48e2-a396-4d1787010ab6\n"', 'EntityHistory::Events::Created', '2024-02-02 15:29:23.464115', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_1', NULL, '3b7f551c-6317-4c81-a49b-3546971b5d8b', '2024-02-02 15:29:23.467987') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:29:23.471117"], ["updated_at", "2024-02-02 15:29:23.471117"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4d904925-7478-4c6e-b557-bc2efedfa272', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:29:23.471117000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:29:23.471117000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:29:23.471117000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 849535e5-e5a3-41bc-8454-45760984c126\n"', 'EntityHistory::Events::Created', '2024-02-02 15:29:23.472408', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4d904925-7478-4c6e-b557-bc2efedfa272', '2024-02-02 15:29:23.473544') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_57739"], ["updated_at", "2024-02-02 15:29:23.474507"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7f09df67-e806-4a40-93e7-1e0aa17658ff', '"---\n:attributes:\n  id: 2\n  title: Good Job_57739\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:29:23.471117000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:29:23.471117000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:29:23.474507000 Z\n    zone: *1\n    time: 2024-02-02 15:29:23.474507000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_57739\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:29:23.471117000 Z\n  - *3\n"', '"---\n:correlation_id: ''0284b7bd-2a90-449b-a7ed-d3802e0f4ee7''\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:29:23.475813', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7f09df67-e806-4a40-93e7-1e0aa17658ff', '2024-02-02 15:29:23.476844') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "4d904925-7478-4c6e-b557-bc2efedfa272"], ["event_id", "7f09df67-e806-4a40-93e7-1e0aa17658ff"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_2"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:29:23.489634"], ["updated_at", "2024-02-02 15:29:23.489634"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c27e0128-3a6c-44c9-a3ad-1cdeccf304f3', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:29:23.489634000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:29:23.489634000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:29:23.489634000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bbc4a7ad-997d-4c37-9ab3-8877f94f9f8d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:29:23.490797', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c27e0128-3a6c-44c9-a3ad-1cdeccf304f3', '2024-02-02 15:29:23.491996') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_30716"], ["updated_at", "2024-02-02 15:29:23.492849"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d653e61b-f2a6-44a2-a2bc-4af60c48da17', '"---\n:attributes:\n  id: 3\n  title: Good Job_30716\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:29:23.489634000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:29:23.489634000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:29:23.492849000 Z\n    zone: *1\n    time: 2024-02-02 15:29:23.492849000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_30716\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:29:23.489634000 Z\n  - *3\n"', '"---\n:correlation_id: a3371fdf-e302-442b-8db6-f6375f9c4687\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:29:23.493978', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd653e61b-f2a6-44a2-a2bc-4af60c48da17', '2024-02-02 15:29:23.494976') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "c27e0128-3a6c-44c9-a3ad-1cdeccf304f3"], ["event_id", "d653e61b-f2a6-44a2-a2bc-4af60c48da17"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:31:48.961190"], ["updated_at", "2024-02-02 15:31:48.961190"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:31:48.963262"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:31:48.964784"], ["updated_at", "2024-02-02 15:31:48.964784"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:31:49.047914"], ["updated_at", "2024-02-02 15:31:49.047914"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:31:49.049900"], ["updated_at", "2024-02-02 15:31:49.049900"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('311f3a92-7173-4e71-a91b-ed916bfb640f', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:31:49.049900000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:31:49.049900000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:31:49.049900000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 18bcdb6a-691f-42ad-9d15-7e02abdc2ab9\n"', 'EntityHistory::Events::Created', '2024-02-02 15:31:49.051244', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '311f3a92-7173-4e71-a91b-ed916bfb640f', '2024-02-02 15:31:49.054896') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:31:49.057824"], ["updated_at", "2024-02-02 15:31:49.057824"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d9033eaa-06fa-4246-870f-8152e4405a23', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:31:49.057824000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:31:49.057824000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:31:49.057824000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 951ccd36-0ce6-4faa-9182-d67a66a0a627\n"', 'EntityHistory::Events::Created', '2024-02-02 15:31:49.059104', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd9033eaa-06fa-4246-870f-8152e4405a23', '2024-02-02 15:31:49.060224') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_84928"], ["updated_at", "2024-02-02 15:31:49.061178"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c49be0d4-ebcb-4012-822c-7fb555012c0b', '"---\n:attributes:\n  id: 3\n  title: Good Job_84928\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:31:49.057824000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:31:49.057824000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:31:49.061178000 Z\n    zone: *1\n    time: 2024-02-02 15:31:49.061178000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_84928\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:31:49.057824000 Z\n  - *3\n"', '"---\n:correlation_id: b810977e-b6c1-4109-b2c6-8f566025bfba\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:31:49.062480', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c49be0d4-ebcb-4012-822c-7fb555012c0b', '2024-02-02 15:31:49.063476') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d9033eaa-06fa-4246-870f-8152e4405a23"], ["event_id", "c49be0d4-ebcb-4012-822c-7fb555012c0b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 3) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_3"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:31:49.076163"], ["updated_at", "2024-02-02 15:31:49.076163"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ab9b1ef8-cfa6-4672-80fb-08ae0d1260ea', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:31:49.076163000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:31:49.076163000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:31:49.076163000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1c23b14f-7e6a-409b-9a54-6f7504c49c2c\n"', 'EntityHistory::Events::Created', '2024-02-02 15:31:49.077500', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'ab9b1ef8-cfa6-4672-80fb-08ae0d1260ea', '2024-02-02 15:31:49.078722') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_43825"], ["updated_at", "2024-02-02 15:31:49.079619"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('53841791-882a-4f99-b747-9d78baf124dd', '"---\n:attributes:\n  id: 4\n  title: Good Job_43825\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:31:49.076163000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:31:49.076163000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:31:49.079619000 Z\n    zone: *1\n    time: 2024-02-02 15:31:49.079619000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_43825\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:31:49.076163000 Z\n  - *3\n"', '"---\n:correlation_id: 404c333e-5cf9-4a3c-9481-14d9e1a231fc\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:31:49.080767', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '53841791-882a-4f99-b747-9d78baf124dd', '2024-02-02 15:31:49.081666') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ab9b1ef8-cfa6-4672-80fb-08ae0d1260ea"], ["event_id", "53841791-882a-4f99-b747-9d78baf124dd"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_4"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (52.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:32:04.696646"], ["updated_at", "2024-02-02 15:32:04.696646"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:32:04.699059"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:32:04.700920"], ["updated_at", "2024-02-02 15:32:04.700920"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.783901"], ["updated_at", "2024-02-02 15:32:04.783901"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.785721"], ["updated_at", "2024-02-02 15:32:04.785721"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ba66ab60-f330-4311-8a61-b6efdaf714e4', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:04.785721000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.785721000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:04.785721000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9985c972-dbc5-4d43-a329-8e90aca641d5\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:04.786864', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ba66ab60-f330-4311-8a61-b6efdaf714e4', '2024-02-02 15:32:04.790169') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.793000"], ["updated_at", "2024-02-02 15:32:04.793000"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('694e8d0c-1f0a-4432-9768-93a32e94f759', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:04.793000000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.793000000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:04.793000000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 26c6bb12-2316-458d-b630-13c5179c37c8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:04.794086', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '694e8d0c-1f0a-4432-9768-93a32e94f759', '2024-02-02 15:32:04.795042') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.796022"], ["updated_at", "2024-02-02 15:32:04.796022"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('535e5411-6c4e-40a3-a1cd-8caf2e0e1c75', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:04.796022000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.796022000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:04.796022000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 56809d7c-46f3-4172-beb8-449065e29e41\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:04.797214', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '535e5411-6c4e-40a3-a1cd-8caf2e0e1c75', '2024-02-02 15:32:04.798258') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.799422"], ["updated_at", "2024-02-02 15:32:04.799422"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fdac691d-5473-437e-aa79-d0c596b1963c', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:04.799422000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.799422000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:04.799422000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7f0d3e64-bffe-49ef-a4a0-f29226ffc07f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:04.800642', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'fdac691d-5473-437e-aa79-d0c596b1963c', '2024-02-02 15:32:04.804423') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_10201"], ["updated_at", "2024-02-02 15:32:04.805385"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('609ad1eb-16e6-469e-9053-fc9a474c286d', '"---\n:attributes:\n  id: 5\n  title: Good Job_10201\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:04.799422000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.799422000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:04.805385000 Z\n    zone: *1\n    time: 2024-02-02 15:32:04.805385000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_10201\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:04.799422000 Z\n  - *3\n"', '"---\n:correlation_id: 2f2a4405-c92d-4afe-88b3-6fd4f0967a3b\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:04.806928', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '609ad1eb-16e6-469e-9053-fc9a474c286d', '2024-02-02 15:32:04.807846') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "fdac691d-5473-437e-aa79-d0c596b1963c"], ["event_id", "609ad1eb-16e6-469e-9053-fc9a474c286d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:04.817001"], ["updated_at", "2024-02-02 15:32:04.817001"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3128b5c1-7dd4-4a3c-9350-779ec46c5125', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:04.817001000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.817001000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:04.817001000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 34392694-0421-46e3-a25f-04d79aa48581\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:04.818097', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '3128b5c1-7dd4-4a3c-9350-779ec46c5125', '2024-02-02 15:32:04.819053') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_4138"], ["updated_at", "2024-02-02 15:32:04.819895"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4a10387e-7c22-42de-9621-71bde8a2cebf', '"---\n:attributes:\n  id: 6\n  title: Good Job_4138\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:04.817001000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:04.817001000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:04.819895000 Z\n    zone: *1\n    time: 2024-02-02 15:32:04.819895000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_4138\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:04.817001000 Z\n  - *3\n"', '"---\n:correlation_id: 0e1f6ccd-919f-4a73-a246-a2188229283a\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:04.820904', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '4a10387e-7c22-42de-9621-71bde8a2cebf', '2024-02-02 15:32:04.821783') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "3128b5c1-7dd4-4a3c-9350-779ec46c5125"], ["event_id", "4a10387e-7c22-42de-9621-71bde8a2cebf"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:32:27.342911"], ["updated_at", "2024-02-02 15:32:27.342911"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:32:27.345110"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:32:27.346674"], ["updated_at", "2024-02-02 15:32:27.346674"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.434993"], ["updated_at", "2024-02-02 15:32:27.434993"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.436796"], ["updated_at", "2024-02-02 15:32:27.436796"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0bfc49b4-e3a1-4cad-9eb6-6d2dfe1b47b5', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:27.436796000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.436796000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:27.436796000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a6b1b127-ebaf-4934-a543-b27484f0e625\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:27.437995', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '0bfc49b4-e3a1-4cad-9eb6-6d2dfe1b47b5', '2024-02-02 15:32:27.441455') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.444365"], ["updated_at", "2024-02-02 15:32:27.444365"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('82548c08-d46f-4fc1-bef6-e3c301ab6925', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:27.444365000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.444365000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:27.444365000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 52c20018-4267-4374-a217-ee0a48cd4ebe\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:27.445480', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '82548c08-d46f-4fc1-bef6-e3c301ab6925', '2024-02-02 15:32:27.446491') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.1ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.448603"], ["updated_at", "2024-02-02 15:32:27.448603"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c34c45c9-04fa-4792-8f46-d2b3947a6cf5', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:27.448603000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.448603000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:27.448603000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5ba9b401-84dc-43c9-8a1d-0fdaceb52c92\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:27.449842', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'c34c45c9-04fa-4792-8f46-d2b3947a6cf5', '2024-02-02 15:32:27.450920') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.452032"], ["updated_at", "2024-02-02 15:32:27.452032"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('46e85dd3-abd8-4cbb-8a1f-ec5543e7cf83', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:27.452032000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.452032000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:27.452032000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6b5f109d-c32a-40a0-9f49-50c6f2965f00\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:27.453264', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '46e85dd3-abd8-4cbb-8a1f-ec5543e7cf83', '2024-02-02 15:32:27.457115') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_22971"], ["updated_at", "2024-02-02 15:32:27.458066"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0b2ef26d-fb68-4685-b225-c3105ecfc064', '"---\n:attributes:\n  id: 5\n  title: Good Job_22971\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:27.452032000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.452032000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:27.458066000 Z\n    zone: *1\n    time: 2024-02-02 15:32:27.458066000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_22971\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:27.452032000 Z\n  - *3\n"', '"---\n:correlation_id: ''03881eb1-c5af-47e6-9a64-d8ccbbf03b78''\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:27.459551', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '0b2ef26d-fb68-4685-b225-c3105ecfc064', '2024-02-02 15:32:27.460679') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "46e85dd3-abd8-4cbb-8a1f-ec5543e7cf83"], ["event_id", "0b2ef26d-fb68-4685-b225-c3105ecfc064"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:27.470838"], ["updated_at", "2024-02-02 15:32:27.470838"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('873dc4f8-c3e8-4419-b822-086f81f6499b', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:27.470838000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.470838000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:27.470838000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 7017e190-802c-44e6-aad2-21c47bea2961\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:27.472056', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '873dc4f8-c3e8-4419-b822-086f81f6499b', '2024-02-02 15:32:27.473133') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_71377"], ["updated_at", "2024-02-02 15:32:27.474018"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b1183b96-970c-40e0-b2f0-7a3845bd3ee0', '"---\n:attributes:\n  id: 6\n  title: Good Job_71377\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:27.470838000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:27.470838000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:27.474018000 Z\n    zone: *1\n    time: 2024-02-02 15:32:27.474018000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_71377\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:27.470838000 Z\n  - *3\n"', '"---\n:correlation_id: 7a2f3800-dc2a-4e7c-8340-3dc274bbb338\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:27.475039', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'b1183b96-970c-40e0-b2f0-7a3845bd3ee0', '2024-02-02 15:32:27.475953') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "873dc4f8-c3e8-4419-b822-086f81f6499b"], ["event_id", "b1183b96-970c-40e0-b2f0-7a3845bd3ee0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (43.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:32:57.979326"], ["updated_at", "2024-02-02 15:32:57.979326"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:32:57.981309"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:32:57.982838"], ["updated_at", "2024-02-02 15:32:57.982838"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.070999"], ["updated_at", "2024-02-02 15:32:58.070999"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.072710"], ["updated_at", "2024-02-02 15:32:58.072710"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8d0aa848-c124-455d-9fc7-08f839034355', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:58.072710000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.072710000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:58.072710000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fb8d5b1e-1867-4fd8-ab1b-f0ddea00c56d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:58.073862', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '8d0aa848-c124-455d-9fc7-08f839034355', '2024-02-02 15:32:58.077195') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:32:58.079856"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.081179"], ["updated_at", "2024-02-02 15:32:58.081179"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f2f0e7bf-0c43-4aba-a7a2-65d2c5b2af9b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:58.081179000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.081179000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:58.081179000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5e8b4361-a0df-4194-bcc1-d0bbabe8d2c2\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:58.082230', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f2f0e7bf-0c43-4aba-a7a2-65d2c5b2af9b', '2024-02-02 15:32:58.083206') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.085134"], ["updated_at", "2024-02-02 15:32:58.085134"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9531eea6-328a-4b9f-bb1b-b34e497c60f6', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:58.085134000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.085134000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:58.085134000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 140ddc14-d694-46b4-880c-969c87a9fe0f\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:58.086310', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '9531eea6-328a-4b9f-bb1b-b34e497c60f6', '2024-02-02 15:32:58.087361') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.088455"], ["updated_at", "2024-02-02 15:32:58.088455"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('41a63134-8625-4837-b48a-fc87a4096499', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:58.088455000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.088455000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:58.088455000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d587075f-c88f-403b-8a38-28f88d14660b\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:58.092171', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '41a63134-8625-4837-b48a-fc87a4096499', '2024-02-02 15:32:58.093176') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_35865"], ["updated_at", "2024-02-02 15:32:58.094414"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('05704a95-c8ea-4b4e-b587-4960fafe16df', '"---\n:attributes:\n  id: 5\n  title: Good Job_35865\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:58.088455000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.088455000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:58.094414000 Z\n    zone: *1\n    time: 2024-02-02 15:32:58.094414000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_35865\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:58.088455000 Z\n  - *3\n"', '"---\n:correlation_id: d1ba4f0c-753a-422f-8445-60ea9aedfc9b\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:58.095662', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '05704a95-c8ea-4b4e-b587-4960fafe16df', '2024-02-02 15:32:58.096557') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "41a63134-8625-4837-b48a-fc87a4096499"], ["event_id", "05704a95-c8ea-4b4e-b587-4960fafe16df"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:32:58.105559"], ["updated_at", "2024-02-02 15:32:58.105559"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6950b1af-fd38-453a-873d-c58e0a938247', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:32:58.105559000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.105559000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:32:58.105559000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0b3de5f2-e163-4059-9281-c9f77dde15bf\n"', 'EntityHistory::Events::Created', '2024-02-02 15:32:58.106738', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '6950b1af-fd38-453a-873d-c58e0a938247', '2024-02-02 15:32:58.107734') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_98991"], ["updated_at", "2024-02-02 15:32:58.108908"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9e9b7c4b-ca8a-4e44-bb81-827a62c1ddba', '"---\n:attributes:\n  id: 6\n  title: Good Job_98991\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:32:58.105559000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:32:58.105559000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:32:58.108908000 Z\n    zone: *1\n    time: 2024-02-02 15:32:58.108908000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_98991\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:32:58.105559000 Z\n  - *3\n"', '"---\n:correlation_id: a998d3b4-205c-4d8e-b36d-3f1a7745d31d\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:32:58.110201', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '9e9b7c4b-ca8a-4e44-bb81-827a62c1ddba', '2024-02-02 15:32:58.113497') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6950b1af-fd38-453a-873d-c58e0a938247"], ["event_id", "9e9b7c4b-ca8a-4e44-bb81-827a62c1ddba"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:33:29.180635"], ["updated_at", "2024-02-02 15:33:29.180635"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:33:29.182762"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:33:29.184376"], ["updated_at", "2024-02-02 15:33:29.184376"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.271497"], ["updated_at", "2024-02-02 15:33:29.271497"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.273193"], ["updated_at", "2024-02-02 15:33:29.273193"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ee0572a3-a613-46a0-865d-c846630479e0', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:33:29.273193000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.273193000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:33:29.273193000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 52485020-1a1f-4ff1-a0b2-aac5c18375b4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:33:29.274392', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'ee0572a3-a613-46a0-865d-c846630479e0', '2024-02-02 15:33:29.277862') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:33:29.280628"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.281990"], ["updated_at", "2024-02-02 15:33:29.281990"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3c9416ae-e406-432e-a752-7f6abeb708e1', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:33:29.281990000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.281990000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:33:29.281990000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 10ecfb8d-efa5-4433-b6fc-ea88aa951524\n"', 'EntityHistory::Events::Created', '2024-02-02 15:33:29.283097', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '3c9416ae-e406-432e-a752-7f6abeb708e1', '2024-02-02 15:33:29.284122') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.286425"], ["updated_at", "2024-02-02 15:33:29.286425"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('775ab126-b458-456b-8d4b-51b38be18df8', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:33:29.286425000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.286425000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:33:29.286425000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4d930a67-abba-4fee-bff4-efe2ae7ab8ba\n"', 'EntityHistory::Events::Created', '2024-02-02 15:33:29.287620', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '775ab126-b458-456b-8d4b-51b38be18df8', '2024-02-02 15:33:29.288696') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.289825"], ["updated_at", "2024-02-02 15:33:29.289825"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ff3c1797-7919-4a4c-8664-66e7ee8611ef', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:33:29.289825000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.289825000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:33:29.289825000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: aacf4f7a-0d35-4ba4-b242-87353e04c0f8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:33:29.293948', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'ff3c1797-7919-4a4c-8664-66e7ee8611ef', '2024-02-02 15:33:29.294990') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_96562"], ["updated_at", "2024-02-02 15:33:29.296257"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('339080aa-0f5e-4dcb-bc9a-6acecfe5f0a3', '"---\n:attributes:\n  id: 5\n  title: Good Job_96562\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:33:29.289825000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.289825000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:33:29.296257000 Z\n    zone: *1\n    time: 2024-02-02 15:33:29.296257000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_96562\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:33:29.289825000 Z\n  - *3\n"', '"---\n:correlation_id: 57f61358-bc79-4688-934f-a53ff9be62a3\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:33:29.297539', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '339080aa-0f5e-4dcb-bc9a-6acecfe5f0a3', '2024-02-02 15:33:29.298474') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ff3c1797-7919-4a4c-8664-66e7ee8611ef"], ["event_id", "339080aa-0f5e-4dcb-bc9a-6acecfe5f0a3"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:33:29.308200"], ["updated_at", "2024-02-02 15:33:29.308200"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('511bde04-2ae7-431c-9e16-2c67f682ca47', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:33:29.308200000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.308200000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:33:29.308200000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2583b113-5ae3-44b2-822c-a1d5e9ed8858\n"', 'EntityHistory::Events::Created', '2024-02-02 15:33:29.309449', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '511bde04-2ae7-431c-9e16-2c67f682ca47', '2024-02-02 15:33:29.310439') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_69453"], ["updated_at", "2024-02-02 15:33:29.311306"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7508734b-c62d-4e4e-9b86-f2fafbb9b877', '"---\n:attributes:\n  id: 6\n  title: Good Job_69453\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:33:29.308200000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:33:29.308200000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:33:29.311306000 Z\n    zone: *1\n    time: 2024-02-02 15:33:29.311306000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_69453\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:33:29.308200000 Z\n  - *3\n"', '"---\n:correlation_id: 2f63d8d3-adad-4c8f-ab7b-0ad850000f80\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:33:29.312403', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '7508734b-c62d-4e4e-9b86-f2fafbb9b877', '2024-02-02 15:33:29.315712') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "511bde04-2ae7-431c-9e16-2c67f682ca47"], ["event_id", "7508734b-c62d-4e4e-9b86-f2fafbb9b877"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (45.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (57.6ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:45:32.842469"], ["updated_at", "2024-02-02 15:45:32.842469"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:45:32.844878"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:45:32.846871"], ["updated_at", "2024-02-02 15:45:32.846871"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (44.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (50.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:45:48.181025"], ["updated_at", "2024-02-02 15:45:48.181025"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:45:48.183238"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:45:48.184863"], ["updated_at", "2024-02-02 15:45:48.184863"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:45:48.271604"], ["updated_at", "2024-02-02 15:45:48.271604"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:45:48.273524"], ["updated_at", "2024-02-02 15:45:48.273524"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4aaa2775-d7ed-4193-b31c-639a337051b0', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:45:48.273524000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:45:48.273524000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:45:48.273524000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b6098ec1-0dc6-4004-a185-36a9190de798\n"', 'EntityHistory::Events::Created', '2024-02-02 15:45:48.274787', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4aaa2775-d7ed-4193-b31c-639a337051b0', '2024-02-02 15:45:48.278475') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:45:48.281345"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:45:48.282768"], ["updated_at", "2024-02-02 15:45:48.282768"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('aa16a7ed-2784-4885-b035-20db281de7b9', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:45:48.282768000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:45:48.282768000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:45:48.282768000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 73228f44-7f0f-4318-a847-f01a010b3a25\n"', 'EntityHistory::Events::Created', '2024-02-02 15:45:48.283878', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'aa16a7ed-2784-4885-b035-20db281de7b9', '2024-02-02 15:45:48.284905') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:45:48.286842"], ["updated_at", "2024-02-02 15:45:48.286842"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6957658a-6f00-4d04-ad0b-7f9c80ce4e15', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:45:48.286842000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:45:48.286842000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:45:48.286842000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0a2b5fe2-5d93-4bb9-8cef-b0bdf0d58673\n"', 'EntityHistory::Events::Created', '2024-02-02 15:45:48.288078', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '6957658a-6f00-4d04-ad0b-7f9c80ce4e15', '2024-02-02 15:45:48.289217') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (45.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:47:40.283415"], ["updated_at", "2024-02-02 15:47:40.283415"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:47:40.286049"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:47:40.287817"], ["updated_at", "2024-02-02 15:47:40.287817"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.374159"], ["updated_at", "2024-02-02 15:47:40.374159"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.375927"], ["updated_at", "2024-02-02 15:47:40.375927"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8197daae-cca5-4e8f-8104-1565bed3203e', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:47:40.375927000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.375927000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:47:40.375927000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6bcafe5c-04e2-4953-a465-e0c742093a34\n"', 'EntityHistory::Events::Created', '2024-02-02 15:47:40.377199', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '8197daae-cca5-4e8f-8104-1565bed3203e', '2024-02-02 15:47:40.380693') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:47:40.383348"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.384687"], ["updated_at", "2024-02-02 15:47:40.384687"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e0052647-c592-41de-b358-99dc96c07536', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:47:40.384687000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.384687000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:47:40.384687000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 16bd34f6-47a0-40af-bb5b-ef41f530b9b1\n"', 'EntityHistory::Events::Created', '2024-02-02 15:47:40.385726', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'e0052647-c592-41de-b358-99dc96c07536', '2024-02-02 15:47:40.386692') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.389017"], ["updated_at", "2024-02-02 15:47:40.389017"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('253a5160-18b8-442e-b881-bfe63dcb7765', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:47:40.389017000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.389017000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:47:40.389017000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a12ad164-72df-4d29-8183-3bac081b41a4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:47:40.390249', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '253a5160-18b8-442e-b881-bfe63dcb7765', '2024-02-02 15:47:40.391324') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.395344"], ["updated_at", "2024-02-02 15:47:40.395344"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f994fe12-c78d-47bf-8af5-5960150af26a', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:47:40.395344000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.395344000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:47:40.395344000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fa79ac94-3adb-4fc9-aadd-d97f27288f68\n"', 'EntityHistory::Events::Created', '2024-02-02 15:47:40.396519', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'f994fe12-c78d-47bf-8af5-5960150af26a', '2024-02-02 15:47:40.397864') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_11162"], ["updated_at", "2024-02-02 15:47:40.398911"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3aada4f5-4352-483f-8cf7-95833922b2d4', '"---\n:attributes:\n  id: 5\n  title: Good Job_11162\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:47:40.395344000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.395344000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:47:40.398911000 Z\n    zone: *1\n    time: 2024-02-02 15:47:40.398911000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_11162\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:47:40.395344000 Z\n  - *3\n"', '"---\n:correlation_id: d483dbbb-32d6-4acd-9eea-5956b1b1e2f9\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:47:40.399956', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '3aada4f5-4352-483f-8cf7-95833922b2d4', '2024-02-02 15:47:40.400850') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f994fe12-c78d-47bf-8af5-5960150af26a"], ["event_id", "3aada4f5-4352-483f-8cf7-95833922b2d4"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:47:40.410041"], ["updated_at", "2024-02-02 15:47:40.410041"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f4121c0c-04a2-4425-a5f1-e7d59b79142d', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:47:40.410041000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.410041000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:47:40.410041000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 556201de-ef16-4042-a77a-9d260a47b3f8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:47:40.411162', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'f4121c0c-04a2-4425-a5f1-e7d59b79142d', '2024-02-02 15:47:40.412128') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_19528"], ["updated_at", "2024-02-02 15:47:40.412971"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('dd4dad81-0c67-4e99-ab54-eeedd928aad9', '"---\n:attributes:\n  id: 6\n  title: Good Job_19528\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:47:40.410041000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:47:40.410041000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:47:40.412971000 Z\n    zone: *1\n    time: 2024-02-02 15:47:40.412971000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_19528\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:47:40.410041000 Z\n  - *3\n"', '"---\n:correlation_id: 5fa7df86-5d11-4e5f-accd-cf12c5ecc189\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:47:40.416602', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'dd4dad81-0c67-4e99-ab54-eeedd928aad9', '2024-02-02 15:47:40.417566') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f4121c0c-04a2-4425-a5f1-e7d59b79142d"], ["event_id", "dd4dad81-0c67-4e99-ab54-eeedd928aad9"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:49:23.982626"], ["updated_at", "2024-02-02 15:49:23.982626"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:49:23.984591"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:49:23.986160"], ["updated_at", "2024-02-02 15:49:23.986160"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.071373"], ["updated_at", "2024-02-02 15:49:24.071373"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.073095"], ["updated_at", "2024-02-02 15:49:24.073095"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('81aa1a25-f6f7-4ea9-a18f-6b80f1cfa1dc', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:49:24.073095000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.073095000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:49:24.073095000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 406a8a51-b957-4bd1-a7b1-907c78cadf70\n"', 'EntityHistory::Events::Created', '2024-02-02 15:49:24.074343', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '81aa1a25-f6f7-4ea9-a18f-6b80f1cfa1dc', '2024-02-02 15:49:24.077669') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:49:24.080297"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.081585"], ["updated_at", "2024-02-02 15:49:24.081585"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('63c5fd51-798f-4cc9-bf99-3dcb90d4ff5c', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:49:24.081585000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.081585000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:49:24.081585000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9e3829b6-5c24-44cb-bc60-1eb7b23d48ca\n"', 'EntityHistory::Events::Created', '2024-02-02 15:49:24.082629', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '63c5fd51-798f-4cc9-bf99-3dcb90d4ff5c', '2024-02-02 15:49:24.083590') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.085489"], ["updated_at", "2024-02-02 15:49:24.085489"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7b285496-f8a8-4eda-9f9a-f928f2ede13d', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:49:24.085489000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.085489000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:49:24.085489000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: dc5f742f-0487-4120-ac68-9f5ad1207862\n"', 'EntityHistory::Events::Created', '2024-02-02 15:49:24.086663', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '7b285496-f8a8-4eda-9f9a-f928f2ede13d', '2024-02-02 15:49:24.087681') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.091243"], ["updated_at", "2024-02-02 15:49:24.091243"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('221634b1-98ea-43d0-84b9-b43ecd95c33d', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:49:24.091243000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.091243000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:49:24.091243000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1a21505f-4fc2-4d77-8831-a26415a7f448\n"', 'EntityHistory::Events::Created', '2024-02-02 15:49:24.095230', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '221634b1-98ea-43d0-84b9-b43ecd95c33d', '2024-02-02 15:49:24.096671') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_42368"], ["updated_at", "2024-02-02 15:49:24.097570"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('00f89c8a-7654-4557-ac3c-859bdaffc72a', '"---\n:attributes:\n  id: 5\n  title: Good Job_42368\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:49:24.091243000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.091243000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:49:24.097570000 Z\n    zone: *1\n    time: 2024-02-02 15:49:24.097570000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_42368\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:49:24.091243000 Z\n  - *3\n"', '"---\n:correlation_id: 67cf693f-ca61-4612-9341-51cdc85f24d8\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:49:24.098822', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '00f89c8a-7654-4557-ac3c-859bdaffc72a', '2024-02-02 15:49:24.099761') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "221634b1-98ea-43d0-84b9-b43ecd95c33d"], ["event_id", "00f89c8a-7654-4557-ac3c-859bdaffc72a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:49:24.109051"], ["updated_at", "2024-02-02 15:49:24.109051"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5083872b-1760-4bb2-b7f3-df01e7302d29', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:49:24.109051000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.109051000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:49:24.109051000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4091767d-113f-42d9-8611-ffe1bd0e7061\n"', 'EntityHistory::Events::Created', '2024-02-02 15:49:24.110169', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '5083872b-1760-4bb2-b7f3-df01e7302d29', '2024-02-02 15:49:24.111128') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_89861"], ["updated_at", "2024-02-02 15:49:24.111968"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1f5fa38b-ce6b-4f38-872f-81a7009b26b0', '"---\n:attributes:\n  id: 6\n  title: Good Job_89861\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:49:24.109051000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:49:24.109051000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:49:24.111968000 Z\n    zone: *1\n    time: 2024-02-02 15:49:24.111968000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_89861\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:49:24.109051000 Z\n  - *3\n"', '"---\n:correlation_id: ''030708a8-832c-4336-b116-4b356311b684''\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:49:24.112993', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '1f5fa38b-ce6b-4f38-872f-81a7009b26b0', '2024-02-02 15:49:24.116287') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5083872b-1760-4bb2-b7f3-df01e7302d29"], ["event_id", "1f5fa38b-ce6b-4f38-872f-81a7009b26b0"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:52:23.238619"], ["updated_at", "2024-02-02 15:52:23.238619"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:52:23.240723"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:52:23.242366"], ["updated_at", "2024-02-02 15:52:23.242366"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.328666"], ["updated_at", "2024-02-02 15:52:23.328666"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.330623"], ["updated_at", "2024-02-02 15:52:23.330623"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fc3484ff-38ee-400e-9d37-547dc87ea923', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:52:23.330623000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.330623000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:52:23.330623000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ceadaeb1-47df-4667-93c1-87d340cec348\n"', 'EntityHistory::Events::Created', '2024-02-02 15:52:23.331834', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fc3484ff-38ee-400e-9d37-547dc87ea923', '2024-02-02 15:52:23.335201') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:52:23.337890"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.339229"], ["updated_at", "2024-02-02 15:52:23.339229"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cdc6c2e5-6a3e-4501-a5e1-88bb1962dbb1', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:52:23.339229000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.339229000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:52:23.339229000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: da9acbad-d286-4914-bd4e-5816fd17b04c\n"', 'EntityHistory::Events::Created', '2024-02-02 15:52:23.340260', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'cdc6c2e5-6a3e-4501-a5e1-88bb1962dbb1', '2024-02-02 15:52:23.341225') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.343147"], ["updated_at", "2024-02-02 15:52:23.343147"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b244e5ec-9959-4620-9ecc-1868e9b5bd89', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:52:23.343147000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.343147000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:52:23.343147000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c9e9b45b-fc72-49db-b127-6be68e44db71\n"', 'EntityHistory::Events::Created', '2024-02-02 15:52:23.344362', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b244e5ec-9959-4620-9ecc-1868e9b5bd89', '2024-02-02 15:52:23.345463') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.349259"], ["updated_at", "2024-02-02 15:52:23.349259"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9fb8da7b-3236-4cfe-a278-ceba28fd7395', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:52:23.349259000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.349259000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:52:23.349259000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 57461420-e3a1-4574-bf95-22d20f1c15a4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:52:23.350445', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '9fb8da7b-3236-4cfe-a278-ceba28fd7395', '2024-02-02 15:52:23.351753') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_72094"], ["updated_at", "2024-02-02 15:52:23.352629"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3ebf4da9-13d7-4e28-8314-2d82535d39fd', '"---\n:attributes:\n  id: 5\n  title: Good Job_72094\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:52:23.349259000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.349259000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:52:23.352629000 Z\n    zone: *1\n    time: 2024-02-02 15:52:23.352629000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_72094\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:52:23.349259000 Z\n  - *3\n"', '"---\n:correlation_id: 62514b11-a85f-47cc-9257-aa2dde854e35\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:52:23.353850', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '3ebf4da9-13d7-4e28-8314-2d82535d39fd', '2024-02-02 15:52:23.354763') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "9fb8da7b-3236-4cfe-a278-ceba28fd7395"], ["event_id", "3ebf4da9-13d7-4e28-8314-2d82535d39fd"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:52:23.364079"], ["updated_at", "2024-02-02 15:52:23.364079"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4ea8bbfe-bc67-469d-8b6f-2ae3aacfddcb', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:52:23.364079000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.364079000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:52:23.364079000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 776f1983-f46d-470d-ab7e-60d4df3628f4\n"', 'EntityHistory::Events::Created', '2024-02-02 15:52:23.365179', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '4ea8bbfe-bc67-469d-8b6f-2ae3aacfddcb', '2024-02-02 15:52:23.366119') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_66194"], ["updated_at", "2024-02-02 15:52:23.366952"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('84c266cd-3b29-4faf-a67c-f46046a60e5a', '"---\n:attributes:\n  id: 6\n  title: Good Job_66194\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:52:23.364079000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:52:23.364079000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:52:23.366952000 Z\n    zone: *1\n    time: 2024-02-02 15:52:23.366952000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_66194\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:52:23.364079000 Z\n  - *3\n"', '"---\n:correlation_id: 39781455-171e-497c-bf10-16a40eb3f3c1\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:52:23.370495', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '84c266cd-3b29-4faf-a67c-f46046a60e5a', '2024-02-02 15:52:23.371666') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "4ea8bbfe-bc67-469d-8b6f-2ae3aacfddcb"], ["event_id", "84c266cd-3b29-4faf-a67c-f46046a60e5a"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:58:28.181596"], ["updated_at", "2024-02-02 15:58:28.181596"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:58:28.183855"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:58:28.185498"], ["updated_at", "2024-02-02 15:58:28.185498"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.276256"], ["updated_at", "2024-02-02 15:58:28.276256"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.277974"], ["updated_at", "2024-02-02 15:58:28.277974"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('841c2f12-a640-4427-9527-849535524e9b', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:58:28.277974000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.277974000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:58:28.277974000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 582cb2c6-05dc-4028-8974-0730f8dea189\n"', 'EntityHistory::Events::Created', '2024-02-02 15:58:28.279115', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '841c2f12-a640-4427-9527-849535524e9b', '2024-02-02 15:58:28.282471') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:58:28.284969"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.286231"], ["updated_at", "2024-02-02 15:58:28.286231"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('277f96e0-bb85-448e-b44e-1d898c7f130e', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:58:28.286231000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.286231000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:58:28.286231000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c023377e-6620-426d-b12f-605c090baf8d\n"', 'EntityHistory::Events::Created', '2024-02-02 15:58:28.287245', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '277f96e0-bb85-448e-b44e-1d898c7f130e', '2024-02-02 15:58:28.288202') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.289248"], ["updated_at", "2024-02-02 15:58:28.289248"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('51e8b4ae-d507-4b79-9f6d-bcb972f51488', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:58:28.289248000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.289248000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:58:28.289248000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2a1a03d3-c58e-408b-aca5-5e101e903dbe\n"', 'EntityHistory::Events::Created', '2024-02-02 15:58:28.290392', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '51e8b4ae-d507-4b79-9f6d-bcb972f51488', '2024-02-02 15:58:28.291428') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.292582"], ["updated_at", "2024-02-02 15:58:28.292582"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3666363c-9633-4262-9f56-ee9e1e4aa708', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:58:28.292582000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.292582000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:58:28.292582000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 58d9ed22-14cd-4ae5-b57e-5c6594294c7a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:58:28.296527', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '3666363c-9633-4262-9f56-ee9e1e4aa708', '2024-02-02 15:58:28.297563') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_99853"], ["updated_at", "2024-02-02 15:58:28.298914"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eb17b2f9-9cbb-4b1d-b1f6-ecccd1ff7dc1', '"---\n:attributes:\n  id: 5\n  title: Good Job_99853\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:58:28.292582000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.292582000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:58:28.298914000 Z\n    zone: *1\n    time: 2024-02-02 15:58:28.298914000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_99853\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:58:28.292582000 Z\n  - *3\n"', '"---\n:correlation_id: 963c51b8-fed3-4277-b47e-b0ec51eccfb4\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:58:28.299976', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'eb17b2f9-9cbb-4b1d-b1f6-ecccd1ff7dc1', '2024-02-02 15:58:28.301088') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "3666363c-9633-4262-9f56-ee9e1e4aa708"], ["event_id", "eb17b2f9-9cbb-4b1d-b1f6-ecccd1ff7dc1"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:58:28.312118"], ["updated_at", "2024-02-02 15:58:28.312118"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cb6ac238-cc53-4d48-8c06-e39f915bd987', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:58:28.312118000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.312118000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:58:28.312118000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: df873ead-d17c-4690-aa6a-ca1970307651\n"', 'EntityHistory::Events::Created', '2024-02-02 15:58:28.313480', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'cb6ac238-cc53-4d48-8c06-e39f915bd987', '2024-02-02 15:58:28.314510') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_18523"], ["updated_at", "2024-02-02 15:58:28.315371"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4796471d-fa25-4cf6-ae38-74c90f0bf872', '"---\n:attributes:\n  id: 6\n  title: Good Job_18523\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:58:28.312118000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:58:28.312118000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:58:28.315371000 Z\n    zone: *1\n    time: 2024-02-02 15:58:28.315371000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_18523\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:58:28.312118000 Z\n  - *3\n"', '"---\n:correlation_id: 49575fcc-8ccd-4618-8316-8110c766efed\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:58:28.316394', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '4796471d-fa25-4cf6-ae38-74c90f0bf872', '2024-02-02 15:58:28.319775') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "cb6ac238-cc53-4d48-8c06-e39f915bd987"], ["event_id", "4796471d-fa25-4cf6-ae38-74c90f0bf872"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.9ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:59:23.311130"], ["updated_at", "2024-02-02 15:59:23.311130"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:59:23.313287"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:59:23.314805"], ["updated_at", "2024-02-02 15:59:23.314805"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.391419"], ["updated_at", "2024-02-02 15:59:23.391419"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.393219"], ["updated_at", "2024-02-02 15:59:23.393219"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('325e0f0b-ab56-4d44-ad1f-247f7edfa03f', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:23.393219000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.393219000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:23.393219000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d1938718-b46c-4189-9820-dca9075ab6bb\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:23.394447', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '325e0f0b-ab56-4d44-ad1f-247f7edfa03f', '2024-02-02 15:59:23.397930') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:59:23.400635"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.402000"], ["updated_at", "2024-02-02 15:59:23.402000"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('81d94620-3a12-4674-9ff6-4b72f049a7c5', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:23.402000000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.402000000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:23.402000000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 36857c06-fe6a-470b-8da5-dbe7770068f9\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:23.403089', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '81d94620-3a12-4674-9ff6-4b72f049a7c5', '2024-02-02 15:59:23.404095') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.405166"], ["updated_at", "2024-02-02 15:59:23.405166"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cdfefad5-a557-44a4-87f0-bfa09086775c', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:23.405166000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.405166000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:23.405166000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 90c37c65-4e9e-4c7c-82d1-5c161769f52e\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:23.406360', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'cdfefad5-a557-44a4-87f0-bfa09086775c', '2024-02-02 15:59:23.407496') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.409200"], ["updated_at", "2024-02-02 15:59:23.409200"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e894760e-f6af-4fe0-ac92-5c713a1843db', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:23.409200000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.409200000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:23.409200000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 41a4652f-9739-40e8-9027-e0254ca26011\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:23.413256', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'e894760e-f6af-4fe0-ac92-5c713a1843db', '2024-02-02 15:59:23.414305') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_94894"], ["updated_at", "2024-02-02 15:59:23.415537"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ab981458-7501-47b0-b969-4d9daccea01d', '"---\n:attributes:\n  id: 5\n  title: Good Job_94894\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:59:23.409200000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.409200000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:59:23.415537000 Z\n    zone: *1\n    time: 2024-02-02 15:59:23.415537000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_94894\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:59:23.409200000 Z\n  - *3\n"', '"---\n:correlation_id: 4e3e471e-dba5-4451-81cd-66576b1f5744\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:59:23.416635', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'ab981458-7501-47b0-b969-4d9daccea01d', '2024-02-02 15:59:23.417780') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e894760e-f6af-4fe0-ac92-5c713a1843db"], ["event_id", "ab981458-7501-47b0-b969-4d9daccea01d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:23.427579"], ["updated_at", "2024-02-02 15:59:23.427579"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eb65379b-e4cc-4152-9f7f-5028661e933f', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:23.427579000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.427579000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:23.427579000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cf9e0c35-e9aa-4850-b06c-83ef3e4028c8\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:23.428765', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'eb65379b-e4cc-4152-9f7f-5028661e933f', '2024-02-02 15:59:23.429748') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_70640"], ["updated_at", "2024-02-02 15:59:23.430601"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cac60cbc-226a-41ee-a51d-3523ee5cf490', '"---\n:attributes:\n  id: 6\n  title: Good Job_70640\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:59:23.427579000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:23.427579000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:59:23.430601000 Z\n    zone: *1\n    time: 2024-02-02 15:59:23.430601000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_70640\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:59:23.427579000 Z\n  - *3\n"', '"---\n:correlation_id: 97cd45aa-71b8-4a43-bd3b-0c1be38717e2\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:59:23.431643', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'cac60cbc-226a-41ee-a51d-3523ee5cf490', '2024-02-02 15:59:23.432532') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "eb65379b-e4cc-4152-9f7f-5028661e933f"], ["event_id", "cac60cbc-226a-41ee-a51d-3523ee5cf490"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 15:59:33.731704"], ["updated_at", "2024-02-02 15:59:33.731704"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 15:59:33.733695"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 15:59:33.735225"], ["updated_at", "2024-02-02 15:59:33.735225"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.818321"], ["updated_at", "2024-02-02 15:59:33.818321"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.820095"], ["updated_at", "2024-02-02 15:59:33.820095"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7ca4bc82-bb2a-445e-b437-637d6a5cc307', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:33.820095000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.820095000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:33.820095000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8ca86e04-119a-4792-93a9-02677e1bf4eb\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:33.821319', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7ca4bc82-bb2a-445e-b437-637d6a5cc307', '2024-02-02 15:59:33.824847') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 15:59:33.827572"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.828914"], ["updated_at", "2024-02-02 15:59:33.828914"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5b2eed47-ca27-459e-9a0c-0ab9f91f38b1', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:33.828914000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.828914000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:33.828914000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1fa1473d-755b-495b-9916-6f06ec58ddaa\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:33.830000', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '5b2eed47-ca27-459e-9a0c-0ab9f91f38b1', '2024-02-02 15:59:33.831017') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.832085"], ["updated_at", "2024-02-02 15:59:33.832085"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7fe957a4-6e6b-4ef9-9868-c176f117b705', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:33.832085000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.832085000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:33.832085000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 378b526e-990f-4857-9812-8f24e5d460a6\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:33.833680', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '7fe957a4-6e6b-4ef9-9868-c176f117b705', '2024-02-02 15:59:33.834761') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.835911"], ["updated_at", "2024-02-02 15:59:33.835911"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2b6e01b2-41b1-47ed-b562-9114aa83aab8', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:33.835911000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.835911000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:33.835911000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8190b7fd-3ce9-431a-b952-da317c1d9e85\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:33.837157', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '2b6e01b2-41b1-47ed-b562-9114aa83aab8', '2024-02-02 15:59:33.840971') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_76355"], ["updated_at", "2024-02-02 15:59:33.841927"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9b6cbef2-a122-436b-bb0b-27221c357fe1', '"---\n:attributes:\n  id: 5\n  title: Good Job_76355\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:59:33.835911000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.835911000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:59:33.841927000 Z\n    zone: *1\n    time: 2024-02-02 15:59:33.841927000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_76355\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:59:33.835911000 Z\n  - *3\n"', '"---\n:correlation_id: e71d8b13-1501-4652-b092-bd3db70b60d6\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:59:33.843348', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '9b6cbef2-a122-436b-bb0b-27221c357fe1', '2024-02-02 15:59:33.844486') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "2b6e01b2-41b1-47ed-b562-9114aa83aab8"], ["event_id", "9b6cbef2-a122-436b-bb0b-27221c357fe1"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 15:59:33.853661"], ["updated_at", "2024-02-02 15:59:33.853661"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('25b04f30-88db-487e-b639-17fc9d467d19', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 15:59:33.853661000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.853661000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 15:59:33.853661000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a5e45ffb-5275-4011-9143-e9efb6960f7a\n"', 'EntityHistory::Events::Created', '2024-02-02 15:59:33.854768', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '25b04f30-88db-487e-b639-17fc9d467d19', '2024-02-02 15:59:33.855708') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.0ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_72657"], ["updated_at", "2024-02-02 15:59:33.856541"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3e44c9bd-74a9-455d-95d3-0f0fc3096dbc', '"---\n:attributes:\n  id: 6\n  title: Good Job_72657\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 15:59:33.853661000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 15:59:33.853661000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 15:59:33.856541000 Z\n    zone: *1\n    time: 2024-02-02 15:59:33.856541000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_72657\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 15:59:33.853661000 Z\n  - *3\n"', '"---\n:correlation_id: 40fe4294-0ca5-492e-8bfa-88d2b47414b4\n"', 'EntityHistory::Events::Updated', '2024-02-02 15:59:33.857538', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '3e44c9bd-74a9-455d-95d3-0f0fc3096dbc', '2024-02-02 15:59:33.858458') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.2ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "25b04f30-88db-487e-b639-17fc9d467d19"], ["event_id", "3e44c9bd-74a9-455d-95d3-0f0fc3096dbc"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:01:19.408318"], ["updated_at", "2024-02-02 16:01:19.408318"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:01:19.410529"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:01:19.412184"], ["updated_at", "2024-02-02 16:01:19.412184"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.493929"], ["updated_at", "2024-02-02 16:01:19.493929"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.495765"], ["updated_at", "2024-02-02 16:01:19.495765"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2df728be-fab4-4e57-8bbc-2dc6fdd96a9a', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:19.495765000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.495765000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:19.495765000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e215ebb3-7c6e-4efe-8b7b-4d22adb1a4d4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:19.496970', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '2df728be-fab4-4e57-8bbc-2dc6fdd96a9a', '2024-02-02 16:01:19.500339') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:01:19.503100"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.504434"], ["updated_at", "2024-02-02 16:01:19.504434"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1494fdf9-61c9-48b2-9c03-bf3ea8cdf547', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:19.504434000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.504434000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:19.504434000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 574b9afb-2b74-4a31-b0f0-fd67938fd7a1\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:19.505515', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1494fdf9-61c9-48b2-9c03-bf3ea8cdf547', '2024-02-02 16:01:19.506519') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.507770"], ["updated_at", "2024-02-02 16:01:19.507770"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b6edd1e9-87ab-4cc4-b91f-d12d972c8171', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:19.507770000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.507770000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:19.507770000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: cfa01a4a-ed38-458f-b63d-17af288f4140\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:19.509035', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b6edd1e9-87ab-4cc4-b91f-d12d972c8171', '2024-02-02 16:01:19.510111') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.511318"], ["updated_at", "2024-02-02 16:01:19.511318"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a712bafd-2621-46da-88a3-b239411d33bc', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:19.511318000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.511318000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:19.511318000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bc83ccc0-44bc-4265-83e6-8b6e5025e279\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:19.515373', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'a712bafd-2621-46da-88a3-b239411d33bc', '2024-02-02 16:01:19.516420') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_33560"], ["updated_at", "2024-02-02 16:01:19.517642"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('99493ea4-6e4f-4cf6-aa32-c9dd380dff6e', '"---\n:attributes:\n  id: 5\n  title: Good Job_33560\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:19.511318000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.511318000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:19.517642000 Z\n    zone: *1\n    time: 2024-02-02 16:01:19.517642000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_33560\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:19.511318000 Z\n  - *3\n"', '"---\n:correlation_id: 1d5c684a-bcdc-43a3-ae84-5e96775962fe\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:19.518742', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '99493ea4-6e4f-4cf6-aa32-c9dd380dff6e', '2024-02-02 16:01:19.519853') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "a712bafd-2621-46da-88a3-b239411d33bc"], ["event_id", "99493ea4-6e4f-4cf6-aa32-c9dd380dff6e"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:19.529605"], ["updated_at", "2024-02-02 16:01:19.529605"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5ebd2d48-d521-43d2-9d87-6dbd001fc4e3', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:19.529605000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.529605000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:19.529605000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d5b7766a-f785-435d-95fb-fc307c3637a5\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:19.530821', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '5ebd2d48-d521-43d2-9d87-6dbd001fc4e3', '2024-02-02 16:01:19.531811') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_53151"], ["updated_at", "2024-02-02 16:01:19.532681"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d082a9ee-ff57-4cef-a398-1ae66cb0a6c2', '"---\n:attributes:\n  id: 6\n  title: Good Job_53151\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:19.529605000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:19.529605000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:19.532681000 Z\n    zone: *1\n    time: 2024-02-02 16:01:19.532681000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_53151\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:19.529605000 Z\n  - *3\n"', '"---\n:correlation_id: c1cdba91-c7e7-4d3b-a661-dc178ef0e1dd\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:19.533701', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.0ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'd082a9ee-ff57-4cef-a398-1ae66cb0a6c2', '2024-02-02 16:01:19.534570') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "5ebd2d48-d521-43d2-9d87-6dbd001fc4e3"], ["event_id", "d082a9ee-ff57-4cef-a398-1ae66cb0a6c2"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:01:35.142107"], ["updated_at", "2024-02-02 16:01:35.142107"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:01:35.144289"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:01:35.145939"], ["updated_at", "2024-02-02 16:01:35.145939"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.230062"], ["updated_at", "2024-02-02 16:01:35.230062"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.231842"], ["updated_at", "2024-02-02 16:01:35.231842"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('855d1270-7753-4210-b0a3-4ec57d997107', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:35.231842000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.231842000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:35.231842000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 67c20189-edf8-49ba-86a7-36a8e125c8ff\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:35.233062', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '855d1270-7753-4210-b0a3-4ec57d997107', '2024-02-02 16:01:35.236647') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:01:35.239411"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.240771"], ["updated_at", "2024-02-02 16:01:35.240771"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('69f5c07b-e2eb-47d5-9497-90bc4fb92c09', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:35.240771000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.240771000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:35.240771000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b4dde254-2cd8-44d3-92aa-93eb074880bc\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:35.241859', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '69f5c07b-e2eb-47d5-9497-90bc4fb92c09', '2024-02-02 16:01:35.242826') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.243882"], ["updated_at", "2024-02-02 16:01:35.243882"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ea3e5b76-e3a7-4cb2-bc98-bf0261591329', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:35.243882000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.243882000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:35.243882000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3c6e30d7-7669-4b53-bcd8-b8d995cb5dc9\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:35.245091', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'ea3e5b76-e3a7-4cb2-bc98-bf0261591329', '2024-02-02 16:01:35.246175') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.247327"], ["updated_at", "2024-02-02 16:01:35.247327"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('bca5ba97-6f87-4d58-9753-bc5808c90d0e', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:35.247327000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.247327000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:35.247327000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4fabfc96-2553-4fae-b222-0204129dd2a0\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:35.251209', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'bca5ba97-6f87-4d58-9753-bc5808c90d0e', '2024-02-02 16:01:35.252249') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_59138"], ["updated_at", "2024-02-02 16:01:35.253620"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('65fcc425-8c21-41f9-9e53-6f1e2114c240', '"---\n:attributes:\n  id: 5\n  title: Good Job_59138\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:35.247327000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.247327000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:35.253620000 Z\n    zone: *1\n    time: 2024-02-02 16:01:35.253620000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_59138\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:35.247327000 Z\n  - *3\n"', '"---\n:correlation_id: d6e5f39a-0244-4f61-b295-7ef3e1149192\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:35.254711', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '65fcc425-8c21-41f9-9e53-6f1e2114c240', '2024-02-02 16:01:35.255813') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "bca5ba97-6f87-4d58-9753-bc5808c90d0e"], ["event_id", "65fcc425-8c21-41f9-9e53-6f1e2114c240"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:35.265645"], ["updated_at", "2024-02-02 16:01:35.265645"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f3444f4c-c285-4f55-b0b1-91aafc0f9601', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:35.265645000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.265645000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:35.265645000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3c407238-367a-44d2-8072-5b2516557249\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:35.266824', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'f3444f4c-c285-4f55-b0b1-91aafc0f9601', '2024-02-02 16:01:35.267815') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_31621"], ["updated_at", "2024-02-02 16:01:35.268659"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4186b01e-7b38-4e48-9fa9-2cc3bc36b61b', '"---\n:attributes:\n  id: 6\n  title: Good Job_31621\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:35.265645000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:35.265645000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:35.268659000 Z\n    zone: *1\n    time: 2024-02-02 16:01:35.268659000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_31621\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:35.265645000 Z\n  - *3\n"', '"---\n:correlation_id: dbd35a55-b2ea-465c-acc1-0dca553aa516\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:35.269712', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '4186b01e-7b38-4e48-9fa9-2cc3bc36b61b', '2024-02-02 16:01:35.273101') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f3444f4c-c285-4f55-b0b1-91aafc0f9601"], ["event_id", "4186b01e-7b38-4e48-9fa9-2cc3bc36b61b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:01:48.998930"], ["updated_at", "2024-02-02 16:01:48.998930"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:01:49.001109"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:01:49.002718"], ["updated_at", "2024-02-02 16:01:49.002718"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.086406"], ["updated_at", "2024-02-02 16:01:49.086406"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.088215"], ["updated_at", "2024-02-02 16:01:49.088215"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6a201f0e-0d86-486c-b01f-ddc1351373c2', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:49.088215000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.088215000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:49.088215000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4da7b2e5-5386-495c-a051-6a70c8bad085\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:49.089402', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '6a201f0e-0d86-486c-b01f-ddc1351373c2', '2024-02-02 16:01:49.092813') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:01:49.095459"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.096799"], ["updated_at", "2024-02-02 16:01:49.096799"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0d7bf819-4a98-4205-9637-64ff36e0c8c7', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:49.096799000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.096799000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:49.096799000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 13a0e0c1-4032-46c3-a956-33e454f724ca\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:49.097885', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '0d7bf819-4a98-4205-9637-64ff36e0c8c7', '2024-02-02 16:01:49.098848') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.099881"], ["updated_at", "2024-02-02 16:01:49.099881"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f682d95c-1ba5-4916-9000-67e179ac9365', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:49.099881000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.099881000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:49.099881000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8b39f37f-55ef-4558-8ec0-aed81715ee28\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:49.101096', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'f682d95c-1ba5-4916-9000-67e179ac9365', '2024-02-02 16:01:49.102187') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.103367"], ["updated_at", "2024-02-02 16:01:49.103367"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('177fc7f7-a9c8-433d-9521-c3b54471f14f', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:49.103367000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.103367000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:49.103367000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a2a3bb5d-73d3-4fa7-8beb-d04cfb972e8e\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:49.104579', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '177fc7f7-a9c8-433d-9521-c3b54471f14f', '2024-02-02 16:01:49.108313') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_10769"], ["updated_at", "2024-02-02 16:01:49.109234"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('146a870c-578c-4f8f-bcf8-3b932a081b5b', '"---\n:attributes:\n  id: 5\n  title: Good Job_10769\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:49.103367000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.103367000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:49.109234000 Z\n    zone: *1\n    time: 2024-02-02 16:01:49.109234000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_10769\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:49.103367000 Z\n  - *3\n"', '"---\n:correlation_id: 7c3db150-4070-484e-a982-fef096cc34fa\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:49.110677', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '146a870c-578c-4f8f-bcf8-3b932a081b5b', '2024-02-02 16:01:49.111808') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "177fc7f7-a9c8-433d-9521-c3b54471f14f"], ["event_id", "146a870c-578c-4f8f-bcf8-3b932a081b5b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:49.120791"], ["updated_at", "2024-02-02 16:01:49.120791"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('af313be0-fb88-4053-b70a-ae662208ef9f', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:49.120791000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.120791000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:49.120791000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ''0405875b-805a-4957-91b0-d858e02f64f5''\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:49.121893', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'af313be0-fb88-4053-b70a-ae662208ef9f', '2024-02-02 16:01:49.122865') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_73970"], ["updated_at", "2024-02-02 16:01:49.123683"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9e9ea018-a049-42d6-bd54-74086c39b0e7', '"---\n:attributes:\n  id: 6\n  title: Good Job_73970\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:49.120791000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:49.120791000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:49.123683000 Z\n    zone: *1\n    time: 2024-02-02 16:01:49.123683000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_73970\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:49.120791000 Z\n  - *3\n"', '"---\n:correlation_id: 67485eb2-faaf-4999-bc09-1469c51b1349\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:49.124684', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '9e9ea018-a049-42d6-bd54-74086c39b0e7', '2024-02-02 16:01:49.125628') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "af313be0-fb88-4053-b70a-ae662208ef9f"], ["event_id", "9e9ea018-a049-42d6-bd54-74086c39b0e7"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.9ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:01:59.130898"], ["updated_at", "2024-02-02 16:01:59.130898"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:01:59.132988"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:01:59.134518"], ["updated_at", "2024-02-02 16:01:59.134518"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.216732"], ["updated_at", "2024-02-02 16:01:59.216732"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.218522"], ["updated_at", "2024-02-02 16:01:59.218522"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f3e3dcbb-e2f2-461c-b08c-400d7fd85cc8', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:59.218522000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.218522000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:59.218522000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3eea582e-39ea-449f-b380-c8fa81d916bc\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:59.219786', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f3e3dcbb-e2f2-461c-b08c-400d7fd85cc8', '2024-02-02 16:01:59.223241') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:01:59.226379"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.227743"], ["updated_at", "2024-02-02 16:01:59.227743"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8040772c-10b1-498d-b6ac-6988eb06c88c', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:59.227743000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.227743000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:59.227743000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 88f50c95-d5ba-407f-b5c5-a64c90fe9710\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:59.228809', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '8040772c-10b1-498d-b6ac-6988eb06c88c', '2024-02-02 16:01:59.229773') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.230838"], ["updated_at", "2024-02-02 16:01:59.230838"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('61aa5c61-72e7-4cf4-9a38-2ddbe156bb1b', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:59.230838000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.230838000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:59.230838000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 94721a13-5681-41a8-905f-cb5ce1f54df1\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:59.232039', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '61aa5c61-72e7-4cf4-9a38-2ddbe156bb1b', '2024-02-02 16:01:59.233094') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.234286"], ["updated_at", "2024-02-02 16:01:59.234286"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('23b490e7-de68-4050-8e5d-f68577c0bd31', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:59.234286000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.234286000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:59.234286000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a04dad34-7a37-48fe-b959-55aeab456b42\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:59.238152', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '23b490e7-de68-4050-8e5d-f68577c0bd31', '2024-02-02 16:01:59.239197') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_50637"], ["updated_at", "2024-02-02 16:01:59.240442"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3bf4cfd8-7350-4315-a018-cea932f3be56', '"---\n:attributes:\n  id: 5\n  title: Good Job_50637\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:59.234286000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.234286000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:59.240442000 Z\n    zone: *1\n    time: 2024-02-02 16:01:59.240442000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_50637\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:59.234286000 Z\n  - *3\n"', '"---\n:correlation_id: c20a3ffe-d657-4ab3-93d9-2c0e63b04438\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:59.241623', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '3bf4cfd8-7350-4315-a018-cea932f3be56', '2024-02-02 16:01:59.242862') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "23b490e7-de68-4050-8e5d-f68577c0bd31"], ["event_id", "3bf4cfd8-7350-4315-a018-cea932f3be56"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:01:59.251962"], ["updated_at", "2024-02-02 16:01:59.251962"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d7e635bc-2880-4c7d-8e86-c716c007b237', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:01:59.251962000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.251962000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:01:59.251962000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 185e77da-3bd6-4001-bd1b-f1726da19ed3\n"', 'EntityHistory::Events::Created', '2024-02-02 16:01:59.253061', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'd7e635bc-2880-4c7d-8e86-c716c007b237', '2024-02-02 16:01:59.254006') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_2784"], ["updated_at", "2024-02-02 16:01:59.254870"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9322dd48-2b18-4ce6-99fc-829730badcf7', '"---\n:attributes:\n  id: 6\n  title: Good Job_2784\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:01:59.251962000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:01:59.251962000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:01:59.254870000 Z\n    zone: *1\n    time: 2024-02-02 16:01:59.254870000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_2784\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:01:59.251962000 Z\n  - *3\n"', '"---\n:correlation_id: 1e7ceb99-805e-4ce1-8c8b-a9ec5689091d\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:01:59.255915', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '9322dd48-2b18-4ce6-99fc-829730badcf7', '2024-02-02 16:01:59.259130') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d7e635bc-2880-4c7d-8e86-c716c007b237"], ["event_id", "9322dd48-2b18-4ce6-99fc-829730badcf7"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.4ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:02:15.153530"], ["updated_at", "2024-02-02 16:02:15.153530"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:02:15.155995"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:02:15.157706"], ["updated_at", "2024-02-02 16:02:15.157706"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.248561"], ["updated_at", "2024-02-02 16:02:15.248561"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.250315"], ["updated_at", "2024-02-02 16:02:15.250315"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f66e3f3b-0c5c-410b-848e-5e2b5188f1b2', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:02:15.250315000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.250315000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:02:15.250315000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6ced7df0-df7e-4473-8250-6d61f8c9b25d\n"', 'EntityHistory::Events::Created', '2024-02-02 16:02:15.251509', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f66e3f3b-0c5c-410b-848e-5e2b5188f1b2', '2024-02-02 16:02:15.255239') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:02:15.258020"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.259423"], ["updated_at", "2024-02-02 16:02:15.259423"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c071606a-79b9-48fc-a028-ff203100a435', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:02:15.259423000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.259423000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:02:15.259423000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b6aa5d6c-e95b-4c9e-848c-9a5f42d516cf\n"', 'EntityHistory::Events::Created', '2024-02-02 16:02:15.260517', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'c071606a-79b9-48fc-a028-ff203100a435', '2024-02-02 16:02:15.261501') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.263448"], ["updated_at", "2024-02-02 16:02:15.263448"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('04765188-e39b-414f-82d9-d9f88f47c852', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:02:15.263448000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.263448000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:02:15.263448000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e27c78c3-66d9-4936-8f18-c8e946cd3ea3\n"', 'EntityHistory::Events::Created', '2024-02-02 16:02:15.264663', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '04765188-e39b-414f-82d9-d9f88f47c852', '2024-02-02 16:02:15.265844') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.267053"], ["updated_at", "2024-02-02 16:02:15.267053"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d9281a28-1863-4f3a-bbab-a002a0416731', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:02:15.267053000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.267053000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:02:15.267053000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 11b22c1f-47e0-4041-bba7-d2f768f897a0\n"', 'EntityHistory::Events::Created', '2024-02-02 16:02:15.271040', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'd9281a28-1863-4f3a-bbab-a002a0416731', '2024-02-02 16:02:15.272445') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_99333"], ["updated_at", "2024-02-02 16:02:15.273340"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('66f37f56-f3e4-45d6-8793-b3d4a74afaa5', '"---\n:attributes:\n  id: 5\n  title: Good Job_99333\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:02:15.267053000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.267053000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:02:15.273340000 Z\n    zone: *1\n    time: 2024-02-02 16:02:15.273340000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_99333\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:02:15.267053000 Z\n  - *3\n"', '"---\n:correlation_id: bebfd4f5-a735-43b0-ace8-5edc4d61ab04\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:02:15.274622', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '66f37f56-f3e4-45d6-8793-b3d4a74afaa5', '2024-02-02 16:02:15.275538') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d9281a28-1863-4f3a-bbab-a002a0416731"], ["event_id", "66f37f56-f3e4-45d6-8793-b3d4a74afaa5"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:02:15.285242"], ["updated_at", "2024-02-02 16:02:15.285242"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('426ba66a-e835-488b-949c-15ac49837e74', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:02:15.285242000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.285242000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:02:15.285242000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e2ff9e16-e4fc-42ac-bd42-a88d1bb43180\n"', 'EntityHistory::Events::Created', '2024-02-02 16:02:15.286377', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '426ba66a-e835-488b-949c-15ac49837e74', '2024-02-02 16:02:15.287327') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.0ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_72474"], ["updated_at", "2024-02-02 16:02:15.288169"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('48279f81-a47a-48fd-a167-6ccaa3359d85', '"---\n:attributes:\n  id: 6\n  title: Good Job_72474\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:02:15.285242000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:02:15.285242000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:02:15.288169000 Z\n    zone: *1\n    time: 2024-02-02 16:02:15.288169000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_72474\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:02:15.285242000 Z\n  - *3\n"', '"---\n:correlation_id: b646cdc5-ed24-4b54-9d08-2818dd00c218\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:02:15.289203', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '48279f81-a47a-48fd-a167-6ccaa3359d85', '2024-02-02 16:02:15.292510') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "426ba66a-e835-488b-949c-15ac49837e74"], ["event_id", "48279f81-a47a-48fd-a167-6ccaa3359d85"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:03:19.250557"], ["updated_at", "2024-02-02 16:03:19.250557"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:03:19.254224"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:03:19.256055"], ["updated_at", "2024-02-02 16:03:19.256055"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.324520"], ["updated_at", "2024-02-02 16:03:19.324520"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.326451"], ["updated_at", "2024-02-02 16:03:19.326451"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('fbe56e6a-9767-447e-b2ac-af3e64d8c234', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:19.326451000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.326451000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:19.326451000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9577b892-93d9-4f58-8c0b-816504d69db4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:19.327731', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'fbe56e6a-9767-447e-b2ac-af3e64d8c234', '2024-02-02 16:03:19.331412') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:03:19.334328"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.335762"], ["updated_at", "2024-02-02 16:03:19.335762"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('1d3f942c-0ca8-4ef0-beb7-18fff0ab8749', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:19.335762000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.335762000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:19.335762000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 38ced3e1-855d-4bc0-bb5c-90fd1e2a14b1\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:19.336902', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '1d3f942c-0ca8-4ef0-beb7-18fff0ab8749', '2024-02-02 16:03:19.337973') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.340036"], ["updated_at", "2024-02-02 16:03:19.340036"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cc766189-f550-48db-b70f-3ee38aa941dc', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:19.340036000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.340036000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:19.340036000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d3cc3ba2-126e-4667-bcf4-7d31fd61f7e9\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:19.341296', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'cc766189-f550-48db-b70f-3ee38aa941dc', '2024-02-02 16:03:19.342445') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.343678"], ["updated_at", "2024-02-02 16:03:19.343678"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ac261995-d7a1-49cc-9201-8b4379d41d17', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:19.343678000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.343678000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:19.343678000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 593d5df5-9842-4a8b-a800-fb1a4ed0743d\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:19.347848', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'ac261995-d7a1-49cc-9201-8b4379d41d17', '2024-02-02 16:03:19.349282') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_53338"], ["updated_at", "2024-02-02 16:03:19.350236"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0a48911e-5bb6-4b41-931e-e22fbdd49ccc', '"---\n:attributes:\n  id: 5\n  title: Good Job_53338\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:19.343678000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.343678000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:19.350236000 Z\n    zone: *1\n    time: 2024-02-02 16:03:19.350236000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_53338\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:19.343678000 Z\n  - *3\n"', '"---\n:correlation_id: 85293cd8-b101-4e32-a0c1-abd8389c1e71\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:19.351486', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '0a48911e-5bb6-4b41-931e-e22fbdd49ccc', '2024-02-02 16:03:19.352417') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ac261995-d7a1-49cc-9201-8b4379d41d17"], ["event_id", "0a48911e-5bb6-4b41-931e-e22fbdd49ccc"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:19.362629"], ["updated_at", "2024-02-02 16:03:19.362629"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('48eec820-9ee9-4c8d-a1d6-78617a1dcfb2', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:19.362629000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.362629000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:19.362629000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6b47ab8e-1454-4df8-99c7-425679aa9f6e\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:19.363997', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '48eec820-9ee9-4c8d-a1d6-78617a1dcfb2', '2024-02-02 16:03:19.365015') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_77351"], ["updated_at", "2024-02-02 16:03:19.365890"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f1621e37-8002-4a36-bbf9-5d5b16dad57d', '"---\n:attributes:\n  id: 6\n  title: Good Job_77351\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:19.362629000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:19.362629000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:19.365890000 Z\n    zone: *1\n    time: 2024-02-02 16:03:19.365890000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_77351\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:19.362629000 Z\n  - *3\n"', '"---\n:correlation_id: 2792d865-6e7f-4aaf-b6fa-dd73ce6f6a3d\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:19.366929', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'f1621e37-8002-4a36-bbf9-5d5b16dad57d', '2024-02-02 16:03:19.370577') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "48eec820-9ee9-4c8d-a1d6-78617a1dcfb2"], ["event_id", "f1621e37-8002-4a36-bbf9-5d5b16dad57d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:03:30.619747"], ["updated_at", "2024-02-02 16:03:30.619747"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:03:30.621915"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:03:30.623560"], ["updated_at", "2024-02-02 16:03:30.623560"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.689416"], ["updated_at", "2024-02-02 16:03:30.689416"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.694109"], ["updated_at", "2024-02-02 16:03:30.694109"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7c2cbd77-351a-4e2f-b39e-3ee6cf4da8a7', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:30.694109000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.694109000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:30.694109000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0f32024c-2c24-44b6-ba0f-22bce8f0c310\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:30.695612', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '7c2cbd77-351a-4e2f-b39e-3ee6cf4da8a7', '2024-02-02 16:03:30.699150') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:03:30.702243"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.703612"], ["updated_at", "2024-02-02 16:03:30.703612"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3444f2bf-3f1b-4a42-b680-b9793e72bc5b', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:30.703612000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.703612000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:30.703612000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e2ee222f-b547-4913-acfd-618b700ec78b\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:30.704700', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '3444f2bf-3f1b-4a42-b680-b9793e72bc5b', '2024-02-02 16:03:30.705700') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.706777"], ["updated_at", "2024-02-02 16:03:30.706777"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8aec28ae-3838-42fe-8a0f-b9d7697e3753', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:30.706777000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.706777000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:30.706777000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0a935a8d-c82e-4265-b7e3-5134d5866a88\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:30.708050', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '8aec28ae-3838-42fe-8a0f-b9d7697e3753', '2024-02-02 16:03:30.709145') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.710371"], ["updated_at", "2024-02-02 16:03:30.710371"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('557712ba-49ea-4168-8c2a-2f678650ac4c', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:30.710371000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.710371000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:30.710371000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8da4b89b-073b-442e-a41b-f2f830d38567\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:30.714305', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '557712ba-49ea-4168-8c2a-2f678650ac4c', '2024-02-02 16:03:30.715359') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_87334"], ["updated_at", "2024-02-02 16:03:30.716617"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('74ad057e-1b8f-486c-80f1-64289e72dc03', '"---\n:attributes:\n  id: 5\n  title: Good Job_87334\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:30.710371000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.710371000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:30.716617000 Z\n    zone: *1\n    time: 2024-02-02 16:03:30.716617000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_87334\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:30.710371000 Z\n  - *3\n"', '"---\n:correlation_id: 486509e5-ccd6-45f8-a13d-47227597054b\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:30.717696', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '74ad057e-1b8f-486c-80f1-64289e72dc03', '2024-02-02 16:03:30.718759') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "557712ba-49ea-4168-8c2a-2f678650ac4c"], ["event_id", "74ad057e-1b8f-486c-80f1-64289e72dc03"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:30.729091"], ["updated_at", "2024-02-02 16:03:30.729091"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d442533c-4c69-4bf1-976a-12f7e5d2123f', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:30.729091000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.729091000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:30.729091000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b938f98a-f013-4f0d-a5d5-2750042b793f\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:30.730253', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'd442533c-4c69-4bf1-976a-12f7e5d2123f', '2024-02-02 16:03:30.731271') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_42193"], ["updated_at", "2024-02-02 16:03:30.732183"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('63c6a28c-b376-45c1-bf5a-bb6909a8e113', '"---\n:attributes:\n  id: 6\n  title: Good Job_42193\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:30.729091000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:30.729091000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:30.732183000 Z\n    zone: *1\n    time: 2024-02-02 16:03:30.732183000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_42193\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:30.729091000 Z\n  - *3\n"', '"---\n:correlation_id: 003e228d-3679-4a88-b038-7a5f168ac23f\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:30.735949', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '63c6a28c-b376-45c1-bf5a-bb6909a8e113', '2024-02-02 16:03:30.736837') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d442533c-4c69-4bf1-976a-12f7e5d2123f"], ["event_id", "63c6a28c-b376-45c1-bf5a-bb6909a8e113"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (38.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:03:42.050213"], ["updated_at", "2024-02-02 16:03:42.050213"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:03:42.052413"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:03:42.054099"], ["updated_at", "2024-02-02 16:03:42.054099"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.123548"], ["updated_at", "2024-02-02 16:03:42.123548"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.125403"], ["updated_at", "2024-02-02 16:03:42.125403"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4e081936-2300-48e4-8d75-61c87e01e5ec', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:42.125403000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.125403000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:42.125403000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: f7901f96-8497-4cf5-84b3-02dc8d616bd4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:42.126700', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4e081936-2300-48e4-8d75-61c87e01e5ec', '2024-02-02 16:03:42.130409') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:03:42.133296"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.134739"], ["updated_at", "2024-02-02 16:03:42.134739"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f2e85140-7aa3-461f-8d76-a69f76574b17', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:42.134739000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.134739000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:42.134739000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: da35af56-5137-4c0e-9575-7f06c9c29d64\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:42.135869', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'f2e85140-7aa3-461f-8d76-a69f76574b17', '2024-02-02 16:03:42.136951') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.147778"], ["updated_at", "2024-02-02 16:03:42.147778"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0fcd7543-ecd4-41a4-8cd5-0b3d16bb8ffe', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:42.147778000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.147778000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:42.147778000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b750a2e0-ef75-4e2b-a5d4-377661d48f1e\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:42.149048', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '0fcd7543-ecd4-41a4-8cd5-0b3d16bb8ffe', '2024-02-02 16:03:42.150151') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.154590"], ["updated_at", "2024-02-02 16:03:42.154590"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('23eae945-5393-471e-8ffc-6b1c63dd7ce4', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:42.154590000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.154590000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:42.154590000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 66e23a07-133d-4af9-99b0-c75bcb16da3c\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:42.156354', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '23eae945-5393-471e-8ffc-6b1c63dd7ce4', '2024-02-02 16:03:42.157406') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_10246"], ["updated_at", "2024-02-02 16:03:42.158281"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2383f072-8509-4e9f-901d-ec554845ba6b', '"---\n:attributes:\n  id: 5\n  title: Good Job_10246\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:42.154590000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.154590000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:42.158281000 Z\n    zone: *1\n    time: 2024-02-02 16:03:42.158281000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_10246\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:42.154590000 Z\n  - *3\n"', '"---\n:correlation_id: 9f5acfea-6d6c-4bcb-82fd-968e78c4b978\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:42.159756', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '2383f072-8509-4e9f-901d-ec554845ba6b', '2024-02-02 16:03:42.160661') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "23eae945-5393-471e-8ffc-6b1c63dd7ce4"], ["event_id", "2383f072-8509-4e9f-901d-ec554845ba6b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:42.170458"], ["updated_at", "2024-02-02 16:03:42.170458"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f87d7f3b-bb66-4a97-82f9-9524b9ebd348', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:42.170458000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.170458000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:42.170458000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: f8ef996f-87b9-4de2-801e-ec4dcc2f8cfd\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:42.171574', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'f87d7f3b-bb66-4a97-82f9-9524b9ebd348', '2024-02-02 16:03:42.172547') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_7094"], ["updated_at", "2024-02-02 16:03:42.173525"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0b964e3c-8b34-4e6b-ac42-e8a85f9b858b', '"---\n:attributes:\n  id: 6\n  title: Good Job_7094\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:42.170458000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:42.170458000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:42.173525000 Z\n    zone: *1\n    time: 2024-02-02 16:03:42.173525000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_7094\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:42.170458000 Z\n  - *3\n"', '"---\n:correlation_id: 90cf3165-5c83-42fb-a1b0-47dec9026ab7\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:42.177559', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '0b964e3c-8b34-4e6b-ac42-e8a85f9b858b', '2024-02-02 16:03:42.178480') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "f87d7f3b-bb66-4a97-82f9-9524b9ebd348"], ["event_id", "0b964e3c-8b34-4e6b-ac42-e8a85f9b858b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (40.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (47.0ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:03:57.301319"], ["updated_at", "2024-02-02 16:03:57.301319"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:03:57.303533"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:03:57.305230"], ["updated_at", "2024-02-02 16:03:57.305230"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.371975"], ["updated_at", "2024-02-02 16:03:57.371975"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.373840"], ["updated_at", "2024-02-02 16:03:57.373840"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5e63a3d0-9baf-485e-8660-86d24f5a2605', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:57.373840000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.373840000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:57.373840000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d78f810d-1fb6-4197-94a1-d31a9c1711de\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:57.375105', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '5e63a3d0-9baf-485e-8660-86d24f5a2605', '2024-02-02 16:03:57.378910') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:03:57.381933"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.383366"], ["updated_at", "2024-02-02 16:03:57.383366"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('50e5c213-aabe-451d-94f4-f33e306d3ae5', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:57.383366000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.383366000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:57.383366000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 28be51f9-6771-488d-aa55-f1db711e6668\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:57.384512', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '50e5c213-aabe-451d-94f4-f33e306d3ae5', '2024-02-02 16:03:57.385566') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.394020"], ["updated_at", "2024-02-02 16:03:57.394020"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c934f6e9-4a38-4ba4-8075-b296522d4d6a', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:57.394020000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.394020000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:57.394020000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ab3890f0-7e37-4f7d-8c1f-61075f9658b4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:57.395363', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'c934f6e9-4a38-4ba4-8075-b296522d4d6a', '2024-02-02 16:03:57.396501') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.400806"], ["updated_at", "2024-02-02 16:03:57.400806"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ee4bbc9a-8541-48b5-baec-bc8f3168a2b8', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:57.400806000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.400806000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:57.400806000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5e9e6164-eff4-49bf-b191-afe6a2c4100d\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:57.402365', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'ee4bbc9a-8541-48b5-baec-bc8f3168a2b8', '2024-02-02 16:03:57.403512') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_35739"], ["updated_at", "2024-02-02 16:03:57.404805"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('61ad021c-9bd7-4454-a9cb-b6bf0b31b1cb', '"---\n:attributes:\n  id: 5\n  title: Good Job_35739\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:57.400806000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.400806000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:57.404805000 Z\n    zone: *1\n    time: 2024-02-02 16:03:57.404805000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_35739\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:57.400806000 Z\n  - *3\n"', '"---\n:correlation_id: 99258707-8caa-4dfe-9f06-e52179d2cbdc\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:57.405920', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '61ad021c-9bd7-4454-a9cb-b6bf0b31b1cb', '2024-02-02 16:03:57.406973') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "ee4bbc9a-8541-48b5-baec-bc8f3168a2b8"], ["event_id", "61ad021c-9bd7-4454-a9cb-b6bf0b31b1cb"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:03:57.416243"], ["updated_at", "2024-02-02 16:03:57.416243"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e6dcd0dc-e3dc-4314-bea1-60c063c17771', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:03:57.416243000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.416243000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:03:57.416243000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: dfb7f2d3-489b-44e8-a4e6-aa2932ccb888\n"', 'EntityHistory::Events::Created', '2024-02-02 16:03:57.417344', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'e6dcd0dc-e3dc-4314-bea1-60c063c17771', '2024-02-02 16:03:57.418304') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_74787"], ["updated_at", "2024-02-02 16:03:57.419161"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('87b343de-2d90-47b4-a44c-2f65eecd87f4', '"---\n:attributes:\n  id: 6\n  title: Good Job_74787\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:03:57.416243000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:03:57.416243000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:03:57.419161000 Z\n    zone: *1\n    time: 2024-02-02 16:03:57.419161000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_74787\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:03:57.416243000 Z\n  - *3\n"', '"---\n:correlation_id: 5d4ec583-aa5a-408f-9b60-a4ca630156f3\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:03:57.422936', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '87b343de-2d90-47b4-a44c-2f65eecd87f4', '2024-02-02 16:03:57.423838') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e6dcd0dc-e3dc-4314-bea1-60c063c17771"], ["event_id", "87b343de-2d90-47b4-a44c-2f65eecd87f4"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (43.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:05:01.237822"], ["updated_at", "2024-02-02 16:05:01.237822"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:05:01.239799"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:05:01.241320"], ["updated_at", "2024-02-02 16:05:01.241320"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (36.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (48.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:05:14.093411"], ["updated_at", "2024-02-02 16:05:14.093411"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:05:14.095492"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:05:14.097148"], ["updated_at", "2024-02-02 16:05:14.097148"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.163412"], ["updated_at", "2024-02-02 16:05:14.163412"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.165235"], ["updated_at", "2024-02-02 16:05:14.165235"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('802f87ef-d0b0-4d92-9751-110066b47fc1', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:14.165235000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.165235000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:14.165235000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5903fd50-54c7-4d52-8820-633b3d2fc977\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:14.166502', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '802f87ef-d0b0-4d92-9751-110066b47fc1', '2024-02-02 16:05:14.170225') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:05:14.173335"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.174796"], ["updated_at", "2024-02-02 16:05:14.174796"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('239f0923-a660-4996-ab45-6643d539e833', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:14.174796000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.174796000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:14.174796000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 17bcbda6-6e75-4a9f-bdbf-b998601355ad\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:14.175902', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '239f0923-a660-4996-ab45-6643d539e833', '2024-02-02 16:05:14.176954') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.185372"], ["updated_at", "2024-02-02 16:05:14.185372"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4822576e-a2d1-4aa2-9ada-3b50805aee86', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:14.185372000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.185372000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:14.185372000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d43be49c-c84a-4b9c-9f3d-6a1621804d21\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:14.186705', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '4822576e-a2d1-4aa2-9ada-3b50805aee86', '2024-02-02 16:05:14.187854') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.192184"], ["updated_at", "2024-02-02 16:05:14.192184"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e19d029b-5675-4a2e-96fa-21220495e981', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:14.192184000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.192184000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:14.192184000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: c37b5e74-7e1a-488b-a165-b16f32dbb526\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:14.193769', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'e19d029b-5675-4a2e-96fa-21220495e981', '2024-02-02 16:05:14.194892') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_34368"], ["updated_at", "2024-02-02 16:05:14.196266"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('989fbbf7-72df-409d-8b5b-a2f30cb8731c', '"---\n:attributes:\n  id: 5\n  title: Good Job_34368\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:05:14.192184000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.192184000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:05:14.196266000 Z\n    zone: *1\n    time: 2024-02-02 16:05:14.196266000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_34368\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:05:14.192184000 Z\n  - *3\n"', '"---\n:correlation_id: ''09e18e4e-1560-4c14-8e2a-9c276d34de3e''\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:05:14.197384', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '989fbbf7-72df-409d-8b5b-a2f30cb8731c', '2024-02-02 16:05:14.198479') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "e19d029b-5675-4a2e-96fa-21220495e981"], ["event_id", "989fbbf7-72df-409d-8b5b-a2f30cb8731c"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:14.207769"], ["updated_at", "2024-02-02 16:05:14.207769"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('acb745d2-abd0-4438-86fe-55a27cb78697', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:14.207769000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.207769000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:14.207769000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: fd2d5e79-819d-49e0-b379-8d9c2c713d02\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:14.208860', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'acb745d2-abd0-4438-86fe-55a27cb78697', '2024-02-02 16:05:14.209809') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_40948"], ["updated_at", "2024-02-02 16:05:14.210711"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f536d887-cbd8-4e6e-a935-b5105a3f2f0c', '"---\n:attributes:\n  id: 6\n  title: Good Job_40948\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:05:14.207769000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:14.207769000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:05:14.210711000 Z\n    zone: *1\n    time: 2024-02-02 16:05:14.210711000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_40948\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:05:14.207769000 Z\n  - *3\n"', '"---\n:correlation_id: adb91798-2d25-49b2-944d-5e0fbcdd2ecd\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:05:14.214976', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'f536d887-cbd8-4e6e-a935-b5105a3f2f0c', '2024-02-02 16:05:14.215903') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "acb745d2-abd0-4438-86fe-55a27cb78697"], ["event_id", "f536d887-cbd8-4e6e-a935-b5105a3f2f0c"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.7ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:05:30.170761"], ["updated_at", "2024-02-02 16:05:30.170761"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:05:30.172924"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:05:30.174610"], ["updated_at", "2024-02-02 16:05:30.174610"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.242534"], ["updated_at", "2024-02-02 16:05:30.242534"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.244384"], ["updated_at", "2024-02-02 16:05:30.244384"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f08daac8-f512-4586-9561-42ebe0a1dde3', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:30.244384000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.244384000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:30.244384000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 2179442a-c322-47ac-87f2-7a4eee8036eb\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:30.245640', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'f08daac8-f512-4586-9561-42ebe0a1dde3', '2024-02-02 16:05:30.249284') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:05:30.252151"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.253592"], ["updated_at", "2024-02-02 16:05:30.253592"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d89e36d9-ecc0-49a5-a80f-4acac84d12f8', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:30.253592000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.253592000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:30.253592000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 5c4ac7d8-d321-4e0f-8ddb-fcc6d7edfcb6\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:30.254724', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'd89e36d9-ecc0-49a5-a80f-4acac84d12f8', '2024-02-02 16:05:30.255788') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.264099"], ["updated_at", "2024-02-02 16:05:30.264099"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3610a36d-4136-4cb5-8f9d-5b715166bbbd', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:30.264099000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.264099000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:30.264099000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 20b3926d-99b5-4670-8455-82d158fcadff\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:30.265474', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '3610a36d-4136-4cb5-8f9d-5b715166bbbd', '2024-02-02 16:05:30.266579') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.270789"], ["updated_at", "2024-02-02 16:05:30.270789"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('eff67c21-30ff-4eb8-b88a-1e94c2c507f0', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:30.270789000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.270789000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:30.270789000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9f531e68-8150-4d20-95e6-9001f76c5f94\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:30.272231', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'eff67c21-30ff-4eb8-b88a-1e94c2c507f0', '2024-02-02 16:05:30.273284') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_26350"], ["updated_at", "2024-02-02 16:05:30.274671"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('34e13746-eae7-4bb7-85cb-9e30c0feef32', '"---\n:attributes:\n  id: 5\n  title: Good Job_26350\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:05:30.270789000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.270789000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:05:30.274671000 Z\n    zone: *1\n    time: 2024-02-02 16:05:30.274671000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_26350\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:05:30.270789000 Z\n  - *3\n"', '"---\n:correlation_id: 432078a6-a73d-4c0e-a6f9-e6cb80b6455a\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:05:30.275813', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '34e13746-eae7-4bb7-85cb-9e30c0feef32', '2024-02-02 16:05:30.276881') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "eff67c21-30ff-4eb8-b88a-1e94c2c507f0"], ["event_id", "34e13746-eae7-4bb7-85cb-9e30c0feef32"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:05:30.286543"], ["updated_at", "2024-02-02 16:05:30.286543"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('78ab098d-18bb-41e4-a62c-f167add05945', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:05:30.286543000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.286543000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:05:30.286543000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 299518b9-876a-4ec3-94b1-f923b97b626a\n"', 'EntityHistory::Events::Created', '2024-02-02 16:05:30.287662', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '78ab098d-18bb-41e4-a62c-f167add05945', '2024-02-02 16:05:30.288618') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_96557"], ["updated_at", "2024-02-02 16:05:30.289468"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8d8f2d3d-0b1f-421f-a5fd-747636172514', '"---\n:attributes:\n  id: 6\n  title: Good Job_96557\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:05:30.286543000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:05:30.286543000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:05:30.289468000 Z\n    zone: *1\n    time: 2024-02-02 16:05:30.289468000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_96557\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:05:30.286543000 Z\n  - *3\n"', '"---\n:correlation_id: 1e46d74f-14f1-494f-8feb-49876ddc644a\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:05:30.293199', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '8d8f2d3d-0b1f-421f-a5fd-747636172514', '2024-02-02 16:05:30.294093') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "78ab098d-18bb-41e4-a62c-f167add05945"], ["event_id", "8d8f2d3d-0b1f-421f-a5fd-747636172514"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (41.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (49.1ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:06:00.420086"], ["updated_at", "2024-02-02 16:06:00.420086"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:06:00.422388"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:06:00.423991"], ["updated_at", "2024-02-02 16:06:00.423991"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.492210"], ["updated_at", "2024-02-02 16:06:00.492210"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.494331"], ["updated_at", "2024-02-02 16:06:00.494331"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('796d22aa-d4cf-407c-b808-24f145a8254b', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:00.494331000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.494331000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:00.494331000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 13336740-b079-4de1-99b6-a175d1de0f85\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:00.495672', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '796d22aa-d4cf-407c-b808-24f145a8254b', '2024-02-02 16:06:00.499305') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:06:00.502198"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.503637"], ["updated_at", "2024-02-02 16:06:00.503637"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3d0d57e9-2be9-46b4-bc35-46031a1b4dca', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:00.503637000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.503637000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:00.503637000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 8db5708c-6e72-448e-a46a-f7c6f695768c\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:00.504781', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '3d0d57e9-2be9-46b4-bc35-46031a1b4dca', '2024-02-02 16:06:00.505838') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.513991"], ["updated_at", "2024-02-02 16:06:00.513991"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('b8007c5f-bd1e-4763-af65-9507bd98921f', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:00.513991000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.513991000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:00.513991000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b02d0c21-b811-447d-97b8-378792b67259\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:00.515300', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'b8007c5f-bd1e-4763-af65-9507bd98921f', '2024-02-02 16:06:00.516428') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.520699"], ["updated_at", "2024-02-02 16:06:00.520699"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('6b00cfc2-0de7-45b4-9711-29ed31ff5f21', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:00.520699000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.520699000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:00.520699000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bf950b9f-7082-48fa-949b-f4aaa6e86f2f\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:00.522231', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '6b00cfc2-0de7-45b4-9711-29ed31ff5f21', '2024-02-02 16:06:00.523411') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_35010"], ["updated_at", "2024-02-02 16:06:00.524735"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d0beb594-fa42-4a1e-a00d-b2caafefa65e', '"---\n:attributes:\n  id: 5\n  title: Good Job_35010\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:06:00.520699000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.520699000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:06:00.524735000 Z\n    zone: *1\n    time: 2024-02-02 16:06:00.524735000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_35010\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:06:00.520699000 Z\n  - *3\n"', '"---\n:correlation_id: 6afd1fa4-2394-44a2-b3e8-2fbd2b69eaf9\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:06:00.525833', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'd0beb594-fa42-4a1e-a00d-b2caafefa65e', '2024-02-02 16:06:00.526869') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "6b00cfc2-0de7-45b4-9711-29ed31ff5f21"], ["event_id", "d0beb594-fa42-4a1e-a00d-b2caafefa65e"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:00.535978"], ["updated_at", "2024-02-02 16:06:00.535978"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7b932bf1-fddd-4b0e-a2ef-de314e641806', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:00.535978000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.535978000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:00.535978000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 3969c1ef-702b-4262-b5dd-49e21d17b9a5\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:00.537117', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '7b932bf1-fddd-4b0e-a2ef-de314e641806', '2024-02-02 16:06:00.538065') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_40649"], ["updated_at", "2024-02-02 16:06:00.538932"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e1398620-944a-4b0a-a1bc-bb2e9b714cb5', '"---\n:attributes:\n  id: 6\n  title: Good Job_40649\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:06:00.535978000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:00.535978000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:06:00.538932000 Z\n    zone: *1\n    time: 2024-02-02 16:06:00.538932000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_40649\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:06:00.535978000 Z\n  - *3\n"', '"---\n:correlation_id: c97acc16-be53-4796-8ea7-6d112cd37c0e\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:06:00.542601', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'e1398620-944a-4b0a-a1bc-bb2e9b714cb5', '2024-02-02 16:06:00.543520') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "7b932bf1-fddd-4b0e-a2ef-de314e641806"], ["event_id", "e1398620-944a-4b0a-a1bc-bb2e9b714cb5"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:06:10.391233"], ["updated_at", "2024-02-02 16:06:10.391233"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:06:10.393476"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:06:10.395063"], ["updated_at", "2024-02-02 16:06:10.395063"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.460191"], ["updated_at", "2024-02-02 16:06:10.460191"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.462002"], ["updated_at", "2024-02-02 16:06:10.462002"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('2c0a5385-a620-45df-88ee-c63cb87b3347', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:10.462002000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.462002000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:10.462002000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a3e8e733-5057-4e20-b8d3-4896b5d37472\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:10.463214', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '2c0a5385-a620-45df-88ee-c63cb87b3347', '2024-02-02 16:06:10.466794') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:06:10.469799"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.471193"], ["updated_at", "2024-02-02 16:06:10.471193"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('7708ba5e-4c50-4fbe-8cac-75084496965f', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:10.471193000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.471193000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:10.471193000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: bf30737a-7c88-4966-b950-931f40a80711\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:10.472293', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '7708ba5e-4c50-4fbe-8cac-75084496965f', '2024-02-02 16:06:10.473333') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.481502"], ["updated_at", "2024-02-02 16:06:10.481502"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('32ba0a67-bf4f-4897-b540-6097e63b4636', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:10.481502000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.481502000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:10.481502000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 9d4d3589-be8a-4c4b-93bb-0d0e25fc5f8c\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:10.482777', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '32ba0a67-bf4f-4897-b540-6097e63b4636', '2024-02-02 16:06:10.483870') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.487951"], ["updated_at", "2024-02-02 16:06:10.487951"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0d359763-901f-4bee-9be1-d26889a9e189', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:10.487951000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.487951000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:10.487951000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6a381c75-dbe8-405b-b654-bb5790822b61\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:10.489393', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '0d359763-901f-4bee-9be1-d26889a9e189', '2024-02-02 16:06:10.490423') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_65727"], ["updated_at", "2024-02-02 16:06:10.491554"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('c8209a86-deca-4cb3-b339-162eef7d7189', '"---\n:attributes:\n  id: 5\n  title: Good Job_65727\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:06:10.487951000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.487951000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:06:10.491554000 Z\n    zone: *1\n    time: 2024-02-02 16:06:10.491554000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_65727\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:06:10.487951000 Z\n  - *3\n"', '"---\n:correlation_id: 176f6609-6b34-44da-8dee-59ec7fbee3e1\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:06:10.492812', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'c8209a86-deca-4cb3-b339-162eef7d7189', '2024-02-02 16:06:10.493835') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0d359763-901f-4bee-9be1-d26889a9e189"], ["event_id", "c8209a86-deca-4cb3-b339-162eef7d7189"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:06:10.503103"], ["updated_at", "2024-02-02 16:06:10.503103"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('443266f5-c27d-49f7-86e9-c94f92105438', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:06:10.503103000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.503103000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:06:10.503103000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4924ed07-7583-416d-9d9d-20def231dcbd\n"', 'EntityHistory::Events::Created', '2024-02-02 16:06:10.504186', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '443266f5-c27d-49f7-86e9-c94f92105438', '2024-02-02 16:06:10.505124') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.0ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_48586"], ["updated_at", "2024-02-02 16:06:10.505954"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cefacf36-1cf3-4b50-ab25-6120e3c01615', '"---\n:attributes:\n  id: 6\n  title: Good Job_48586\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:06:10.503103000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:06:10.503103000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:06:10.505954000 Z\n    zone: *1\n    time: 2024-02-02 16:06:10.505954000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_48586\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:06:10.503103000 Z\n  - *3\n"', '"---\n:correlation_id: 1c1016f5-2c3d-415a-be55-badf395c4b20\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:06:10.509576', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'cefacf36-1cf3-4b50-ab25-6120e3c01615', '2024-02-02 16:06:10.510468') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "443266f5-c27d-49f7-86e9-c94f92105438"], ["event_id", "cefacf36-1cf3-4b50-ab25-6120e3c01615"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (47.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.8ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:07:25.427831"], ["updated_at", "2024-02-02 16:07:25.427831"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:07:25.430030"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:07:25.431627"], ["updated_at", "2024-02-02 16:07:25.431627"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.500655"], ["updated_at", "2024-02-02 16:07:25.500655"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.502611"], ["updated_at", "2024-02-02 16:07:25.502611"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0628c775-140f-40d8-81ff-7dceb968fa9a', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:25.502611000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.502611000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:25.502611000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 00eb080b-ea9a-4104-a8d5-e3f63f4af67a\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:25.503936', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '0628c775-140f-40d8-81ff-7dceb968fa9a', '2024-02-02 16:07:25.507772') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:07:25.510830"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.512303"], ["updated_at", "2024-02-02 16:07:25.512303"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('306c59f9-db56-44c8-a14e-64084e34d27f', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:25.512303000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.512303000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:25.512303000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: d05f57b3-2d0b-4f18-98eb-f525b419565b\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:25.513435', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '306c59f9-db56-44c8-a14e-64084e34d27f', '2024-02-02 16:07:25.514481') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" ORDER BY "event_store_events"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.525023"], ["updated_at", "2024-02-02 16:07:25.525023"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0de1a9c6-e8d3-471f-919e-3731242bd22d', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:25.525023000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.525023000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:25.525023000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 6562266d-5f46-46a1-9a3b-57633b469bef\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:25.526358', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '0de1a9c6-e8d3-471f-919e-3731242bd22d', '2024-02-02 16:07:25.530666') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.532150"], ["updated_at", "2024-02-02 16:07:25.532150"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('0b43d59d-7fd7-4efc-a13b-745f02b852a0', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:25.532150000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.532150000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:25.532150000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 91d7d373-6e89-4064-86df-3806d6b42dad\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:25.533886', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '0b43d59d-7fd7-4efc-a13b-745f02b852a0', '2024-02-02 16:07:25.535153') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_34288"], ["updated_at", "2024-02-02 16:07:25.536074"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('09d8a9b6-14d9-4bba-b5f1-a1a8d0c3b742', '"---\n:attributes:\n  id: 5\n  title: Good Job_34288\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:07:25.532150000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.532150000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:07:25.536074000 Z\n    zone: *1\n    time: 2024-02-02 16:07:25.536074000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_34288\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:07:25.532150000 Z\n  - *3\n"', '"---\n:correlation_id: 1abe8c28-a5a9-46dc-834e-ec0940bf3d5e\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:07:25.537305', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '09d8a9b6-14d9-4bba-b5f1-a1a8d0c3b742', '2024-02-02 16:07:25.538342') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "0b43d59d-7fd7-4efc-a13b-745f02b852a0"], ["event_id", "09d8a9b6-14d9-4bba-b5f1-a1a8d0c3b742"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:25.546348"], ["updated_at", "2024-02-02 16:07:25.546348"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d4d94d39-b5b0-47f1-8fb1-8a6ac88b2c6f', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:25.546348000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.546348000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:25.546348000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: f49ea14c-4459-4dc0-a3a8-fea46848b950\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:25.547467', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'd4d94d39-b5b0-47f1-8fb1-8a6ac88b2c6f', '2024-02-02 16:07:25.548434') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_51653"], ["updated_at", "2024-02-02 16:07:25.552163"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8b2a3eea-bea7-4c18-bdbb-9c6d1b8ffce2', '"---\n:attributes:\n  id: 6\n  title: Good Job_51653\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:07:25.546348000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:25.546348000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:07:25.552163000 Z\n    zone: *1\n    time: 2024-02-02 16:07:25.552163000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_51653\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:07:25.546348000 Z\n  - *3\n"', '"---\n:correlation_id: c3fae63b-3d76-4c75-999e-3af1babcc36c\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:07:25.553235', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '8b2a3eea-bea7-4c18-bdbb-9c6d1b8ffce2', '2024-02-02 16:07:25.554416') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d4d94d39-b5b0-47f1-8fb1-8a6ac88b2c6f"], ["event_id", "8b2a3eea-bea7-4c18-bdbb-9c6d1b8ffce2"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (37.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (44.2ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:07:52.088682"], ["updated_at", "2024-02-02 16:07:52.088682"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:07:52.090815"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:07:52.092429"], ["updated_at", "2024-02-02 16:07:52.092429"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.158406"], ["updated_at", "2024-02-02 16:07:52.158406"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.160258"], ["updated_at", "2024-02-02 16:07:52.160258"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('222863a0-fef6-4a8a-af9c-bcae15434620', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:52.160258000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.160258000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:52.160258000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a0a89acc-8b8b-470a-baff-1ac2a4a1d810\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:52.161527', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '222863a0-fef6-4a8a-af9c-bcae15434620', '2024-02-02 16:07:52.165139') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:07:52.167976"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.169378"], ["updated_at", "2024-02-02 16:07:52.169378"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ae0d52af-088a-4188-9758-9f7ee0ac4303', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:52.169378000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.169378000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:52.169378000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: e0bd90d9-ee2b-4103-b23e-bbff187f4c73\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:52.170495', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'ae0d52af-088a-4188-9758-9f7ee0ac4303', '2024-02-02 16:07:52.171536') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.179784"], ["updated_at", "2024-02-02 16:07:52.179784"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('30a34ce4-9777-4f11-b099-ccaacd88805f', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:52.179784000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.179784000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:52.179784000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 40989c46-3e1d-4832-a301-d2b95846d555\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:52.181076', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '30a34ce4-9777-4f11-b099-ccaacd88805f', '2024-02-02 16:07:52.182204') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.186324"], ["updated_at", "2024-02-02 16:07:52.186324"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cab3b34f-107c-4873-b6e9-245f1f13784a', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:52.186324000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.186324000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:52.186324000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 026f3614-a3af-4892-844f-5d2d86c98f4f\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:52.187791', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'cab3b34f-107c-4873-b6e9-245f1f13784a', '2024-02-02 16:07:52.188824') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_21113"], ["updated_at", "2024-02-02 16:07:52.189991"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('f80898ac-e0df-4f31-961a-35b911184622', '"---\n:attributes:\n  id: 5\n  title: Good Job_21113\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:07:52.186324000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.186324000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:07:52.189991000 Z\n    zone: *1\n    time: 2024-02-02 16:07:52.189991000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_21113\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:07:52.186324000 Z\n  - *3\n"', '"---\n:correlation_id: 57f63b05-562f-45f5-ac10-bd2954f78d0e\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:07:52.191186', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'f80898ac-e0df-4f31-961a-35b911184622', '2024-02-02 16:07:52.192214') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "cab3b34f-107c-4873-b6e9-245f1f13784a"], ["event_id", "f80898ac-e0df-4f31-961a-35b911184622"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:07:52.201442"], ["updated_at", "2024-02-02 16:07:52.201442"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('63a5aa9a-3557-41a5-9c91-9f927a25dcad', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:07:52.201442000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.201442000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:07:52.201442000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b987988f-586a-4c4f-9a92-224034f557a4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:07:52.202540', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '63a5aa9a-3557-41a5-9c91-9f927a25dcad', '2024-02-02 16:07:52.203477') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_2149"], ["updated_at", "2024-02-02 16:07:52.204321"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('9b9d5a13-8b15-411e-ae5a-c87d0d982740', '"---\n:attributes:\n  id: 6\n  title: Good Job_2149\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:07:52.201442000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:07:52.201442000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:07:52.204321000 Z\n    zone: *1\n    time: 2024-02-02 16:07:52.204321000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_2149\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:07:52.201442000 Z\n  - *3\n"', '"---\n:correlation_id: 85121fd8-89da-4e50-8df0-ee050a3865bb\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:07:52.208065', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '9b9d5a13-8b15-411e-ae5a-c87d0d982740', '2024-02-02 16:07:52.208966') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "63a5aa9a-3557-41a5-9c91-9f927a25dcad"], ["event_id", "9b9d5a13-8b15-411e-ae5a-c87d0d982740"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.3ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:08:33.324728"], ["updated_at", "2024-02-02 16:08:33.324728"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:08:33.327120"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:08:33.329100"], ["updated_at", "2024-02-02 16:08:33.329100"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.403094"], ["updated_at", "2024-02-02 16:08:33.403094"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.405125"], ["updated_at", "2024-02-02 16:08:33.405125"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('cb241b5d-4734-430d-a2d8-8c3e37da2cc4', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:08:33.405125000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.405125000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:08:33.405125000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: a2872bfc-c5c8-429a-8a0a-77d14d3078c3\n"', 'EntityHistory::Events::Created', '2024-02-02 16:08:33.406476', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.3ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, 'cb241b5d-4734-430d-a2d8-8c3e37da2cc4', '2024-02-02 16:08:33.410477') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:08:33.413825"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.415471"], ["updated_at", "2024-02-02 16:08:33.415471"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('226c2661-04dc-4857-b790-810ed50262ec', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:08:33.415471000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.415471000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:08:33.415471000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0ec11af3-fb95-443d-88fb-eea67c21c386\n"', 'EntityHistory::Events::Created', '2024-02-02 16:08:33.416785', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '226c2661-04dc-4857-b790-810ed50262ec', '2024-02-02 16:08:33.417996') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.1ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.420276"], ["updated_at", "2024-02-02 16:08:33.420276"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d519e824-1d8f-4aa4-8a80-ce4b14887514', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:08:33.420276000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.420276000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:08:33.420276000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 39979f9c-a2a0-40b2-b131-930fef5b45f5\n"', 'EntityHistory::Events::Created', '2024-02-02 16:08:33.421714', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'd519e824-1d8f-4aa4-8a80-ce4b14887514', '2024-02-02 16:08:33.422923') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.424406"], ["updated_at", "2024-02-02 16:08:33.424406"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('02bd4b60-71bb-4832-8ff6-c8b50a7f7ed1', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:08:33.424406000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.424406000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:08:33.424406000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 1d53ab5e-e905-4a9f-817b-823605a937ea\n"', 'EntityHistory::Events::Created', '2024-02-02 16:08:33.429354', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '02bd4b60-71bb-4832-8ff6-c8b50a7f7ed1', '2024-02-02 16:08:33.430871') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_60669"], ["updated_at", "2024-02-02 16:08:33.431887"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5533ee17-1736-4c50-96be-8447228a062d', '"---\n:attributes:\n  id: 5\n  title: Good Job_60669\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:08:33.424406000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.424406000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:08:33.431887000 Z\n    zone: *1\n    time: 2024-02-02 16:08:33.431887000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_60669\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:08:33.424406000 Z\n  - *3\n"', '"---\n:correlation_id: 2b2d5888-7e95-4209-aa35-fd4726a0a1b2\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:08:33.433347', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '5533ee17-1736-4c50-96be-8447228a062d', '2024-02-02 16:08:33.434416') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "02bd4b60-71bb-4832-8ff6-c8b50a7f7ed1"], ["event_id", "5533ee17-1736-4c50-96be-8447228a062d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:08:33.444399"], ["updated_at", "2024-02-02 16:08:33.444399"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('596a083d-6c6a-49ff-af9c-e233f55bf659', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:08:33.444399000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.444399000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:08:33.444399000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 44902c58-9e92-4a39-b5d1-7487a9e01a83\n"', 'EntityHistory::Events::Created', '2024-02-02 16:08:33.445536', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '596a083d-6c6a-49ff-af9c-e233f55bf659', '2024-02-02 16:08:33.446473') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_15310"], ["updated_at", "2024-02-02 16:08:33.447299"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('8366bf4d-9085-426e-ac79-72ae30e4bc1b', '"---\n:attributes:\n  id: 6\n  title: Good Job_15310\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:08:33.444399000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:08:33.444399000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:08:33.447299000 Z\n    zone: *1\n    time: 2024-02-02 16:08:33.447299000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_15310\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:08:33.444399000 Z\n  - *3\n"', '"---\n:correlation_id: b4eddcfd-4fad-4eb8-9374-cb77f64c0203\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:08:33.448355', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '8366bf4d-9085-426e-ac79-72ae30e4bc1b', '2024-02-02 16:08:33.451903') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "596a083d-6c6a-49ff-af9c-e233f55bf659"], ["event_id", "8366bf4d-9085-426e-ac79-72ae30e4bc1b"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (39.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (45.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:09:42.477384"], ["updated_at", "2024-02-02 16:09:42.477384"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:09:42.479509"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:09:42.481026"], ["updated_at", "2024-02-02 16:09:42.481026"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.544154"], ["updated_at", "2024-02-02 16:09:42.544154"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.548973"], ["updated_at", "2024-02-02 16:09:42.548973"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4312c6d1-8e45-4ab6-9624-27e857b93e52', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:09:42.548973000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.548973000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:09:42.548973000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 22a741d4-7406-427e-9983-e423443ecf9c\n"', 'EntityHistory::Events::Created', '2024-02-02 16:09:42.550635', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '4312c6d1-8e45-4ab6-9624-27e857b93e52', '2024-02-02 16:09:42.554420') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:09:42.557238"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.558606"], ["updated_at", "2024-02-02 16:09:42.558606"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('94368c4c-3575-4454-a484-19b998f70abc', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:09:42.558606000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.558606000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:09:42.558606000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: b83ef25b-9147-4831-b69b-2830daeb388d\n"', 'EntityHistory::Events::Created', '2024-02-02 16:09:42.559766', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, '94368c4c-3575-4454-a484-19b998f70abc', '2024-02-02 16:09:42.560762') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.562761"], ["updated_at", "2024-02-02 16:09:42.562761"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('ae2ad308-cd1c-4a8d-aca3-a0e78a0467be', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:09:42.562761000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.562761000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:09:42.562761000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 387d9af6-7b2b-42fb-87c8-41b2bc19b744\n"', 'EntityHistory::Events::Created', '2024-02-02 16:09:42.564010', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, 'ae2ad308-cd1c-4a8d-aca3-a0e78a0467be', '2024-02-02 16:09:42.565114') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.566307"], ["updated_at", "2024-02-02 16:09:42.566307"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('94c78416-8c07-4d51-86cb-533b710e7eb5', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:09:42.566307000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.566307000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:09:42.566307000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0e801ba6-f459-4473-8f01-dc7d03196f75\n"', 'EntityHistory::Events::Created', '2024-02-02 16:09:42.570209', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '94c78416-8c07-4d51-86cb-533b710e7eb5', '2024-02-02 16:09:42.571582') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_78800"], ["updated_at", "2024-02-02 16:09:42.572493"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('5ea0bdfa-8581-4912-8e3e-e2c866489f85', '"---\n:attributes:\n  id: 5\n  title: Good Job_78800\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:09:42.566307000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.566307000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:09:42.572493000 Z\n    zone: *1\n    time: 2024-02-02 16:09:42.572493000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_78800\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:09:42.566307000 Z\n  - *3\n"', '"---\n:correlation_id: a086b643-e017-48eb-8783-047a70ec5afb\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:09:42.573888', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, '5ea0bdfa-8581-4912-8e3e-e2c866489f85', '2024-02-02 16:09:42.574847') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "94c78416-8c07-4d51-86cb-533b710e7eb5"], ["event_id", "5ea0bdfa-8581-4912-8e3e-e2c866489f85"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:09:42.584922"], ["updated_at", "2024-02-02 16:09:42.584922"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('650ca964-20cb-4728-8adc-b637f9aaecc7', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:09:42.584922000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.584922000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:09:42.584922000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ace10102-97c8-4b6f-b33f-32b88c5c8f7e\n"', 'EntityHistory::Events::Created', '2024-02-02 16:09:42.586094', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '650ca964-20cb-4728-8adc-b637f9aaecc7', '2024-02-02 16:09:42.587087') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_50720"], ["updated_at", "2024-02-02 16:09:42.590547"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('140f4d94-bc0f-416e-a335-25e09df8238d', '"---\n:attributes:\n  id: 6\n  title: Good Job_50720\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:09:42.584922000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:09:42.584922000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:09:42.590547000 Z\n    zone: *1\n    time: 2024-02-02 16:09:42.590547000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_50720\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:09:42.584922000 Z\n  - *3\n"', '"---\n:correlation_id: b495511a-55ff-49a0-b8c7-c5edf02c22c4\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:09:42.591887', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '140f4d94-bc0f-416e-a335-25e09df8238d', '2024-02-02 16:09:42.592789') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "650ca964-20cb-4728-8adc-b637f9aaecc7"], ["event_id", "140f4d94-bc0f-416e-a335-25e09df8238d"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mActiveRecord::InternalMetadata Pluck (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (42.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "entity_history_test"[0m
  [1m[35m (46.5ms)[0m  [1m[35mCREATE DATABASE "entity_history_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240202134459)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240202130111);

[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2024-02-02 16:10:39.538563"], ["updated_at", "2024-02-02 16:10:39.538563"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2024-02-02 16:10:39.540636"], ["key", "environment"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "2b5d30c0a74b93778cddb53860e721aaedf8f3fe"], ["created_at", "2024-02-02 16:10:39.542124"], ["updated_at", "2024-02-02 16:10:39.542124"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying, "author" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_id" ON "books" ("id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events" CASCADE[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE TABLE "event_store_events" ("id" bigserial primary key, "event_id" uuid NOT NULL, "event_type" character varying NOT NULL, "metadata" jsonb, "data" jsonb NOT NULL, "created_at" timestamp(6) NOT NULL, "valid_at" timestamp(6))[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_created_at" ON "event_store_events" ("created_at")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_on_event_id" ON "event_store_events" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_event_type" ON "event_store_events" ("event_type")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_on_valid_at" ON "event_store_events" ("valid_at")[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "event_store_events_in_streams" CASCADE[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "event_store_events_in_streams" ("id" bigserial primary key, "stream" character varying NOT NULL, "position" integer, "event_id" uuid NOT NULL, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_created_at" ON "event_store_events_in_streams" ("created_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_event_store_events_in_streams_on_event_id" ON "event_store_events_in_streams" ("event_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_event_id" ON "event_store_events_in_streams" ("stream", "event_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_event_store_events_in_streams_on_stream_and_position" ON "event_store_events_in_streams" ("stream", "position")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "event_store_events_in_streams" ADD CONSTRAINT "fk_rails_c8d52b5857"
FOREIGN KEY ("event_id")
  REFERENCES "event_store_events" ("event_id")
[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.605883"], ["updated_at", "2024-02-02 16:10:39.605883"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.607734"], ["updated_at", "2024-02-02 16:10:39.607734"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('3ce064ee-44d6-46a6-a53d-5d7b3af80c45', '"---\n:attributes:\n  id: 2\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:10:39.607734000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.607734000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:10:39.607734000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 2\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 0f1aac59-4f7c-4193-a35e-b97c884bedd4\n"', 'EntityHistory::Events::Created', '2024-02-02 16:10:39.608984', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.2ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_2', NULL, '3ce064ee-44d6-46a6-a53d-5d7b3af80c45', '2024-02-02 16:10:39.612581') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Great Job"], ["updated_at", "2024-02-02 16:10:39.615433"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.616830"], ["updated_at", "2024-02-02 16:10:39.616830"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a5a9326a-5c52-4a31-9ad0-49302d211ba1', '"---\n:attributes:\n  id: 3\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:10:39.616830000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.616830000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:10:39.616830000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 3\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 4c55158e-6398-407c-9526-61c2a2d039cc\n"', 'EntityHistory::Events::Created', '2024-02-02 16:10:39.617966', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_3', NULL, 'a5a9326a-5c52-4a31-9ad0-49302d211ba1', '2024-02-02 16:10:39.619030') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Destroy (0.0ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.621167"], ["updated_at", "2024-02-02 16:10:39.621167"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('4f99615d-a05d-4b1b-9a2a-0827444e16e8', '"---\n:attributes:\n  id: 4\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:10:39.621167000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.621167000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:10:39.621167000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 4\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: 578a2655-14bb-451e-b29b-f4ca1a1534ac\n"', 'EntityHistory::Events::Created', '2024-02-02 16:10:39.622462', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_4', NULL, '4f99615d-a05d-4b1b-9a2a-0827444e16e8', '2024-02-02 16:10:39.623579') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.624821"], ["updated_at", "2024-02-02 16:10:39.624821"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('d8f9750d-1274-4ac3-a57d-b815f0e378f9', '"---\n:attributes:\n  id: 5\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:10:39.624821000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.624821000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:10:39.624821000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 5\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: ec6f4c5c-fd57-48cd-b2d2-16a35fece929\n"', 'EntityHistory::Events::Created', '2024-02-02 16:10:39.629264', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'd8f9750d-1274-4ac3-a57d-b815f0e378f9', '2024-02-02 16:10:39.630618') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_82147"], ["updated_at", "2024-02-02 16:10:39.631561"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('a235d7f4-510d-4670-92f2-8f97871178f2', '"---\n:attributes:\n  id: 5\n  title: Good Job_82147\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:10:39.624821000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.624821000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:10:39.631561000 Z\n    zone: *1\n    time: 2024-02-02 16:10:39.631561000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_82147\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:10:39.624821000 Z\n  - *3\n"', '"---\n:correlation_id: eacf8dd1-af81-4962-a3b8-e369c362f2f4\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:10:39.632676', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_5', NULL, 'a235d7f4-510d-4670-92f2-8f97871178f2', '2024-02-02 16:10:39.633822') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "d8f9750d-1274-4ac3-a57d-b815f0e378f9"], ["event_id", "a235d7f4-510d-4670-92f2-8f97871178f2"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 5) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_5"], ["LIMIT", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Create (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Good Job"], ["author", "Unknown"], ["description", ""], ["created_at", "2024-02-02 16:10:39.644062"], ["updated_at", "2024-02-02 16:10:39.644062"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('044bdb93-7fe7-4e37-9a57-e912170b0c93', '"---\n:attributes:\n  id: 6\n  title: Good Job\n  author: Unknown\n  description: ''''\n  created_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00261 2024-02-02 16:10:39.644062000 Z\n    zone: \u00262 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.644062000 Z\n  updated_at: \u00264 !ruby/object:ActiveSupport::TimeWithZone\n    utc: *1\n    zone: *2\n    time: 2024-02-02 16:10:39.644062000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  id:\n  -\n  - 6\n  title:\n  -\n  - Good Job\n  author:\n  -\n  - Unknown\n  description:\n  -\n  - ''''\n  created_at:\n  -\n  - *3\n  updated_at:\n  -\n  - *4\n"', '"---\n:correlation_id: eabe0e35-6c91-425c-9b61-6f36253642b3\n"', 'EntityHistory::Events::Created', '2024-02-02 16:10:39.645261', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, '044bdb93-7fe7-4e37-9a57-e912170b0c93', '2024-02-02 16:10:39.646267') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Update (0.1ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Good Job_69683"], ["updated_at", "2024-02-02 16:10:39.647143"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRubyEventStore::ActiveRecord::Event Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events" ("event_id","data","metadata","event_type","created_at","valid_at") VALUES ('e1935f19-1d76-465e-a84b-6ffb50ad5db9', '"---\n:attributes:\n  id: 6\n  title: Good Job_69683\n  author: Unknown\n  description: ''''\n  created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: \u00262 2024-02-02 16:10:39.644062000 Z\n    zone: \u00261 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: 2024-02-02 16:10:39.644062000 Z\n  updated_at: \u00263 !ruby/object:ActiveSupport::TimeWithZone\n    utc: 2024-02-02 16:10:39.647143000 Z\n    zone: *1\n    time: 2024-02-02 16:10:39.647143000 Z\n:changes: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  title:\n  - Good Job\n  - Good Job_69683\n  updated_at:\n  - !ruby/object:ActiveSupport::TimeWithZone\n    utc: *2\n    zone: *1\n    time: 2024-02-02 16:10:39.644062000 Z\n  - *3\n"', '"---\n:correlation_id: d93c7480-983b-4684-88e4-7ac5f5b32e0a\n"', 'EntityHistory::Events::Updated', '2024-02-02 16:10:39.648205', NULL) RETURNING "id"[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Insert (0.1ms)[0m  [1m[32mINSERT INTO "event_store_events_in_streams" ("stream","position","event_id","created_at") VALUES ('Book_6', NULL, 'e1935f19-1d76-465e-a84b-6ffb50ad5db9', '2024-02-02 16:10:39.652045') RETURNING "id"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
  [1m[36mRubyEventStore::ActiveRecord::Event Load (0.1ms)[0m  [1m[34mSELECT "event_store_events".* FROM "event_store_events" WHERE "event_store_events"."event_id" IN ($1, $2)[0m  [["event_id", "044bdb93-7fe7-4e37-9a57-e912170b0c93"], ["event_id", "e1935f19-1d76-465e-a84b-6ffb50ad5db9"]]
  [1m[36mRubyEventStore::ActiveRecord::EventInStream Load (0.1ms)[0m  [1m[34mSELECT "event_store_events_in_streams".* FROM "event_store_events_in_streams" WHERE "event_store_events_in_streams"."stream" = $1 AND (event_store_events_in_streams.id > 7) ORDER BY "event_store_events_in_streams"."id" ASC LIMIT $2[0m  [["stream", "Book_6"], ["LIMIT", 100]]
